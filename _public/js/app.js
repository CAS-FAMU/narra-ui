angular.module("narra.ui",["ngRoute","ngResource","ngSanitize","ngCookies","ui.bootstrap","ui.event","ui.validate","ui.scrollfix","ui.grid","ui.grid.edit","ui.grid.cellNav","ui.grid.autoResize","ui.select","ui.ace","dialogs.main","dialogs.default-translations","elzoido.auth","elzoido.navigation","elzoido.messages","elzoido.promises","wu.masonry","duScroll","com.2fdevs.videogular","com.2fdevs.videogular.plugins.controls","com.2fdevs.videogular.plugins.overlayplay","com.2fdevs.videogular.plugins.poster","com.2fdevs.videogular.plugins.buffering","uiGmapgoogle-maps","google.places","angularFileUpload","angularLoad"]),angular.module("narra.ui").config(["$routeProvider","$locationProvider",function(e,t){return t.html5Mode(!0),e.when("/",{templateUrl:"partials/dashboard.html",controller:"DashboardCtrl"}).when("/viewer/:project",{templateUrl:"partials/viewer.html",controller:"ViewerCtrl"}).when("/projects",{templateUrl:"partials/projects.html",controller:"ProjectsCtrl"}).when("/projects/:project",{templateUrl:"partials/projectsDetail.html",controller:"ProjectsDetailCtrl"}).when("/sequences/:sequence",{templateUrl:"partials/sequencesDetail.html",controller:"SequencesDetailCtrl"}).when("/visualizations",{templateUrl:"partials/visualizations.html",controller:"VisualizationsCtrl"}).when("/visualizations/:visualization",{templateUrl:"partials/visualizationsDetail.html",controller:"VisualizationsDetailCtrl"}).when("/libraries",{templateUrl:"partials/libraries.html",controller:"LibrariesCtrl"}).when("/libraries/:library",{templateUrl:"partials/librariesDetail.html",controller:"LibrariesDetailCtrl"}).when("/items/:item",{templateUrl:"partials/itemsDetail.html",controller:"ItemsDetailCtrl"}).when("/users",{templateUrl:"partials/users.html",controller:"UsersCtrl"}).when("/system/info",{templateUrl:"partials/info.html",controller:"InfoCtrl"}).when("/system/settings",{templateUrl:"partials/settings.html",controller:"SettingsCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("narra.ui").config(["$httpProvider","elzoidoAuthModule",function(e,t){return e.interceptors.push("elzoidoAuthInterceptor"),t.config.userProvider="apiUser",t.config.providersProvider="apiAuth"}]).run(["$rootScope","$q","$window","$cookieStore","dialogs","elzoidoAuthModule","elzoidoAuthUser","elzoidoAuthAPI","serviceToken","serviceServer","apiUser",function(e,t,n,i,r,o,s,a,l,u,c){return o.config.functionProfile=function(){var t;return t=r.create("partials/usersEdit.html","UsersEditCtrl",{user:s.get()},{size:"lg",keyboard:!1}),t.result.then(function(t){return t.result.then(function(){return e.$broadcast("event:narra-user-updated"),a.signin()})})},o.config.functionSignin=function(e){var i;return i=t.defer(),l.get()||(r.wait("Please wait","You are being authenticated right now ..."),n.location.href=u.url+"/auth/"+e),i.resolve(!0),i.promise},o.config.functionSignout=function(){var e;return e=t.defer(),c.signout(function(){return i.remove("_narra_ui_token"),n.location.href="/",e.resolve(!0)}),e.promise},l.get()?a.signin():void 0}]),angular.module("narra.ui").config(["elzoidoNavigationModule",function(e){return e.config.navigationTree=[{name:"projects",title:"Projects",url:"/projects",access:"admin,author",items:[]},{name:"libraries",title:"Libraries",url:"/libraries",access:"admin,author",items:[]},{name:"visualizations",title:"Visualizations",url:"/visualizations",access:"admin,author",items:[]},{name:"system",title:"System",access:"admin",url:"#",items:[{name:"information",title:"Information",url:"/system/info"},{name:"users",title:"Users",url:"/users"},{name:"settings",title:"Settings",url:"/system/settings"}]}]}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/add.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<button class="btn btn-danger btn-xs navbar-btn dropdown-toggle" type="button" data-toggle="dropdown"\n        aria-expanded="false">\n    <span class="fa fa-plus"></span> Add New <span class="caret"></span>\n</button>\n<ul class="dropdown-menu" role="menu">\n    <li><a href="#" ng-click="addItem()">Add Item</a></li>\n    <li class="divider"></li>\n    <li><a href="#" ng-click="addLibrary()">Add Library</a></li>\n    <li><a href="#" ng-click="addProject()">Add Project</a></li>\n    <li><a href="#" ng-click="addSequence()">Add Sequence</a></li>\n    <li><a href="#" ng-click="addVisualization()">Add Visualization</a></li>\n</ul>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/dashboard.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container" style="margin-top: 60px;">\n    <div class="row">\n        <div class="col-md-12">\n\n            <div ng-hide="projects.length" class="col-md-12 dashboard-item-empty"><img src="/images/logo_header.png"></div>\n\n            <div ng-repeat="project in projects" class="col-md-12 dashboard-item pointer-hand" style="width: 100%; height: 150px;"\n                 ng-mouseover="hover$index=true" ng-mouseleave="hover$index=false" ng-click="view(project)">\n                <div ng-repeat="thumbnail in project.thumbnails track by $index"\n                     ng-class="{\'dashboard-item-image\': hover$index}"\n                     class="background-cover"\n                     style="background-image: url(\'{{thumbnail}}\'); width: 20%; height: 150px; float: left"></div>\n                <div class="dashboard-item-title" ng-class="{\'dashboard-item-title-anim\': hover$index}">\n                    <h1>{{project.title}}</h1>\n\n                    <p>by {{project.author.name}}</p>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/events.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div ng-show="events.length">\n    <ul class="nav navbar-nav nav-pills dropdown-toggle" data-toggle="dropdown"\n        role="tablist">\n        <li role="presentation"><a href="#">Queue <span class="badge">{{events.length}}</span></a></li>\n    </ul>\n    <ul class="dropdown-menu queue" role="menu" style="width: 300px;">\n        <li ng-repeat="event in events" ng-if="event.status == \'running\'">\n            <p>{{event.item.type | capitalize}} {{event.item.name}} is being processed</p>\n\n            <div ng-show="event.progress > 0" class="progress">\n                <div class="progress-bar progress-bar-striped progress-bar-danger active" role="progressbar"\n                     aria-valuenow="{{event.progress}}" aria-valuemin="0" aria-valuemax="100"\n                     ng-style="{width: event.progress + \'%\'}">\n                    <span>{{event.message}}</span>\n                </div>\n            </div>\n        </li>\n        <li>\n            <h1>\n                <ng-pluralize count="events.length"\n                              when="{\'one\': \'There is 1 item in queue.\', \'other\': \'There are {} items in queue.\'}">\n                </ng-pluralize>\n            </h1>\n        </li>\n    </ul>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/info.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="bs-docs-header" id="content">\n    <div class="container">\n        <h1>Information</h1>\n    </div>\n</div>\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-9" role="main">\n            <div class="bs-docs-section" id="version">\n                <h5 class="page-header">System Version</h5>\n\n                <div class="well">\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">narra-api</dt>\n                        <dd>{{coreVersion}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">narra-ui</dt>\n                        <dd>{{uiVersion}}</dd>\n                    </dl>\n                </div>\n            </div>\n\n            <div class="bs-docs-section" id="modules">\n                <h5 class="page-header">Modules</h5>\n\n                <div id="modules-{{module.name}}" ng-repeat="module in coreModules" class="well">\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">{{module.name}}</dt>\n                        <dd></dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>version</dt>\n                        <dd>{{module.version}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>summary</dt>\n                        <dd>{{module.summary}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>description</dt>\n                        <dd>{{module.description}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>homepage</dt>\n                        <dd><a href="{{module.homepage}}" target="_blank">{{module.homepage}}</a></dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>contact</dt>\n                        <dd><a ng-repeat="email in module.email" href="mailto: {{email}}" target="_blank">{{email}}<span\n                                ng-hide="$last">, </span></a></dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>authors</dt>\n                        <dd><span ng-repeat="author in module.authors">{{author}}<span ng-hide="$last">, </span></span>\n                        </dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>license</dt>\n                        <dd>{{module.license}}</dd>\n                    </dl>\n                </div>\n            </div>\n        </div>\n\n        <div class="col-md-3">\n            <div class="bs-docs-sidebar hidden-print hidden-xs hidden-sm" ui-scrollfix="+230">\n                <ul class="nav bs-docs-sidenav">\n                    <li du-scrollspy="version">\n                        <a href="#version" du-smooth-scroll>System Version</a>\n                    </li>\n                    <li du-spy-context du-scrollspy="modules">\n                        <a href="#modules" du-smooth-scroll>Modules</a>\n                        <ul class="nav">\n                            <li ng-repeat="module in coreModules" du-spy-context du-scrollspy="modules-{{module.name}}">\n                                <a href="#modules-{{module.name}}" du-smooth-scroll>{{module.name}}</a>\n                            </li>\n                        </ul>\n                    </li>\n                </ul>\n                <a class="back-to-top" href="#top" du-smooth-scroll>Back to top</a>\n            </div>\n        </div>\n\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/itemsAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new items</h4></div>\n<div class="modal-body">\n    <form name="newItem" class="form-horizontal">\n        <div ng-if="!second">\n            <div class="form-group">\n                <label class="col-sm-2 control-label">URL</label>\n\n                <div class="col-sm-10">\n                    <textarea name="url" ng-model="item.url" class="form-control"\n                              placeholder="Enter an url here" rows="10" required></textarea>\n                </div>\n            </div>\n\n            <div ng-show="newItem.url.$dirty && newItem.url.$error.required" class="col-md-offset-2">\n                <p class="text-danger left-buffer-10">\n                    <strong>Required!</strong>\n                    <small>URL is required.</small>\n                </p>\n            </div>\n        </div>\n\n        <div ng-if="second">\n            <div style="max-height: 400px; overflow-y: scroll; margin-bottom: 20px;">\n                <div ng-repeat="item in items">\n                    <div class="well well-sm">\n                        <div class="pull-left">\n                            <img src="{{item.thumbnail}}" style="height: 70px;">\n                        </div>\n                        <div style="margin-left: 120px;">\n                            <h4>{{item.name}}</h4>\n\n                            <p><span class="label label-danger">{{item.type}}</span> <span class="label label-danger">{{item.connector}}</span></p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Library</label>\n\n                <div class="col-sm-10">\n                    <ui-select ng-model="item.library" required>\n                        <ui-select-match placeholder="Pick a library">{{$select.selected.name}}</ui-select-match>\n                        <ui-select-choices repeat="library in libraries | filter:$select.search">{{library.name}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Author</label>\n\n                <div class="col-sm-10">\n                    <ui-select ng-model="item.author" required>\n                        <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                        <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <span ng-if="!second" class="btn btn-danger" ng-click="next()" ng-disabled="!newItem.$valid">Next</span>\n    <span ng-if="second" class="btn btn-default" ng-click="back()">Back</span>\n    <button ng-if="second" class="btn btn-danger" ng-disabled="!newItem.$valid"\n            ng-click="new()">Add Items\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/itemsDetail.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="bs-docs-header" id="content">\n    <div class="container">\n        <h1>{{item.name}}</h1>\n    </div>\n</div>\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-9" role="main">\n            <div ng-if="player.ready" class="videogular-container">\n                <videogular vg-player-ready="onPlayerReady($API)" vg-responsive="true" vg-cue-points="player.cuePoints">\n                    <vg-media vg-src="player.sources"\n                              vg-tracks="player.tracks" vg-preload="player.preload">\n                    </vg-media>\n\n                    <vg-controls vg-autohide="player.autoHide" vg-autohide-time="player.autoHideTime">\n                        <vg-scrub-bar>\n                            <vg-scrub-bar-current-time></vg-scrub-bar-current-time>\n                            <vg-scrub-bar-cue-points class="metadata" vg-cue-points="player.cuePoints.metadata"></vg-scrub-bar-cue-points>\n                        </vg-scrub-bar>\n                        <vg-time-display>{{ timeLeft | date:\'mm:ss\' }}</vg-time-display>\n                        <vg-volume>\n                            <vg-mute-button></vg-mute-button>\n                            <vg-volume-bar></vg-volume-bar>\n                        </vg-volume>\n                        <vg-fullscreen-button></vg-fullscreen-button>\n                    </vg-controls>\n\n                    <vg-overlay-play></vg-overlay-play>\n                    <vg-buffering></vg-buffering>\n\n                    <div ng-show="live" class="my-logo-layer">\n                        <div class="alert alert-danger" role="alert"><strong>{{live.name}}</strong></br>{{live.value}}</div>\n                    </div>\n                </videogular>\n            </div>\n\n            <div class="bs-docs-section" id="meta">\n                <h5 class="page-header">Metadata</h5>\n\n                <div narra-metadata-api="narraMetadataAPI" narra-metadata-type="item" narra-metadata-data="item"\n                     narra-metadata-player="player.api" narra-metadata-search="search" narra-metadata></div>\n            </div>\n        </div>\n\n        <div class="col-md-3">\n            <div class="bs-docs-sidebar hidden-print hidden-xs hidden-sm" ui-scrollfix="+230">\n                <div class="input-group input-group-sm" style="width: 200px;">\n                    <span class="input-group-addon"><span class="fa fa-search"></span></span>\n                    <input type="text" class="form-control" ng-model="search" placeholder="Search">\n                </div>\n                <ul class="side-buttons">\n                    <li>\n                        <button class="btn btn-danger btn-xs dropdown-toggle" type="button" data-toggle="dropdown"\n                                aria-expanded="false">\n                            <span class="fa fa-plus"></span> Add Meta <span class="caret"></span>\n                        </button>\n                        <ul class="dropdown-menu" role="menu">\n                            <li ng-repeat="provider in metadataProviders | orderBy:\'name\'">\n                                <a href="#" ng-click="narraMetadataAPI.add(provider)">{{provider.name}}</a>\n                            </li>\n                        </ul>\n                    </li>\n                    <li ng-show="generators.length">\n                        <button class="btn btn-danger btn-xs dropdown-toggle" type="button" data-toggle="dropdown"\n                                aria-expanded="false">\n                            <span class="fa fa-repeat"></span> Regenerate <span class="caret"></span>\n                        </button>\n                        <ul class="dropdown-menu" role="menu">\n                            <li ng-repeat="generator in generators">\n                                <a href="#" ng-click="narraMetadataAPI.regenerate(generator.identifier)">{{generator.title}}</a>\n                            </li>\n                        </ul>\n                    </li>\n                    <li>\n                        <button class="btn btn-danger btn-xs" ng-click="delete()"><span class="fa fa-remove"></span>\n                            Delete\n                        </button>\n                    </li>\n                    <li ng-hide="project">\n                        <a class="btn btn-default btn-xs" href="/libraries/{{library}}#{{from}}"><span\n                                class="fa fa-angle-double-left"></span> Back To Library</a>\n                    </li>\n                    <li ng-show="project">\n                        <a class="btn btn-default btn-xs" href="/libraries/{{library}}?project={{project}}&from={{fromPrevious}}#{{from}}"><span\n                                class="fa fa-angle-double-left"></span> Back To Library</a>\n                    </li>\n                    <li>\n                        <a class="btn btn-default btn-xs" href="#top"><span class="fa fa-angle-double-up"></span> Back\n                            To Top</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/libraries.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="bs-docs-header" id="content">\n    <div class="container">\n        <h1>Libraries</h1>\n    </div>\n</div>\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-12" role="main">\n            <div class="bs-docs-section" id="libraries-section">\n                <h5 id="libraries" class="page-header">My Libraries</h5>\n\n                <div ng-hide="libraries.length > 0" class="col-md-12 item-empty">You are not an author of any\n                    library.\n                </div>\n\n                <div class="row">\n                    <div ng-repeat="library in libraries" class="col-sm-4">\n                        <div class="well well-hover" ng-click="detail(library)" ng-mouseover="startRotation(library)" ng-mouseleave="stopRotation(library)">\n                            <div class="background-cover" style="background-image: url(\'{{thumbnail[library.name]}}\'); width: 100%; height: 150px;"></div>\n\n                            <h3 class="libraries-item">{{library.name}}</h3>\n                            <span ng-show="library.shared" class="label label-stamp label-success">shared</span>\n                            <span ng-hide="library.shared" class="label label-stamp label-danger">private</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="bs-docs-section" id="contributions-section">\n                <h5 id="contributions" class="page-header">My Contributions</h5>\n\n                <div ng-hide="contributions.length > 0" class="col-md-12 item-empty">You don\'t have any\n                    contribution.\n                </div>\n\n                <div class="row">\n                    <div ng-repeat="library in contributions" class="col-sm-4">\n                        <div class="well well-hover" ng-click="detail(library)" ng-mouseover="startRotation(library)" ng-mouseleave="stopRotation(library)">\n                            <div class="background-cover" style="background-image: url(\'{{thumbnail[library.name]}}\'); width: 100%; height: 150px;"></div>\n\n                            <h3 class="text-center">{{library.name}}</h3>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/librariesAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add a\n    new library</h4></div>\n<div class="modal-body">\n    <form name="newLibrary" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Name</label>\n\n            <div class="col-sm-10">\n                <input name="name" ng-model="library.name" class="form-control" ng-trim="false"\n                       ui-validate="{exists: \'validateName($value)\' }"\n                       type="text" placeholder="Enter a name here" required/>\n            </div>\n        </div>\n\n        <div ng-show="newLibrary.name.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Library already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="newLibrary.name.$dirty && newLibrary.name.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Library name is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Description</label>\n\n            <div class="col-sm-10">\n                <textarea name="description" ng-model="library.description" class="form-control"\n                          placeholder="Enter a description here" rows="5"></textarea>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Project</label>\n\n            <div class="col-sm-10">\n                <ui-select ng-model="library.project" required>\n                    <ui-select-match placeholder="Pick a project">{{$select.selected.title}}</ui-select-match>\n                    <ui-select-choices repeat="project in projects | filter:$select.search">{{project.title}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Author</label>\n\n            <div class="col-sm-10">\n                <ui-select ng-model="library.author" ng-disabled="!user.isAdmin()" ng-change="filter()" required>\n                    <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Contributors</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple ng-model="library.contributors" style="width: 100%;">\n                    <ui-select-match placeholder="Select contributors">{{$item.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in contributors | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Generators</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple ng-model="library.generators" style="width: 100%;">\n                    <ui-select-match placeholder="Select generators">{{$item.title}}</ui-select-match>\n                    <ui-select-choices repeat="generator in generators | filter:$select.search">{{generator.title}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newLibrary.$valid"\n            ng-click="new()">Add Library\n    </button>\n</div>')
}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/librariesDetail.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="bs-docs-header" id="content">\n    <div class="container">\n        <h1>{{library.name}}</h1>\n    </div>\n</div>\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-9" role="main">\n            <div class="bs-docs-section" id="information">\n                <h5 class="page-header">Library Information</h5>\n\n                <div class="well well-hover" ng-click="edit()">\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">{{library.name}}</dt>\n                        <dd>\n                            <span ng-show="library.shared" class="label label-success">shared</span>\n                            <span ng-hide="library.shared" class="label label-danger">private</span>\n                        </dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>description</dt>\n                        <dd>{{library.description}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>author</dt>\n                        <dd>{{library.author.name}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>contributors</dt>\n                        <dd><span ng-repeat="contributor in library.contributors">{{contributor.name}}<span\n                                ng-hide="$last">, </span></span><span ng-show="library.contributors.length == 0"\n                                                                      class="text-muted">There is no contributors in this library.</span>\n                        </dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>generators</dt>\n                        <dd><span ng-repeat="generator in library.generators">{{generator.title}}<span\n                                ng-hide="$last">, </span></span><span ng-show="library.generators.length == 0"\n                                                                      class="text-muted">There is no generators assigned to this library.</span>\n                        </dd>\n                    </dl>\n                </div>\n            </div>\n\n            <tabset>\n                <tab heading="Items">\n                    <div ng-hide="items.length > 0" class="item-empty">This library doesn\'t contain any item.\n                    </div>\n\n                    <div class="tab-content">\n                        <div class="row">\n                            <div ng-repeat="item in filtered = (items | filter:search) | orderBy:\'name\'"\n                                 class="col-sm-4"\n                                 id="items-{{$index}}" on-render-finished>\n                                <div ng-show="item.prepared" class="well well-hover" ng-click="detail(item, $index)"\n                                     ng-mouseover="startRotation(item)" ng-mouseleave="stopRotation(item)">\n                                    <div class="background-cover"\n                                         style="background-image: url(\'{{thumbnail[item.name]}}\'); width: 100%; height: 150px;"></div>\n\n                                    <h3 class="libraries-item">{{item.name}}</h3>\n                                </div>\n\n                                <div ng-hide="item.prepared" class="well">\n                                    <div class="background-cover"\n                                         style="background-image: url(\'/images/bars.png\'); width: 100%; height: 150px; opacity: 0.9;">\n                                        <div class="text-center" style="padding-top: 50px;">\n                                            <i class="fa fa-circle-o-notch fa-spin fa-2x"></i>\n\n                                            <p>PREPARING</p>\n                                        </div>\n                                    </div>\n\n                                    <h3 class="libraries-item">{{item.name}}</h3>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </tab>\n                <tab heading="Metadata">\n                    <div ng-hide="library.metadata.length > 0" class="item-empty">This library doesn\'t contain\n                        any metadata.\n                    </div>\n                    <div class="tab-content">\n                        <div narra-metadata-api="narraMetadataAPI" narra-metadata-type="library"\n                             narra-metadata-data="library"\n                             narra-metadata></div>\n                    </div>\n                </tab>\n\n            </tabset>\n        </div>\n\n        <div class="col-md-3">\n            <div class="bs-docs-sidebar hidden-print hidden-xs hidden-sm" ui-scrollfix="+230">\n                <div class="input-group input-group-sm" style="width: 200px;">\n                    <span class="input-group-addon"><span class="fa fa-search"></span></span>\n                    <input type="text" class="form-control" ng-model="search" placeholder="Search">\n                </div>\n\n                <ul class="side-buttons">\n                    <li>\n                        <button class="btn btn-danger btn-xs" type="button" ng-click="narraMetadataAPI.add()">\n                            <span class="fa fa-plus"></span> Add Meta\n                        </button>\n                    </li>\n                    <li ng-show="library.generators.length">\n                        <button class="btn btn-danger btn-xs dropdown-toggle" type="button" data-toggle="dropdown">\n                            <span class="fa fa-repeat"></span> Regenerate <span class="caret"></span>\n                        </button>\n                        <ul class="dropdown-menu" role="menu" ng-controller="AddCtrl">\n                            <li ng-repeat="generator in library.generators">\n                                <a href="#" ng-click="narraMetadataAPI.regenerate(generator.identifier)">{{generator.title}}</a>\n                            </li>\n                        </ul>\n                    </li>\n                    <li>\n                        <button class="btn btn-danger btn-xs" type="button" ng-click="delete()"><span\n                                class="fa fa-remove"></span> Delete\n                        </button>\n                    </li>\n                    <li ng-hide="project">\n                        <a class="btn btn-default btn-xs" type="button" href="/libraries"><span\n                                class="fa fa-angle-double-left"></span> Back To Libraries</a>\n                    </li>\n                    <li ng-show="project">\n                        <a class="btn btn-default btn-xs" type="button" href="/projects/{{project}}#{{from}}"><span\n                                class="fa fa-angle-double-left"></span> Back To Project</a>\n                    </li>\n                    <li>\n                        <a class="btn btn-default btn-xs" type="button" href="#top"><span\n                                class="fa fa-angle-double-up"></span> Back To Top</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/librariesInformationEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-edit"></span> {{initial.name}}</h4></div>\n<div class="modal-body">\n    <form name="editLibrary" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Name</label>\n\n            <div class="col-sm-10">\n                <input name="name" ng-model="library.name" class="form-control" ng-trim="false"\n                       ui-validate="{exists: \'validateName($value)\' }"\n                       type="text" placeholder="Enter a name here" required/>\n            </div>\n        </div>\n\n        <div ng-show="editLibrary.name.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Library already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="editLibrary.name.$dirty && editLibrary.name.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Library name is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Description</label>\n\n            <div class="col-sm-10">\n                <textarea name="description" ng-model="library.description" class="form-control"\n                          placeholder="Enter a description here" rows="5"></textarea>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Author</label>\n\n            <div class="col-sm-10">\n                <ui-select ng-model="library.author" ng-disabled="!user.isAdmin()" ng-change="filter()" required>\n                    <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Shared</label>\n\n            <div class="col-sm-10">\n                <input type="checkbox" ng-model="library.shared"><span class="text-muted" style="margin-left: 10px;">Turn this library into the shared mode</span>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Contributors</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple ng-model="library.contributors" style="width: 100%;">\n                    <ui-select-match placeholder="Select contributors">{{$item.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in contributors | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Generators</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple ng-model="library.generators" style="width: 100%;">\n                    <ui-select-match placeholder="Select generators">{{$item.title}}</ui-select-match>\n                    <ui-select-choices repeat="generator in generators | filter:$select.search">{{generator.title}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!editLibrary.$valid"\n            ng-click="edit()">Save Library\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadata.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div ng-switch="type">\n    <div ng-switch-when="item">\n        <div ng-show="(generators | filter:search | orderBy:\'name\').length == 0" class="dashboard-item-empty">Any library meets you search criteria.</div>\n\n        <div ng-hide="filtered.length == 0" class="well" ng-repeat="generator in meta | orderBy:\'name\'"\n             id="meta-{{generator.name}}">\n            <dl class="dl-horizontal">\n                <dt class="block-header">{{generator.name | generator}}</dt>\n                <dd></dd>\n            </dl>\n            <dl class="dl-horizontal" ng-repeat="entry in filtered = (generator.data | filter:search | orderBy:\'name\')"\n                ng-mouseover="hover$index=true" ng-mouseleave="hover$index=false">\n                <dt>{{ entry.name | metadata }}</dt>\n                <dd><span ng-show="isLink(entry.value)"><a href="{{entry.value}}"\n                                                           target="_blank">{{entry.value}}</a></span><span\n                        ng-hide="isLink(entry.value)">{{entry.value}}</span>\n                    <button ng-show="hover$index && generator.name != \'source\'" class="btn btn-danger btn-xs"\n                            ng-click="edit(entry)">Edit\n                    </button>\n                    <span ng-repeat="mark in entry.marks" class="fa fa-bookmark bookmark-hover"\n                          ng-click="seek(mark.in)"></span></dd>\n            </dl>\n        </div>\n    </div>\n    <div ng-switch-when="library">\n        <div ng-hide="filtered.length == 0" class="well">\n            <dl class="dl-horizontal" ng-repeat="entry in filtered = (meta | filter:search | orderBy:\'name\')"\n                ng-mouseover="hover$index=true" ng-mouseleave="hover$index=false">\n                <dt>{{ entry.name | metadata }}</dt>\n                <dd>\n                    <span ng-show="isLink(entry.value)">\n                        <a href="{{entry.value}}" target="_blank">{{entry.value}}</a>\n                    </span>\n                    <span ng-hide="isLink(entry.value)">{{entry.value}}</span>\n                    <button ng-show="hover$index" class="btn btn-danger btn-xs" ng-click="edit(entry)">Edit</button>\n                </dd>\n            </dl>\n        </div>\n    </div>\n    <div ng-switch-when="project">\n        <div ng-hide="filtered.length == 0" class="well">\n            <dl class="dl-horizontal" ng-repeat="entry in filtered = (meta | filter:search | orderBy:\'name\')"\n                ng-mouseover="hover$index=true" ng-mouseleave="hover$index=false">\n                <dt>{{ entry.name | metadata }}</dt>\n                <dd>\n                    <span ng-show="isLink(entry.value)">\n                        <a href="{{entry.value}}" target="_blank">{{entry.value}}</a>\n                    </span>\n                    <span ng-hide="isLink(entry.value)">{{entry.value}}</span>\n                    <button ng-show="hover$index" class="btn btn-danger btn-xs" ng-click="edit(entry)">Edit</button>\n                </dd>\n            </dl>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataCustomAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Custom Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Name</label>\n\n            <div class="col-sm-10">\n                <input name="name" ng-model="meta.name" class="form-control" ng-trim="false" ui-validate="{exists: \'validateName($value)\' }"\n                       type="text" placeholder="Enter a name here" required/>\n            </div>\n        </div>\n\n        <div ng-show="newMeta.name.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Metadata with same name already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="newMeta.name.$dirty && newMeta.name.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Name is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Value</label>\n\n            <div class="col-sm-10">\n                <textarea name="value" ng-model="meta.value" class="form-control"\n                          placeholder="Enter a value here" rows="5" required></textarea>\n            </div>\n        </div>\n\n        <div ng-show="newMeta.value.$dirty && newMeta.value.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Value is required.</small>\n            </p>\n        </div>\n\n        <div ng-show="mark" class="form-group">\n            <label class="col-sm-2 control-label">Marks</label>\n\n            <div class="col-sm-10">\n                <div class="checkbox">\n                    <label>\n                        <input type="checkbox" ng-model="mark.use">\n                        Use marks to restrict area\n                    </label>\n                </div>\n\n                <span ng-class="{\'text-muted\': !mark.use}">Mark in <input ng-disabled="!mark.use" type="number" ng-model="mark.in" min="0" max="{{mark.out || mark.max}}" style="width: 50px;"/>\n                Mark out <input ng-disabled="!mark.use" type="number" ng-model="mark.out" min="{{mark.in}}" max="{{mark.max}}" style="width: 50px;"/></span>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataCustomEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Custom Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Name</label>\n\n            <div class="col-sm-10">\n                <input name="name" ng-model="meta.name" class="form-control" ng-trim="false"\n                       type="text" placeholder="Enter a name here" disabled/>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Value</label>\n\n            <div class="col-sm-10">\n                <textarea name="value" ng-model="meta.value" class="form-control"\n                          placeholder="Enter an url here" rows="5" required></textarea>\n            </div>\n        </div>\n\n        <div ng-show="editMeta.value.$dirty && editMeta.value.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Value is required.</small>\n            </p>\n        </div>\n\n        <div ng-show="mark" class="form-group">\n            <label class="col-sm-2 control-label">Marks</label>\n\n            <div class="col-sm-10">\n                <div class="checkbox">\n                    <label>\n                        <input type="checkbox" ng-model="mark.use"/>\n                        Use marks to restrict area\n                    </label>\n                </div>\n\n                <span ng-class="{\'text-muted\': !mark.use}">Mark in <input ng-disabled="!mark.use" type="number" ng-model="mark.in" min="0" max="{{mark.out || mark.max}}" style="width: 50px;"/>\n                Mark out <input ng-disabled="!mark.use" type="number" ng-model="mark.out" min="{{mark.in}}" max="{{mark.max}}" style="width: 50px;"/></span>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataLocationAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Location Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Location</label>\n\n            <div class="col-sm-10">\n                <input name="location" ng-model="meta.value" class="form-control" ng-trim="false"\n                       type="text" placeholder="Enter a name here" g-places-autocomplete required/>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataLocationEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Location Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Location</label>\n\n            <div class="col-sm-10">\n                <input name="location" ng-model="meta.value" class="form-control" ng-trim="false"\n                       type="text" placeholder="Enter a name here" g-places-autocomplete required/>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataShotTypeAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Shot Type Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Shot Type</label>\n\n            <div class="col-sm-10">\n                <ui-select name="value" multiple ng-model="meta.value" style="width: 100%;" rows="5" ui-validate=" \'$value.length\' ">\n                    <ui-select-match placeholder="Select shot types">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="shot in shots | filter:$select.search">{{shot}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataShotTypeEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Shot Type Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Shot Type</label>\n\n            <div class="col-sm-10">\n                <ui-select name="value" multiple ng-model="meta.value" style="width: 100%;" rows="5" ui-validate=" \'$value.length\' ">\n                    <ui-select-match placeholder="Select shot types">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="shot in shots | filter:$select.search">{{shot}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/projects.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="bs-docs-header" id="content">\n    <div class="container">\n        <h1>Projects</h1>\n    </div>\n</div>\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-12" role="main">\n            <div class="bs-docs-section" id="projects-section">\n                <h5 id="projects" class="page-header">My Projects</h5>\n\n                <div ng-hide="projects.length > 0" class="col-md-12 item-empty">You are not an author of any\n                    project.\n                </div>\n\n                <div class="row">\n                    <div ng-repeat="project in projects" class="col-md-12 dashboard-item pointer-hand"\n                         style="width: 100%; height: 150px;"\n                         ng-mouseover="hover$index=true" ng-mouseleave="hover$index=false" ng-click="detail(project)">\n                        <div ng-repeat="thumbnail in project.thumbnails track by $index"\n                             ng-class="{\'dashboard-item-image\': hover$index}"\n                             class="background-cover"\n                             style="background-image: url(\'{{thumbnail}}\'); width: 20%; height: 150px; float: left"></div>\n                        <div class="dashboard-item-title" ng-class="{\'dashboard-item-title-anim\': hover$index}">\n                            <h1>{{project.title}}</h1>\n\n                            <p>by {{project.author.name}}</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="bs-docs-section" id="contributions-section">\n                <h5 id="contributions" class="page-header">My Contributions</h5>\n\n                <div ng-hide="contributions.length > 0" class="col-md-12 item-empty">You don\'t have any\n                    contribution.\n                </div>\n\n                <div class="row">\n                    <div ng-repeat="project in contributions" class="col-md-12 dashboard-item pointer-hand"\n                         style="width: 100%; height: 150px;"\n                         ng-mouseover="hover$index=true" ng-mouseleave="hover$index=false" ng-click="detail(project)">\n                        <div ng-repeat="thumbnail in project.thumbnails track by $index"\n                             ng-class="{\'dashboard-item-image\': hover$index}"\n                             class="background-cover"\n                             style="background-image: url(\'{{thumbnail}}\'); width: 20%; height: 150px; float: left"></div>\n                        <div class="dashboard-item-title" ng-class="{\'dashboard-item-title-anim\': hover$index}">\n                            <h1>{{project.title}}</h1>\n\n                            <p>by {{project.author.name}}</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n    </div>\n</div>')
}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/projectsAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add a\n    new project</h4></div>\n<div class="modal-body">\n    <form name="newProject" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Title</label>\n\n            <div class="col-sm-10">\n                <input name="title" ng-model="project.title" class="form-control" ng-trim="false"\n                       ui-validate="{exists: \'validateTitle($value)\' }"\n                       type="text" placeholder="Enter a title here" required/>\n            </div>\n        </div>\n\n        <div ng-show="newProject.title.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Project with same title already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="newProject.title.$dirty && newProject.title.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Project title is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Name</label>\n\n            <div class="col-sm-10">\n                <input name="name" ng-model="project.name" class="form-control" ng-trim="false"\n                       ui-validate="{exists: \'validateName($value)\' }"\n                       type="text" placeholder="Enter a name here" filtervalue="projectname" required/>\n            </div>\n        </div>\n\n        <div ng-show="newProject.name.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Project already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="newProject.name.$dirty && newProject.name.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Project name is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Description</label>\n\n            <div class="col-sm-10">\n                <textarea name="description" ng-model="project.description" class="form-control"\n                          placeholder="Enter a description here" rows="5"></textarea>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Author</label>\n\n            <div class="col-sm-10">\n                <ui-select ng-model="project.author" ng-disabled="!user.isAdmin()" ng-change="filter()" required>\n                    <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Contributors</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple ng-model="project.contributors" style="width: 100%;">\n                    <ui-select-match placeholder="Select contributors">{{$item.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in contributors | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newProject.$valid"\n            ng-click="new()">Add Project\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/projectsDetail.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="bs-docs-header" id="content">\n    <div class="container">\n        <h1>{{project.title}}</h1>\n    </div>\n</div>\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-9" role="main">\n            <div class="bs-docs-section" id="information">\n                <h5 class="page-header">Project Information</h5>\n\n                <div class="well well-hover" ng-click="edit()">\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">{{project.title}}</dt>\n                        <dd>\n                            <span ng-show="project.public" class="label label-success">public</span>\n                            <span ng-hide="project.public" class="label label-danger">private</span>\n                        </dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>name</dt>\n                        <dd>{{project.name}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>description</dt>\n                        <dd>{{project.description}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>author</dt>\n                        <dd>{{project.author.name}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>contributors</dt>\n                        <dd><span ng-repeat="contributor in project.contributors">{{contributor.name}}<span\n                                ng-hide="$last">, </span></span><span ng-show="project.contributors.length == 0"\n                                                                      class="text-muted">There is no contributors in this project.</span>\n                        </dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>synthesizers</dt>\n                        <dd><span ng-repeat="synthesizer in project.synthesizers">{{synthesizer.title}}<span\n                                ng-hide="$last">, </span></span><span ng-show="project.synthesizers.length == 0"\n                                                                      class="text-muted">There is no synthesizers assigned to this project.</span>\n                        </dd>\n                    </dl>\n                </div>\n            </div>\n\n            <tabset>\n                <tab heading="Libraries">\n                    <div ng-hide="project.libraries.length > 0" class="item-empty">This project doesn\'t\n                        contain any library.\n                    </div>\n\n                    <div class="tab-content">\n                        <div id="libraries-{{$index}}"\n                             ng-repeat="library in filtered = (project.libraries | filter:search) | orderBy:\'name\'"\n                             class="well well-hover" ng-click="detailLibrary(library, $index)">\n                            <div ng-repeat="thumbnail in library.thumbnails track by $index"\n                                 class="background-cover"\n                                 style="background-image: url(\'{{thumbnail}}\'); width: 20%; height: 80px; float: left; margin-bottom: 10px;"></div>\n                            <dl class="dl-horizontal">\n                                <dt class="block-header">{{library.name}}</dt>\n                                <dd></dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>description</dt>\n                                <dd>{{library.description}}</dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>author</dt>\n                                <dd>{{library.author.name}}</dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>contributors</dt>\n                                <dd><span ng-repeat="contributor in library.contributors">{{contributor.name}}<span\n                                        ng-hide="$last">, </span></span><span ng-show="library.contributors.length == 0"\n                                                                              class="text-muted">There is no contributors in this library.</span>\n                                </dd>\n                            </dl>\n                        </div>\n                    </div>\n                </tab>\n                <tab heading="Sequences">\n                    <div ng-hide="sequences.length > 0" class="item-empty">This project doesn\'t contain any\n                        sequence.\n                    </div>\n\n                    <div class="tab-content">\n                        <div id="sequences-{{$index}}"\n                             ng-repeat="sequence in filtered = (sequences | filter:search) | orderBy:\'name\'"\n                             ng-click="detailSequence(sequence)">\n                            <div class="well well-sm well-hover">\n                                <div class="pull-left">\n                                    <img src="{{sequence.thumbnail}}" style="height: 70px;">\n                                </div>\n                                <div style="margin-left: 140px;">\n                                    <h4>{{sequence.name}}</h4>\n\n                                    <p>by {{sequence.author.name}}</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </tab>\n                <tab heading="Visualizations">\n                    <div ng-hide="project.visualizations.length > 0" class="item-empty">This project doesn\'t contain\n                        any visualization.\n                    </div>\n\n                    <div ng-repeat="visualization in filtered = (project.visualizations | filter:search) | orderBy:\'name\'">\n                        <div class="well well-sm well-hover" ng-click="removeVisualization(visualization)">\n                            <div class="pull-left">\n                                <img src="{{visualization.thumbnail}}" style="height: 70px;">\n                            </div>\n                            <div style="margin-left: 140px;">\n                                <h4>{{visualization.name}}</h4>\n\n                                <p>by {{visualization.author.name}}</p>\n                            </div>\n                        </div>\n                    </div>\n                </tab>\n                <tab heading="Metadata">\n                    <div ng-hide="project.metadata.length > 0" class="item-empty">This project doesn\'t contain\n                        any metadata.\n                    </div>\n\n                    <div class="tab-content">\n                        <div narra-metadata-api="narraMetadataAPI" narra-metadata-type="project"\n                             narra-metadata-data="project" narra-metadata></div>\n                    </div>\n                </tab>\n            </tabset>\n        </div>\n\n        <div class="col-md-3">\n            <div class="bs-docs-sidebar hidden-print hidden-xs hidden-sm" ui-scrollfix="+230">\n                <div class="input-group input-group-sm" style="width: 200px;">\n                    <span class="input-group-addon"><span class="fa fa-search"></span></span>\n                    <input type="text" class="form-control" ng-model="search" placeholder="Search">\n                </div>\n\n                <ul class="side-buttons">\n                    <li>\n                        <button class="btn btn-danger btn-xs" type="button" ng-click="narraMetadataAPI.add()">\n                            <span class="fa fa-plus"></span> Add Meta\n                        </button>\n                    </li>\n                    <li ng-if="visualizations.length">\n                        <button class="btn btn-danger btn-xs dropdown-toggle" type="button" data-toggle="dropdown"\n                                aria-expanded="false">\n                            <span class="fa fa-plus"></span> Assign Visualization <span class="caret"></span>\n                        </button>\n                        <ul class="dropdown-menu" role="menu">\n                            <li ng-repeat="visualization in visualizations | orderBy:\'name\'">\n                                <a href="#" ng-click="addVisualization(visualization)">{{visualization.name}}</a>\n                            </li>\n                        </ul>\n                    </li>\n                    <li>\n                        <button class="btn btn-danger btn-xs" type="button" ng-click="delete()"><span\n                                class="fa fa-remove"></span> Delete\n                        </button>\n                    </li>\n                    <li>\n                        <a class="btn btn-default btn-xs" type="button" href="/projects"><span\n                                class="fa fa-angle-double-left"></span> Back To Projects</a>\n                    </li>\n                    <li>\n                        <a class="btn btn-default btn-xs" type="button" href="#top"><span\n                                class="fa fa-angle-double-up"></span> Back To Top</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/projectsInformationEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-edit"></span> {{initial.title}}</h4></div>\n<div class="modal-body">\n    <form name="editProject" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Title</label>\n\n            <div class="col-sm-10">\n                <input name="title" ng-model="project.title" class="form-control" ng-trim="false"\n                       ui-validate="{exists: \'validateTitle($value)\' }"\n                       type="text" placeholder="Enter a title here" required/>\n            </div>\n        </div>\n\n        <div ng-show="editProject.title.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Project with same title already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="editProject.title.$dirty && editProject.title.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Project title is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Name</label>\n\n            <div class="col-sm-10">\n                <input name="name" ng-model="project.name" class="form-control" ng-trim="false"\n                       ui-validate="{exists: \'validateName($value)\' }"\n                       type="text" placeholder="Enter a name here" filtervalue="projectname" required/>\n            </div>\n        </div>\n\n        <div ng-show="editProject.name.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Project already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="editProject.name.$dirty && editProject.name.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Project name is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Description</label>\n\n            <div class="col-sm-10">\n                <textarea name="description" ng-model="project.description" class="form-control"\n                          placeholder="Enter a description here" rows="5"></textarea>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Author</label>\n\n            <div class="col-sm-10">\n                <ui-select ng-model="project.author" ng-disabled="!user.isAdmin()" ng-change="filter()" required>\n                    <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Public</label>\n\n            <div class="col-sm-10">\n                <input type="checkbox" ng-model="project.public"><span class="text-muted" style="margin-left: 10px;">Turn this project into the public mode</span>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Contributors</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple ng-model="project.contributors" style="width: 100%;">\n                    <ui-select-match placeholder="Select contributors">{{$item.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in contributors | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Synthesizers</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple ng-model="project.synthesizers" style="width: 100%;">\n                    <ui-select-match placeholder="Select synthesizers">{{$item.title}}</ui-select-match>\n                    <ui-select-choices repeat="synthesizer in synthesizers | filter:$select.search">{{synthesizer.title}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!editProject.$valid"\n            ng-click="edit()">Save Project\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/sequencesAdd.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new sequence</h4></div>\n<div class="modal-body">\n    <form name="newSequence" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">EDL File</label>\n\n            <div class="col-sm-10">\n                <input type="file" ng-model=\'sequence.file\' onchange="angular.element(this).scope().setFile(this)" required>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Title</label>\n\n            <div class="col-sm-10">\n                <input name="title" ng-model="sequence.title" class="form-control" ng-trim="false"\n                       type="text" placeholder="Enter a title here" required/>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Project</label>\n\n            <div class="col-sm-10">\n                <ui-select ng-model="sequence.project" required>\n                    <ui-select-match placeholder="Pick a project">{{$select.selected.title}}</ui-select-match>\n                    <ui-select-choices repeat="project in projects | filter:$select.search">{{project.title}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Author</label>\n\n            <div class="col-sm-10">\n                <ui-select ng-model="sequence.author" required>\n                    <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newSequence.$valid"\n            ng-click="new()">Add Sequence\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/sequencesDetail.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="bs-docs-header" id="content">\n    <div class="container">\n        <h1>{{sequence.name}}</h1>\n    </div>\n</div>\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-9" role="main">\n            <div class="bs-docs-section">\n                <h5 class="page-header">Sequence Information</h5>\n\n                <div class="well">\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">{{sequence.name}}</dt>\n                        <dd></dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>author</dt>\n                        <dd>{{sequence.author.name}}</dd>\n                    </dl>\n                </div>\n            </div>\n\n            <div ng-if="player.ready" class="bs-docs-section">\n                <h5 class="page-header">Player</h5>\n\n                <div class="videogular-container">\n                    <videogular vg-player-ready="onPlayerReady($API)" vg-responsive="true"\n                                vg-cue-points="player.cuePoints" vg-update-time="playlistHandler($currentTime)">\n                        <vg-media vg-src="player.sources"\n                                  vg-tracks="player.tracks" vg-preload="player.preload">\n                        </vg-media>\n\n                        <vg-controls vg-autohide="player.autoHide" vg-autohide-time="player.autoHideTime">\n                            <vg-play-pause-button></vg-play-pause-button>\n                            <vg-scrub-bar>\n                                <vg-scrub-bar-current-time></vg-scrub-bar-current-time>\n                            </vg-scrub-bar>\n                            <vg-time-display>{{ timeLeft | date:\'mm:ss\' }}</vg-time-display>\n                            <vg-volume>\n                                <vg-mute-button></vg-mute-button>\n                                <vg-volume-bar></vg-volume-bar>\n                            </vg-volume>\n                            <vg-fullscreen-button></vg-fullscreen-button>\n                        </vg-controls>\n\n                        <vg-overlay-play ng-hide="player.current"></vg-overlay-play>\n                    </videogular>\n                </div>\n            </div>\n\n            <div class="bs-docs-section" id="items">\n                <h5 class="page-header">Items</h5>\n\n                <div ng-hide="sequence.marks.length > 0" class="item-empty">This sequence doesn\'t contain any\n                    item.\n                </div>\n\n                <div class="row">\n                    <div ng-repeat="mark in filtered = (sequence.marks | filter:search) | orderBy:\'name\'"\n                         style="padding-left: 15px; padding-right: 15px;" on-render-finished>\n\n                        <div class="well well-sm well-hover" ng-class="{\'well-active\': isActive($index)}"\n                             ng-click="seek($index)">\n                            <div class="pull-left">\n                                <img src="{{mark.clip.thumbnail}}" style="height: 100px;">\n                            </div>\n                            <div style="margin-left: 200px;">\n                                <h4>{{mark.clip.name}}</h4>\n\n                                <p><span class="label label-danger">in</span> {{mark.in}}</p>\n\n                                <p><span class="label label-danger">out</span> {{mark.out}}</p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="col-md-3">\n            <div class="bs-docs-sidebar hidden-print hidden-xs hidden-sm" ui-scrollfix="+230">\n                <div class="input-group input-group-sm" style="width: 200px;">\n                    <span class="input-group-addon"><span class="fa fa-search"></span></span>\n                    <input type="text" class="form-control" ng-model="search" placeholder="Search">\n                </div>\n\n                <ul class="side-buttons">\n                    <li>\n                        <button class="btn btn-danger btn-xs" type="button" ng-click="delete()"><span\n                                class="fa fa-remove"></span> Delete\n                        </button>\n                    </li>\n                    <li>\n                        <a class="btn btn-default btn-xs" type="button" href="/projects/{{project}}"><span\n                                class="fa fa-angle-double-left"></span> Back To Project</a>\n                    </li>\n                    <li>\n                        <a class="btn btn-default btn-xs" type="button" href="#top"><span\n                                class="fa fa-angle-double-up"></span> Back To Top</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/settings.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="bs-docs-header" id="content">\n    <div class="container">\n        <h1>Settings</h1>\n    </div>\n</div>\n\n<div class="container">\n    <div ui-grid="gridOptions" class="grid" ui-grid-auto-resize ui-grid-edit ui-grid-cellnav></div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/users.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="bs-docs-header" id="content">\n    <div class="container">\n        <h1>Users</h1>\n    </div>\n</div>\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-9" role="main">\n            <div class="bs-docs-section" id="users">\n                <h5 class="page-header">Users</h5>\n\n                <div ng-hide="filtered.length > 0" class="col-md-12 item-empty">Any user meets you search\n                    criteria..\n                </div>\n\n                <div id="users-{{$index}}" ng-repeat="user in filtered = (users | filter:search) | orderBy:\'name\'"\n                     class="well well-hover" ng-click="edit(user)">\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">{{user.name}}</dt>\n                        <dd></dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>username</dt>\n                        <dd>{{user.username}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>email</dt>\n                        <dd>{{user.email}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>roles</dt>\n                        <dd><span ng-repeat="role in user.roles"\n                                  ng-class="{label:true, \'label-danger\':role==\'admin\', \'label-default\':role!=\'admin\'}"\n                                  style="display: inline-block; margin-right: 10px;">{{role}}</span></dd>\n                    </dl>\n                </div>\n            </div>\n        </div>\n\n        <div class="col-md-3">\n            <div class="bs-docs-sidebar hidden-print hidden-xs hidden-sm" ui-scrollfix="+230">\n                <div class="input-group input-group-sm" style="width: 200px;">\n                    <span class="input-group-addon"><span class="fa fa-search"></span></span>\n                    <input type="text" class="form-control" ng-model="search" placeholder="Search">\n                </div>\n                <ul class="nav bs-docs-sidenav">\n                    <li du-spy-context du-scrollspy="users">\n                        <a href="#users" du-smooth-scroll>Users</a>\n                        <ul class="nav">\n                            <li ng-repeat="user in filtered | orderBy:\'name\'" du-spy-context\n                                du-scrollspy="users-{{$index}}">\n                                <a href="#users-{{$index}}" du-smooth-scroll>{{user.name}}</a>\n                            </li>\n                        </ul>\n                    </li>\n                </ul>\n                <a class="back-to-top" href="#top" du-smooth-scroll>Back to top</a>\n            </div>\n        </div>\n\n    </div>\n</div>')
}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/usersEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-edit"></span> {{user.name}}</h4></div>\n<div class="modal-body">\n    <form name="editUser" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Username</label>\n\n            <div class="col-sm-10">\n                <input name="username" ng-model="user.username" class="form-control" ng-trim="false"\n                       ui-validate="{exists: \'validateUsername($value)\' }" type="text" placeholder="Enter a username here"\n                       filtervalue="projectname" required/>\n            </div>\n        </div>\n\n        <div ng-show="editUser.username.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>User with same username already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="editUser.username.$dirty && editUser.username.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Username is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Email</label>\n\n            <div class="col-sm-10">\n                <input name="email" ng-model="user.email" class="form-control" ng-trim="false" type="text" placeholder="Optional"/>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Roles</label>\n\n            <div class="col-sm-10">\n                <ui-select name="roles" multiple ng-model="user.roles" style="width: 100%;" ng-disabled="!admin" ui-validate="{required: \'validateRolesRequired($value)\', admin: \'validateRolesAdmin($value)\'}">\n                    <ui-select-match placeholder="Select roles">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="role in roles | filter:$select.search">{{role}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div ng-show="editUser.roles.$error.admin" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Error!</strong>\n                <small>At least one user has to be an admin.</small>\n            </p>\n        </div>\n\n        <div ng-show="editUser.roles.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>At least one role is required.</small>\n            </p>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!editUser.$valid"\n            ng-click="edit()">Save Profile\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/version.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<span>Currently version <span style="font-weight: bolder">ui<span class="fa fa-at"></span>{{uiVersion}}</span> and <span style="font-weight: bolder">core<span class="fa fa-at"></span>{{coreVersion}}</span></span>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/viewer.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n<div ng-if="visualization.type == \'p5.js\'">\n    <p5 sketch="sketch"></p5>\n</div>\n\n<div ng-if="visualization.type == \'processing\' && ready">\n    <canvas processing="{{visualization.script}}"></canvas>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/visualizations.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="bs-docs-header" id="content">\n    <div class="container">\n        <h1>Visualizations</h1>\n    </div>\n</div>\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-12" role="main">\n            <div class="bs-docs-section">\n                <h5 class="page-header">My Visualizations</h5>\n\n                <div ng-hide="myVisualizations.length > 0" class="col-md-12 item-empty">You are not an author\n                    of any visualization.\n                </div>\n\n                <div class="row">\n                    <div ng-repeat="visualization in myVisualizations" class="col-sm-4">\n                        <div class="well well-hover" ng-click="detail(visualization)">\n                            <div class="background-cover"\n                                 style="background-image: url(\'{{visualization.thumbnail}}\'); width: 100%; height: 150px;"></div>\n\n                            <h3 class="text-center">{{visualization.name}}</h3>\n                            <span ng-show="visualization.public" class="label label-stamp label-success">public</span>\n                            <span ng-hide="visualization.public" class="label label-stamp label-danger">private</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="bs-docs-section" id="contributions-section">\n                <h5 class="page-header">Public Visualizations</h5>\n\n                <div ng-hide="publicVisualizations.length > 0" class="col-md-12 item-empty">There are no\n                    public visualization.\n                </div>\n\n                <div class="row">\n                    <div ng-repeat="visualization in publicVisualizations" class="col-sm-4">\n                        <div class="well">\n                            <div class="background-cover"\n                                 style="background-image: url(\'{{visualization.thumbnail}}\'); width: 100%; height: 150px;"></div>\n\n                            <h3 class="text-center">{{visualization.name}}</h3>\n                            <h5 class="text-center">by {{visualization.author.name}}</h5>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/visualizationsAdd.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new visualization</h4></div>\n<div class="modal-body">\n    <form name="newVisualization" class="form-horizontal">\n            <div ng-if="!second">\n                <div nv-file-drop="" uploader="uploader">\n                    <div nv-file-over="" uploader="uploader" over-class="drop-zone-over"\n                         class="well drop-zone">\n                        Drop your visualization script here\n                    </div>\n                </div>\n            </div>\n\n        <div ng-if="second">\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Script</label>\n\n                <div class="col-sm-10">\n                    <input name="file" ng-model="visualization.file.name" class="form-control" type="text" disabled/>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Name</label>\n\n                <div class="col-sm-10">\n                    <input name="name" ng-model="visualization.name" class="form-control" ng-trim="false"\n                           type="text" placeholder="Enter a name here" required/>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Type</label>\n\n                <div class="col-sm-10">\n                    <input name="type" ng-model="visualization.type" class="form-control" type="text" disabled/>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Description</label>\n\n                <div class="col-sm-10">\n                <textarea name="description" ng-model="visualization.description" class="form-control"\n                          placeholder="Enter a description here" rows="5"></textarea>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Author</label>\n\n                <div class="col-sm-10">\n                    <ui-select ng-model="visualization.author" required>\n                        <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                        <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <span ng-if="second" class="btn btn-default" ng-click="back()">Back</span>\n    <button ng-if="second" class="btn btn-danger" ng-disabled="!newVisualization.$valid"\n            ng-click="new()">Add Visualization\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/visualizationsDetail.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="bs-docs-header" id="content">\n    <div class="container">\n        <h1>{{visualization.name}}</h1>\n    </div>\n</div>\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-9" role="main">\n            <div class="bs-docs-section" id="information">\n                <h5 class="page-header">Visualization Information</h5>\n\n                <div class="well well-hover" ng-click="edit()">\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">{{visualization.name}}</dt>\n                        <dd>\n                            <span ng-show="visualization.public" class="label label-success">public</span>\n                            <span ng-hide="visualization.public" class="label label-danger">private</span>\n                        </dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>type</dt>\n                        <dd>{{visualization.type}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>description</dt>\n                        <dd>{{visualization.description}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>author</dt>\n                        <dd>{{visualization.author.name}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>type</dt>\n                        <dd>{{visualization.type}}</dd>\n                    </dl>\n                </div>\n            </div>\n\n            <tabset>\n                <tab heading="Editor">\n                    <div ng-if="ready" ui-ace="editorOption" ng-model="content"></div>\n                    <div class="pull-right" style="margin-top: 20px;">\n                        <button class="btn btn-danger" ng-click="save()">Save Script</button>\n                    </div>\n                </tab>\n            </tabset>\n        </div>\n\n        <div class="col-md-3">\n            <div class="bs-docs-sidebar hidden-print hidden-xs hidden-sm" ui-scrollfix="+230">\n                <ul class="side-buttons">\n                    <li>\n                        <button class="btn btn-danger btn-xs" type="button" ng-click="delete()"><span\n                                class="fa fa-remove"></span> Delete\n                        </button>\n                    </li>\n                    <li ng-hide="project">\n                        <a class="btn btn-default btn-xs" type="button" href="/visualizations"><span\n                                class="fa fa-angle-double-left"></span> Back To Visualizations</a>\n                    </li>\n                    <li ng-show="project">\n                        <a class="btn btn-default btn-xs" type="button" href="/projects/{{project}}#{{from}}"><span\n                                class="fa fa-angle-double-left"></span> Back To Project</a>\n                    </li>\n                    <li>\n                        <a class="btn btn-default btn-xs" type="button" href="#top"><span\n                                class="fa fa-angle-double-up"></span> Back To Top</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/visualizationsInformationEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-edit"></span> {{initial.name}}</h4></div>\n<div class="modal-body">\n    <form name="editVisualization" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Name</label>\n\n            <div class="col-sm-10">\n                <input name="name" ng-model="visualization.name" class="form-control" ng-trim="false"\n                       ui-validate="{exists: \'validateName($value)\' }"\n                       type="text" placeholder="Enter a name here" required/>\n            </div>\n        </div>\n\n        <div ng-show="editVisualization.name.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Visualization already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="editVisualization.name.$dirty && editVisualization.name.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Visualization name is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Description</label>\n\n            <div class="col-sm-10">\n                <textarea name="description" ng-model="visualization.description" class="form-control"\n                          placeholder="Enter a description here" rows="5"></textarea>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Author</label>\n\n            <div class="col-sm-10">\n                <ui-select ng-model="visualization.author" ng-disabled="!user.isAdmin()" ng-change="filter()" required>\n                    <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Public</label>\n\n            <div class="col-sm-10">\n                <input type="checkbox" ng-model="visualization.public"><span class="text-muted"\n                                                                             style="margin-left: 10px;">Turn this visualization into the public mode</span>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Script</label>\n\n            <div class="col-sm-10">\n                <div ng-show="visualization.file">\n                    <input name="file" ng-model="visualization.file.name" class="form-control" type="text" disabled/>\n                </div>\n                <div ng-hide="visualization.file">\n                    <div nv-file-drop="" uploader="uploader">\n                        <div nv-file-over="" uploader="uploader" over-class="drop-zone-over"\n                             class="well drop-zone">\n                            Drop your visualization script here if you would like to update it\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!editVisualization.$valid"\n            ng-click="edit()">Save Visualization\n    </button>\n</div>')}]),angular.module("narra.ui").factory("apiAuth",["$resource","serviceServer",function(e,t){return e(t.url+"/auth/:action",{},{providers:{method:"GET",params:{action:"providers"}}})}]),angular.module("narra.ui").factory("apiEvent",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/events/:scope/:param",{token:n.get()},{all:{method:"GET"},user:{method:"GET",params:{scope:"user"}}})}]),angular.module("narra.ui").factory("apiGenerator",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/generators",{token:n.get()},{all:{method:"GET"}})}]),angular.module("narra.ui").factory("apiItem",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/items/:id/:action0/:param/:action1",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},check:{method:"POST",params:{action0:"check"}},"new":{method:"POST",params:{action0:"new"}},"delete":{method:"GET",params:{action0:"delete"}},events:{method:"GET",params:{action0:"events"}},thumbnails:{method:"GET",params:{id:"thumbnails"}},regenerate:{method:"GET",params:{action0:"regenerate"}},metadata:{method:"GET",params:{id:"@id",action0:"metadata"}},metadataNew:{method:"POST",params:{id:"@id",action0:"metadata",action1:"new"}},metadataUpdate:{method:"POST",params:{id:"@id",param:"@meta",action0:"metadata",action1:"update"}},metadataDelete:{method:"GET",params:{action0:"metadata",action1:"delete"}}})}]),angular.module("narra.ui").factory("apiLibrary",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/libraries/:id/:action0/:param/:action1",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},"new":{method:"POST",params:{action0:"new"}},"delete":{method:"GET",params:{action0:"delete"}},items:{method:"GET",params:{action0:"items"}},update:{method:"POST",params:{id:"@id",action0:"update"}},regenerate:{method:"GET",params:{action0:"regenerate"}},metadataNew:{method:"POST",params:{id:"@id",action0:"metadata",action1:"new"}},metadataUpdate:{method:"POST",params:{id:"@id",param:"@meta",action0:"metadata",action1:"update"}},metadataDelete:{method:"GET",params:{action0:"metadata",action1:"delete"}}})}]),angular.module("narra.ui").factory("apiProject",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/projects/:name/:action0/:param/:action1",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},"new":{method:"POST",params:{action0:"new"}},"delete":{method:"GET",params:{action0:"delete"}},update:{method:"POST",params:{name:"@name",action0:"update"}},items:{method:"GET",params:{action0:"items"}},junctions:{method:"GET",params:{action0:"junctions"}},junctionsItems:{method:"GET",params:{action0:"junctions",action1:"items"}},sequences:{method:"GET",params:{action0:"sequences"}},sequencesNew:{method:"POST",headers:{"Content-Type":void 0},params:{name:"@name",action0:"sequences",action1:"new"}},sequencesDelete:{method:"GET",params:{action0:"sequences",action1:"delete"}},metadataNew:{method:"POST",params:{name:"@name",action0:"metadata",action1:"new"}},metadataUpdate:{method:"POST",params:{name:"@name",param:"@meta",action0:"metadata",action1:"update"}},metadataDelete:{method:"GET",params:{action0:"metadata",action1:"delete"}},visualizationsAction:{method:"POST",params:{name:"@name",action0:"visualizations",action1:"@action"}}})}]),angular.module("narra.ui").factory("apiSettings",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/settings/:name/:action",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},defaults:{method:"GET",params:{name:"defaults"}},update:{method:"POST",params:{name:"@name",action:"update"}}})}]),angular.module("narra.ui").factory("apiSynthesizers",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/synthesizers",{token:n.get()},{all:{method:"GET"}})}]),angular.module("narra.ui").factory("apiSystem",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/system/:action",{token:n.get()},{version:{method:"GET",params:{action:"version"}},modules:{method:"GET",params:{action:"modules"}}})}]),angular.module("narra.ui").factory("apiUser",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/users/:username/:action",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},profile:{method:"GET",params:{username:"me"}},signout:{method:"GET",params:{username:"me",action:"signout"}},roles:{method:"GET",params:{username:"roles"}},"delete":{method:"GET",params:{action:"delete"}},update:{method:"POST",params:{username:"@username",action:"update"}}})}]),angular.module("narra.ui").factory("apiVisualization",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/visualizations/:id/:action0",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},"new":{method:"POST",headers:{"Content-Type":void 0},params:{action0:"new"}},"delete":{method:"GET",params:{action0:"delete"}},update:{method:"POST",headers:{"Content-Type":void 0},params:{id:"@id",action0:"update"}}})}]),angular.module("narra.ui").controller("AddCtrl",["$scope","$rootScope","dialogs",function(e,t,n){return e.addProject=function(){var e;return e=n.create("partials/projectsAdd.html","ProjectsAddCtrl",{},{size:"lg",keyboard:!1}),e.result.then(function(e){return e.result.then(function(){return t.$broadcast("event:narra-project-created")})})},e.addLibrary=function(){var e;return e=n.create("partials/librariesAdd.html","LibrariesAddCtrl",{},{size:"lg",keyboard:!1}),e.result.then(function(e){return e.result.then(function(){return t.$broadcast("event:narra-library-created")})})},e.addItem=function(){var e;return e=n.create("partials/itemsAdd.html","ItemsAddCtrl",{},{size:"lg",keyboard:!1}),e.result.then(function(e){return e.result.then(function(){return t.$broadcast("event:narra-item-created")})})},e.addSequence=function(){var e;return e=n.create("partials/sequencesAdd.html","SequencesAddCtrl",{},{size:"lg",keyboard:!1}),e.result.then(function(e){return e.result.then(function(){return t.$broadcast("event:narra-sequence-created")})})},e.addVisualization=function(){var e;return e=n.create("partials/visualizationsAdd.html","VisualizationsAddCtrl",{},{size:"lg",keyboard:!1}),e.result.then(function(e){return e.result.then(function(){return t.$broadcast("event:narra-visualization-created")})})}}]),angular.module("narra.ui").controller("DashboardCtrl",["$scope","$rootScope","$location","$q","apiProject","apiItem","elzoidoPromises",function(e,t,n,i,r,o,s){return e.refresh=function(){var t,n;return n=i.defer(),t=i.defer(),o.thumbnails({param:10},function(t){return e.thumbnails=_.isEmpty(t.thumbnails)?["/images/empty_carousel.png"]:t.thumbnails,n.resolve(!0)}),r.all(function(n){return _.forEach(n.projects,function(e){var t;for(_.isUndefined(e.thumbnails)&&(e.thumbnails=[]),t=[];e.thumbnails.length<5;)t.push(e.thumbnails.push("/images/bars.png"));return t}),e.projects=_.where(n.projects,{"public":!0}),t.resolve(!0)}),s.register("dashboard",[t.promise,n.promise]),s.wait("dashboard","Loading dashboard ...")},e.view=function(e){return n.path("/viewer/"+e.name)},t.$on("event:narra-project-created",function(){return e.refresh()}),e.refresh()}]),angular.module("narra.ui").controller("EventsCtrl",["$scope","$rootScope","$interval","dialogs","apiEvent","elzoidoAuthUser",function(e,t,n,i,r,o){return e.refresh=function(){return r.user({param:o.get().username},function(t){return _.forEach(t.events,function(e){return e.progress=Math.floor(100*e.progress)}),e.events=t.events})},e.startRefreshInterval=function(){return angular.isDefined(e.refreshInterval)?void 0:(e.refresh(),e.refreshInterval=n(function(){return e.refresh()},5e3))},e.stopRefreshInterval=function(){return angular.isDefined(e.refreshInterval)?(n.cancel(e.refreshInterval),e.refreshInterval=void 0):void 0},e.$on("event:elzoido-auth-user",function(){return e.startRefreshInterval()}),e.$on("$destroy",function(){return e.stopRefreshInterval()}),e.$watch("events",function(e,n){var i;return i=_.difference(_.pluck(n,"id"),_.pluck(e,"id")),i.length>0?_.forEach(i,function(e){var i;return i=_.find(n,{id:e}),_.isUndefined(i.item)||t.$broadcast("event:narra-item-updated",i.item.id),_.isUndefined(i.project)?void 0:t.$broadcast("event:narra-project-updated",i.project.name)}):void 0})}]),angular.module("narra.ui").controller("InfoCtrl",["$scope","serviceVersion","apiSystem",function(e,t,n){return t.version(function(t){return e.uiVersion=t.version}),n.version(function(t){return e.coreVersion=t.version}),n.modules(function(t){return e.coreModules=t.modules})}]),angular.module("narra.ui").controller("ItemsAddCtrl",["$scope","$rootScope","$q","$timeout","$filter","$modalInstance","dialogs","apiItem","apiLibrary","apiUser","elzoidoMessages","elzoidoAuthUser","elzoidoPromises",function(e,t,n,i,r,o,s,a,l,u,c,h,d){return e.user=h.get(),e.item={url:"",library:"",author:e.user},l.all(function(t){var n;return n=angular.copy(t.libraries),e.user.isAdmin()||_.remove(n,function(t){return!_.contains(_.pluck(t.contributors,"username").concat([t.author.username]),e.user.username)}),e.libraries=n}),u.all(function(t){return e.users=t.users}),e.close=function(){return o.dismiss("canceled")},e.next=function(){var t,r,o;return e.items=[],o=s.wait("Please Wait","Checking new items ..."),r=[],t=e.item.url.split("\n"),_.forEach(t,function(t){var o;return o=n.defer(),r.push(o.promise),i(function(){return a.check({url:t},function(t){return _.isNull(t.item.thumbnail)&&(t.item.thumbnail="/images/bars.png"),e.items.push(t.item),o.resolve(!0)},function(){return o.resolve(!0)})},100)}),d.register("check-items",r),d.promise("check-items").then(function(){return o.close(),e.second=!0})},e.back=function(){return e.items=[],e.second=!1},e["new"]=function(){var t,r;return r=s.wait("Please Wait","Registering new items ..."),o.close(r),t=[],_.forEach(e.items,function(r){var o;return o=n.defer(),t.push(o.promise),i(function(){return a["new"]({url:r.url,author:e.item.author.name,library:e.item.library.id,connector:r.connector},function(){return o.resolve(!0)},function(){return o.resolve(!0),c.send("danger","Error!","Item "+r.name+" encountered problem.")
})},100)}),d.register("add-items",t),d.promise("add-items").then(function(){return c.send("success","Success!","Items were successfully created."),r.close()})}}]),angular.module("narra.ui").controller("ItemsDetailCtrl",["$scope","$rootScope","$routeParams","$location","$sce","$document","$interval","$timeout","$filter","$q","dialogs","apiProject","apiLibrary","apiItem","apiUser","uiGmapGoogleMapApi","constantMetadata","elzoidoPromises","elzoidoMessages","elzoidoAuthUser",function(e,t,n,i,r,o,s,a,l,u,c,h,d,p,f,g,m,v,y,b){return e.library=n.library,e.project=n.project,e.from=n.from,e.fromPrevious=n.fromPrevious,e.player={api:void 0,ready:!1,preload:!0,autoHide:!1,autoHideTime:2e3,autoPlay:!1,sources:[],tracks:[],cuePoints:{},plugins:{}},e.refresh=function(){var t,i;return e.user=b.get(),t=u.defer(),i=u.defer(),d.get({id:n.library},function(t){return e.generators=t.library.generators,i.resolve(!0)}),p.get({id:n.item},function(n){var i;return e.player.sources=[{src:r.trustAsResourceUrl(n.item.video_proxy_hq),type:"video/webm"}],e.duration=_.where(n.item.metadata,{name:"duration"})[0].value,e.item=n.item,e.cuepoints=_.reduce(n.item.metadata,function(t,n){var i;return _.isUndefined(n.marks)||!(n.marks.length>0)||_.isEqual(n.generator,"thumbnail")||_.isEqual(n.generator,"transcoder")||_.isEqual(n.generator,"att_speech")||(i={timeLapse:{start:n.marks[0]["in"]},onUpdate:function(){return e.active=!0,e.live=n},onComplete:function(){return e.active=!1,a(function(){return e.active?void 0:e.live=void 0},2e3)}},i.timeLapse.end=_.isUndefined(n.marks[0].out)?n.marks[0]["in"]+.3:n.marks[0].out,t.push(i)),t},[]),i=_.uniq(_.pluck(e.item.metadata,"generator")),e.metadataProviders=_.filter(m.providers,function(e){return!_.include(i,e.id)||_.isEqual(e.id,"user_custom")}),e.player.cuePoints={metadata:e.cuepoints},e.player.ready=!0,t.resolve(!0)}),v.register("item",[t.promise,i.promise]),v.wait("item","Loading item ...")},e["delete"]=function(){var t;return t=c.confirm("Please Confirm","You are about to delete the item "+e.item.name+", this procedure is irreversible. Do you want to continue ?"),t.result.then(function(){return p["delete"]({id:e.item.id},function(){return i.url("/libraries/"+e.library+"#"+e.from),y.send("success","Success!","Item "+e.item.name+" was successfully deleted.")})})},e.onPlayerReady=function(t){return e.player.api=t},e.seek=function(t){return e.api.seekTime(t)},e.isLink=function(e){return 0===e.indexOf("http")},e.$on("event:narra-item-updated",function(t,i){return _.isEqual(n.item,i)?(e.player.ready=!1,e.refresh()):void 0}),e.refresh()}]),angular.module("narra.ui").controller("LibrariesCtrl",["$scope","$rootScope","$location","$interval","$filter","$q","dialogs","apiProject","apiLibrary","apiUser","elzoidoPromises","elzoidoAuthUser","elzoidoMessages",function(e,t,n,i,r,o,s,a,l,u,c,h){return e.rotation={},e.thumbnail={},e.refresh=function(){var t;return e.user=h.get(),t=o.defer(),l.all(function(n){return _.forEach(n.libraries,function(t){for(_.isUndefined(t.thumbnails)&&(t.thumbnails=[]);t.thumbnails.length<5;)t.thumbnails.push("/images/bars.png");return e.thumbnail[t.name]=t.thumbnails[0]}),e.libraries=_.filter(n.libraries,function(t){return _.isEqual(t.author.username,e.user.username)}),e.contributions=_.filter(n.libraries,function(t){return _.contains(_.pluck(t.contributors,"username"),e.user.username)}),t.resolve(!0)}),c.register("libraries",[t.promise]),c.wait("dashboard","Loading libraries ...")},e.startRotation=function(t){var n;if(!angular.isDefined(e.rotation[t.name]))return n=0,e.rotation[t.name]=i(function(){return n+1===t.thumbnails.length?n=0:n++,e.thumbnail[t.name]=t.thumbnails[n]},600)},e.stopRotation=function(t){return angular.isDefined(e.rotation[t.name])?(i.cancel(e.rotation[t.name]),e.rotation[t.name]=void 0,e.thumbnail[t.name]=t.thumbnails[0]):void 0},t.$on("event:elzoido-auth-user",function(){return e.refresh()}),t.$on("event:narra-library-created",function(){return e.refresh()}),e.detail=function(e){return n.path("/libraries/"+e.id)},e.refresh()}]),angular.module("narra.ui").controller("LibrariesAddCtrl",["$scope","$filter","$modalInstance","dialogs","apiLibrary","apiProject","apiUser","apiGenerator","elzoidoMessages","elzoidoAuthUser",function(e,t,n,i,r,o,s,a,l,u){return e.user=u.get(),e.library={name:"",description:"",author:e.user,contributors:[],generators:[],project:""},r.all(function(t){return e.libraries=t.libraries}),o.all(function(t){var n;return n=angular.copy(t.projects),e.user.isAdmin()||_.remove(n,function(t){return!_.contains(_.pluck(t.contributors,"username").concat([t.author.username]),e.user.username)}),e.projects=n}),s.all(function(t){return e.users=t.users,e.filter()}),a.all(function(t){return e.generators=t.generators}),e.filter=function(){var t;return t=angular.copy(e.users),_.remove(t,function(t){return _.isEqual(t.username,e.library.author.username)}),e.contributors=t},e.close=function(){return n.dismiss("canceled")},e["new"]=function(){var t;return t=i.wait("Please Wait","Registering new library ..."),n.close(t),r["new"]({name:e.library.name,author:e.library.author.username,description:e.library.description,generators:_.pluck(e.library.generators,"identifier"),contributors:_.pluck(e.library.contributors,"username"),project:e.library.project.name},function(e){return t.close(e.library.id),l.send("success","Success!","Library "+e.library.name+" was successfully created.")})},e.validateName=function(t){return!_.contains(_.pluck(e.libraries,"name"),t)}}]),angular.module("narra.ui").controller("LibrariesDetailCtrl",["$scope","$rootScope","$routeParams","$location","$document","$interval","$filter","$q","dialogs","apiProject","apiLibrary","apiUser","elzoidoPromises","elzoidoAuthUser","elzoidoMessages",function(e,t,n,i,r,o,s,a,l,u,c,h,d,p,f){return e.project=n.project,e.from=n.from,e.rotation={},e.thumbnail={},e.refresh=function(){var t,i;return e.user=p.get(),i=a.defer(),t=a.defer(),c.get({id:n.library},function(t){return t.library.metadata=_.filter(t.library.metadata,function(e){return!_.isEqual(e.name,"shared")}),e.library=t.library,i.resolve(!0)}),c.items({id:n.library},function(n){return _.forEach(n.items,function(t){return _.isUndefined(t.thumbnails)&&(t.thumbnails=["/images/bars.png"]),e.thumbnail[t.name]=t.thumbnails[0]}),e.items=n.items,t.resolve(!0)}),d.register("library",[i.promise,t.promise]),d.wait("library","Loading library ...")},e.edit=function(){var i;return i=l.create("partials/librariesInformationEdit.html","LibrariesInformationEditCtrl",{library:e.library},{size:"lg",keyboard:!1}),i.result.then(function(e){return e.result.then(function(){return t.$broadcast("event:narra-library-updated",n.library)})})},e["delete"]=function(){var t;return t=l.confirm("Please Confirm","You are about to delete the library "+e.library.name+", this procedure is irreversible. Do you want to continue ?"),t.result.then(function(){return c["delete"]({id:e.library.id},function(){return f.send("success","Success!","Library "+e.library.name+" was successfully deleted."),_.isUndefined(e.project)?i.url("/libraries"):i.url("/projects/"+e.project+"#"+e.from)})})},e.detail=function(t,n){var r;return r="/items/"+t.id+"?library="+e.library.id+"&from=items-"+n,_.isUndefined(e.project)||(r=r+"&project="+e.project+"&fromPrevious="+e.from),i.url(r)},e.startRotation=function(t){var n;if(!angular.isDefined(e.rotation[t.name]))return n=0,e.rotation[t.name]=o(function(){return n+1===t.thumbnails.length?n=0:n++,e.thumbnail[t.name]=t.thumbnails[n]},600)},e.stopRotation=function(t){return angular.isDefined(e.rotation[t.name])?(o.cancel(e.rotation[t.name]),e.rotation[t.name]=void 0,e.thumbnail[t.name]=t.thumbnails[0]):void 0},e.$on("event:narra-item-created",function(){return _.isUndefined(n.library)?void 0:e.refresh()}),e.$on("event:narra-item-updated",function(t,i){return!_.isUndefined(n.library)&&_.find(e.items,{id:i})?e.refresh():void 0}),e.$on("event:narra-library-updated",function(t,i){return!_.isUndefined(n.library)&&_.isEqual(n.library,i)?e.refresh():void 0}),e.$on("event:narra-render-finished",function(){return _.isEmpty(i.hash())?void 0:r.duScrollToElement(document.getElementById(i.hash()))}),e.refresh()}]),angular.module("narra.ui").controller("LibrariesInformationEditCtrl",["$scope","$filter","$modalInstance","dialogs","apiProject","apiLibrary","apiUser","apiGenerator","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o,s,a,l,u,c){return e.user=u.get(),e.library=c.library,e.initial=angular.copy(c.library),o.all(function(t){return e.libraries=t.libraries}),r.all(function(t){return e.projects=t.projects}),s.all(function(t){return e.users=t.users,e.filter()}),a.all(function(t){return e.generators=t.generators}),e.filter=function(){return e.contributors=_.filter(e.users,function(t){return!_.isEqual(e.library.author.username,t.username)})},e.close=function(){return n.dismiss("canceled")},e.edit=function(){var t;return t=i.wait("Please Wait","Saving library ..."),n.close(t),o.update({id:e.library.id,name:e.library.name,author:e.library.author.username,description:e.library.description,generators:_.pluck(e.library.generators,"identifier"),contributors:_.pluck(e.library.contributors,"username")},function(n){return o.metadataUpdate({id:n.library.id,meta:"shared",value:e.library.shared.toString()},function(){return t.close(n.library),l.send("success","Success!","Library "+n.library.name+" was successfully saved.")})})},e.validateName=function(t){return!_.contains(_.pluck(e.libraries,"name"),t)}}]),angular.module("narra.ui").controller("MetadataCtrl",["$scope","$rootScope","$routeParams","dialogs","constantMetadata","elzoidoMessages","apiItem","apiLibrary","apiProject",function(e,t,n,i,r,o,s,a,l){return e.refresh=function(){var n,u;switch(e.api=e.api||{},e.type){case"item":return e.item=e.data,u={},n=[],_.forEach(_.filter(_.uniq(_.pluck(e.item.metadata,"generator")),function(e){return!_.isEqual(e,"thumbnail")&&!_.isEqual(e,"transcoder")}),function(t){return n.push(t),t.indexOf("user")>-1?(_.isUndefined(u.user)&&(u.user={name:"user",data:[]}),u.user.data=u.user.data.concat(_.where(e.item.metadata,{generator:t}))):u[t]={name:t,data:_.where(e.item.metadata,{generator:t})}}),e.meta=u,e.generators=n,e.edit=function(n){var a,l,u;return u=_.find(r.providers,{id:n.generator}),_.isUndefined(u)&&(u=_.find(r.providers,{id:"user_custom"})),l={use:!_.isEmpty(n.marks),"in":_.isEmpty(n.marks)?Math.floor(e.player.currentTime/1e3):n.marks[0]["in"],out:_.isEmpty(n.marks)?void 0:n.marks[0].out,max:Math.floor(e.player.totalTime/1e3)},a=i.create(u.templateEdit,u.controller,{meta:n,seek:e.seek,mark:l},{size:"lg",keyboard:!1}),a.result.then(function(r){var a;switch(r.action){case"update":return a=i.wait("Please Wait","Updating metadata ..."),_.isArray(r.meta.value)&&(r.meta.value=r.meta.value.join(", ")),s.metadataUpdate({id:e.item.id,meta:r.meta.name,value:r.meta.value,marks:r.meta.marks,generator:n.generator},function(){return a.close(),o.send("success","Success!","Metadata was successfully updated."),t.$broadcast("event:narra-item-updated",e.item.id)});case"delete":return a=i.wait("Please Wait","Deleting metadata ..."),s.metadataDelete({id:e.item.id,param:r.meta.name,generator:n.generator},function(){return a.close(),o.send("success","Success!","Metadata was successfully deleted."),t.$broadcast("event:narra-item-updated",e.item.id)})}})},e.api.regenerate=function(n){var r;return r=i.confirm("Please Confirm","You are about to regenerate the item "+e.item.name+", this will erase all metadata by the generator. Do you want to continue ?"),r.result.then(function(){return s.regenerate({id:e.item.id,param:n},function(){return o.send("success","Success!","Item "+e.item.name+" was successfully deleted."),t.$broadcast("event:narra-item-updated",e.item.id)})})},e.api.add=function(n){var r;return r=i.create(n.templateAdd,n.controller,{all:_.pluck(e.item.metadata,"name"),seek:e.seek,mark:{use:!1,"in":Math.floor(e.player.currentTime/1e3),max:Math.floor(e.player.totalTime/1e3)},out:void 0},{size:"lg",keyboard:!1}),r.result.then(function(r){var a;return a=i.wait("Please Wait","Adding new metadata ..."),_.isArray(r.value)&&(r.value=r.value.join(", ")),s.metadataNew({id:e.item.id,meta:r.name,value:r.value,marks:r.marks,generator:n.id},function(){return a.close(),o.send("success","Success!","New metadata was successfully created."),t.$broadcast("event:narra-item-updated",e.item.id)})})};case"library":return e.library=e.data,e.meta=e.library.metadata,e.edit=function(n){var s,l;return l=_.find(r.providers,{id:"user_custom"}),s=i.create(l.templateEdit,l.controller,{meta:n},{size:"lg",keyboard:!1}),s.result.then(function(n){var r;switch(n.action){case"update":return r=i.wait("Please Wait","Updating metadata ..."),a.metadataUpdate({id:e.library.id,meta:n.meta.name,value:n.meta.value},function(){return r.close(),o.send("success","Success!","Metadata was successfully updated."),t.$broadcast("event:narra-library-updated",e.library.id)});case"delete":return r=i.wait("Please Wait","Deleting metadata ..."),a.metadataDelete({id:e.library.id,param:n.meta.name},function(){return r.close(),o.send("success","Success!","Metadata was successfully deleted."),t.$broadcast("event:narra-library-updated",e.library.id)})}})},e.api.regenerate=function(n){var r;return r=i.confirm("Please Confirm","You are about to regenerate the library "+e.library.name+", this will erase all metadata by the generator. Do you want to continue ?"),r.result.then(function(){return a.regenerate({id:e.library.id,param:n},function(){return o.send("success","Success!","Library "+e.library.name+" was successfully regenerated."),t.$broadcast("event:narra-library-updated",e.library.id)})})},e.api.add=function(){var n,s;return s=_.find(r.providers,{id:"user_custom"}),n=i.create(s.templateAdd,s.controller,{all:_.pluck(e.library.metadata,"name")},{size:"lg",keyboard:!1}),n.result.then(function(n){var r;return r=i.wait("Please Wait","Adding new metadata ..."),a.metadataNew({id:e.library.id,meta:n.name,value:n.value},function(){return r.close(),o.send("success","Success!","New metadata was successfully created."),t.$broadcast("event:narra-library-updated",e.library.id)})})};case"project":return e.project=e.data,e.meta=e.project.metadata,e.edit=function(n){var s,a;return a=_.find(r.providers,{id:"user_custom"}),s=i.create(a.templateEdit,a.controller,{meta:n},{size:"lg",keyboard:!1}),s.result.then(function(n){var r;switch(n.action){case"update":return r=i.wait("Please Wait","Updating metadata ..."),l.metadataUpdate({name:e.project.name,meta:n.meta.name,value:n.meta.value},function(){return r.close(),o.send("success","Success!","Metadata was successfully updated."),t.$broadcast("event:narra-project-updated",e.project.name)});case"delete":return r=i.wait("Please Wait","Deleting metadata ..."),l.metadataDelete({name:e.project.name,param:n.meta.name},function(){return r.close(),o.send("success","Success!","Metadata was successfully deleted."),t.$broadcast("event:narra-project-updated",e.project.name)})}})},e.api.add=function(){var n,s;return s=_.find(r.providers,{id:"user_custom"}),n=i.create(s.templateAdd,s.controller,{all:_.pluck(e.project.metadata,"name").concat(["public"])},{size:"lg",keyboard:!1}),n.result.then(function(n){var r;return r=i.wait("Please Wait","Adding new metadata ..."),l.metadataNew({name:e.project.name,meta:n.name,value:n.value},function(){return r.close(),o.send("success","Success!","New metadata was successfully created."),t.$broadcast("event:narra-project-updated",e.project.name)})})}}},e.$watch("data",function(t){return _.isUndefined(t)?void 0:e.refresh()}),e.seek=function(t){return e.player.seekTime(t)},t.$on("event:narra-item-updated",function(t,i){return _.isEqual(e.type,"item")&&_.isEqual(n.item,i)?e.refresh():void 0}),t.$on("event:narra-library-updated",function(t,i){return _.isEqual(e.type,"library")&&_.isEqual(n.library,i)?e.refresh():void 0}),t.$on("event:narra-project-updated",function(t,i){return _.isEqual(e.type,"project")&&_.isEqual(n.project,i)?e.refresh():void 0})}]),angular.module("narra.ui").controller("MetadataCustomCtrl",["$scope","$modalInstance","dialogs","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o){return e.user=r.get(),e.all=o.all,e.meta=_.isUndefined(o.meta)?{name:"",value:""}:o.meta,_.isUndefined(o.mark)||(e.seek=o.seek,e.mark=o.mark,e.$watch("mark.in",function(t){return _.isUndefined(t)?void 0:e.seek(t)}),e.$watch("mark.out",function(t){return _.isUndefined(t)?void 0:e.seek(t)})),e.validateName=function(t){return!_.contains(e.all,t)},e.close=function(){return t.dismiss("canceled")},e.add=function(){return!_.isUndefined(e.mark)&&e.mark.use&&(e.meta=_.merge(e.meta,{marks:[{"in":e.mark["in"],out:e.mark.out}]})),t.close(e.meta)},e.edit=function(){return _.isUndefined(e.mark)||(e.mark.use?e.meta=_.merge(e.meta,{marks:[{"in":e.mark["in"],out:e.mark.out}]}):e.meta.marks=[]),t.close({action:"update",meta:e.meta})},e["delete"]=function(){return t.close({action:"delete",meta:e.meta})}}]),angular.module("narra.ui").controller("MetadataLocationCtrl",["$scope","$modalInstance","dialogs","elzoidoAuthUser","data",function(e,t,n,i,r){return e.user=i.get(),e.meta=_.isUndefined(r.meta)?{name:"location",value:""}:r.meta,e.close=function(){return t.dismiss("canceled")},e.add=function(){return _.isUndefined(e.meta.value.formatted_address)||(e.meta.value=e.meta.value.formatted_address),t.close(e.meta)},e.edit=function(){return _.isUndefined(e.meta.value.formatted_address)||(e.meta.value=e.meta.value.formatted_address),t.close({action:"update",meta:e.meta})},e["delete"]=function(){return t.close({action:"delete",meta:e.meta})}}]),angular.module("narra.ui").controller("MetadataShotTypeCtrl",["$scope","$modalInstance","dialogs","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o){return e.user=r.get(),_.isUndefined(o.meta)?e.meta={name:"shot_type",value:""}:(e.meta=o.meta,e.meta.value=_.map(o.meta.value.split(","),function(e){return e.trim()})),e.shots=["Aerial Shot","Arc Shot","Bridging Shot","Close Up","Medium Shot","Long Shot","Cowboy Shot","Deep Focus","Dolly Zoom","Dutch Tilt","Establishing Shot","Handheld Shot","Low Angle Shot","High Angle Shot","Locked-Down Shot","Library Shot","Matte Shot","Money Shot","Over-The-Shoulder Shot","Pan","POV","The Sequence Shot","Steadicam Shot","Tilt","Top Shot","Tracking Shot","Two-Shot","Whip Pan","Zoom","Crane Shot","Static Shot"],e.close=function(){return t.dismiss("canceled")},e.add=function(){return t.close(e.meta)},e.edit=function(){return t.close({action:"update",meta:e.meta})},e["delete"]=function(){return t.close({action:"delete",meta:e.meta})}}]),angular.module("narra.ui").controller("ProjectsCtrl",["$scope","$rootScope","$location","$filter","$q","dialogs","apiProject","apiUser","elzoidoPromises","elzoidoAuthUser","elzoidoMessages",function(e,t,n,i,r,o,s,a,l,u){return e.refresh=function(){var t;return e.user=u.get(),t=r.defer(),s.all(function(n){return _.forEach(n.projects,function(e){var t;for(_.isUndefined(e.thumbnails)&&(e.thumbnails=[]),t=[];e.thumbnails.length<5;)t.push(e.thumbnails.push("/images/bars.png"));return t}),e.projects=_.filter(n.projects,function(t){return _.isEqual(t.author.username,e.user.username)}),e.contributions=_.filter(n.projects,function(t){return _.contains(_.pluck(t.contributors,"username"),e.user.username)}),t.resolve(!0)}),l.register("dashboard",[t.promise]),l.wait("dashboard","Loading projects ...")},e.detailProject=function(e){return n.path("/projects/"+e.name)},t.$on("event:elzoido-auth-user",function(){return e.refresh()}),t.$on("event:narra-project-created",function(){return e.refresh()}),e.detail=function(e){return n.path("/projects/"+e.name)},e.refresh()}]),angular.module("narra.ui").controller("ProjectsAddCtrl",["$scope","$filter","$modalInstance","dialogs","apiProject","apiUser","elzoidoMessages","elzoidoAuthUser",function(e,t,n,i,r,o,s,a){return e.user=a.get(),e.project={name:"",title:"",author:e.user,description:"",contributors:[]},r.all(function(t){return e.projects=t.projects}),o.all(function(t){return e.users=t.users,e.filter()}),e.filter=function(){var t;return t=angular.copy(e.users),_.remove(t,function(t){return _.isEqual(t.username,e.project.author.username)}),e.contributors=t},e.close=function(){return n.dismiss("canceled")},e["new"]=function(){var o,a;return a=i.wait("Please Wait","Registering new project ..."),n.close(a),o=t("projectname")(e.project.name),r["new"]({name:o,title:e.project.title,author:e.project.author.username,description:e.project.description,contributors:_.pluck(e.project.contributors,"username")},function(e){return a.close(e.project.name),s.send("success","Success!","Project "+e.project.title+" was successfully created.")})},e.validateName=function(n){return!_.contains(_.pluck(e.projects,"name"),t("projectname")(n))},e.validateTitle=function(t){return!_.contains(_.pluck(e.projects,"title"),t)}}]),angular.module("narra.ui").controller("ProjectsDetailCtrl",["$scope","$rootScope","$document","$routeParams","$location","$filter","$q","dialogs","apiProject","apiVisualization","apiUser","elzoidoPromises","elzoidoMessages","elzoidoAuthUser",function(e,t,n,i,r,o,s,a,l,u,c,h,d,p){return e.refresh=function(){var t,n,r;return e.user=p.get(),t=s.defer(),n=s.defer(),r=s.defer(),l.get({name:i.project},function(n){return _.forEach(n.project.visualizations,function(e){return e.thumbnail="/images/bars.png"}),_.forEach(n.project.libraries,function(e){var t;for(_.isUndefined(e.thumbnails)&&(e.thumbnails=[]),t=[];e.thumbnails.length<5;)t.push(e.thumbnails.push("/images/bars.png"));return t}),n.project.metadata=_.filter(n.project.metadata,function(e){return!_.isEqual(e.name,"public")}),e.project=n.project,t.resolve(!0)}),l.sequences({name:i.project},function(t){return e.sequences=t.sequences,n.resolve(!0)}),u.all(function(t){return e.visualizations=_.filter(t.visualizations,function(t){return t["public"]&&!_.contains(_.pluck(e.project.visualizations,"id"),t.id)}),r.resolve(!0)}),h.register("project",[t.promise,n.promise,r.promise]),h.wait("project","Loading project ...")},e.edit=function(){var n;return n=a.create("partials/projectsInformationEdit.html","ProjectsInformationEditCtrl",{project:e.project},{size:"lg",keyboard:!1}),n.result.then(function(e){return e.result.then(function(e){return t.$broadcast("event:narra-project-updated",e.name)})})},e["delete"]=function(){var t;return t=a.confirm("Please Confirm","You are about to delete the project "+e.project.title+", this procedure is irreversible. Do you want to continue ?"),t.result.then(function(){return l["delete"]({name:e.project.name},function(){return r.url("/projects/"),d.send("success","Success!","Project "+e.project.name+" was successfully deleted.")})})},e.detailLibrary=function(t,n){return r.url("/libraries/"+t.id+"?project="+e.project.name+"&from=libraries-"+n)},e.detailSequence=function(t){return r.url("/sequences/"+t.id+"?project="+e.project.name)},e.addVisualization=function(t){return l.visualizationsAction({name:e.project.name,action:"add",visualizations:[t.id]},function(){return d.send("success","Success!","Visualization "+t.name+" was successfully added."),e.refresh()})},e.removeVisualization=function(t){return l.visualizationsAction({name:e.project.name,action:"remove",visualizations:[t.id]},function(){return d.send("success","Success!","Visualization "+t.name+" was successfully removed."),e.refresh()})},e.$on("event:narra-library-created",function(){return _.isUndefined(i.project)?void 0:e.refresh()}),e.$on("event:narra-sequence-created",function(){return _.isUndefined(i.project)?void 0:e.refresh()}),e.$on("event:narra-project-updated",function(t,n){return _.isEqual(i.project,n)?e.refresh():void 0}),e.refresh()}]),angular.module("narra.ui").controller("ProjectsInformationEditCtrl",["$scope","$filter","$modalInstance","dialogs","apiProject","apiUser","apiSynthesizers","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o,s,a,l,u){return e.user=l.get(),e.project=u.project,e.initial=angular.copy(u.project),r.all(function(t){return e.projects=t.projects}),o.all(function(t){return e.users=t.users,e.filter()}),s.all(function(t){return e.synthesizers=t.synthesizers}),e.filter=function(){return e.contributors=_.filter(e.users,function(t){return!_.isEqual(e.project.author.username,t.username)})},e.close=function(){return n.dismiss("canceled")},e.edit=function(){var o,s;return s=i.wait("Please Wait","Saving project ..."),n.close(s),o=t("projectname")(e.project.name),r.update({name:e.initial.name,new_name:o,title:e.project.title,author:e.project.author.username,description:e.project.description,synthesizers:_.pluck(e.project.synthesizers,"identifier"),contributors:_.pluck(e.project.contributors,"username")},function(t){return r.metadataUpdate({name:t.project.name,meta:"public",value:e.project["public"].toString()},function(){return s.close(t.project),a.send("success","Success!","Project "+t.project.title+" was successfully saved.")})})},e.validateName=function(n){return!(_.contains(_.pluck(e.projects,"name"),t("projectname")(n))&&!_.isEqual(n,e.initial.name))},e.validateTitle=function(t){return!(_.contains(_.pluck(e.projects,"title"),t)&&!_.isEqual(t,e.initial.title))}}]),angular.module("narra.ui").controller("SequencesAddCtrl",["$scope","$modalInstance","$timeout","dialogs","apiProject","apiUser","elzoidoMessages","elzoidoAuthUser",function(e,t,n,i,r,o,s,a){return e.user=a.get(),e.sequence={type:"edl",title:"",project:"",author:e.user,file:"",fps:"25"},r.all(function(t){return e.projects=t.projects}),o.all(function(t){return e.users=t.users}),e.setFile=function(t){return e.$apply(function(){return e.sequence.file=t.files[0],e.sequence.title=t.files[0].name.split(".")[0]})},e.close=function(){return t.dismiss("canceled")},e["new"]=function(){var o,a;return o=new FormData,o.append("type",e.sequence.type),o.append("title",e.sequence.title),o.append("author",e.sequence.author.username),o.append("file",e.sequence.file),a=i.wait("Please Wait","Registering new sequence ..."),t.close(a),r.sequencesNew({name:e.sequence.project.name,params:{edl_fps:e.sequence.fps}},o,function(){return n(function(){return a.close(e.sequence.title),s.send("success","Success!","Sequence "+e.sequence.title+" was successfully created.")},1e3)})}}]),angular.module("narra.ui").controller("SequencesDetailCtrl",["$scope","$sce","$timeout","$rootScope","$routeParams","$location","$document","$interval","$filter","$q","dialogs","apiProject","apiUser","elzoidoPromises","elzoidoAuthUser","elzoidoMessages",function(e,t,n,i,r,o,s,a,l,u,c,h,d,p,f,g){return e.project=r.project,e.sequence=r.sequence,e.player={api:void 0,ready:!1,preload:!0,autoHide:!1,autoHideTime:2e3,autoPlay:!1,sources:[],playlist:[],current:0,tracks:[],cuePoints:{},plugins:{}},e.refresh=function(){var n;return e.user=f.get(),n=u.defer(),h.sequences({name:e.project,param:r.sequence},function(i){return e.sequence=i.sequence,_.forEach(e.sequence.marks,function(n){return e.player.playlist.push({"in":n["in"],out:n.out,src:{src:t.trustAsResourceUrl(n.clip.source),type:"video/webm"}})}),e.player.sources=[e.player.playlist[0].src],n.resolve(!0)}),n.promise.then(function(){return e.player.ready=!0}),p.register("sequence",[n.promise]),p.wait("sequence","Loading sequence ...")},e.onPlayerReady=function(t){return e.player.api=t,n(function(){return e.player.api.seekTime(e.player.playlist[0]["in"])},0)},e.playlistHandler=function(t){return t>=e.player.playlist[e.player.current].out?(e.player.current+=1,e.playerAction()):void 0},e.seek=function(t){return e.player.current=t,e.playerAction()},e.playerAction=function(){return e.player.current!==e.player.playlist.length?(e.player.sources=[e.player.playlist[e.player.current].src],n(function(){return e.player.api.seekTime(e.player.playlist[e.player.current]["in"]),e.player.api.play()},0)):(e.player.api.stop(),e.player.current=0,e.player.sources=[e.player.playlist[e.player.current].src],n(function(){return e.player.api.seekTime(e.player.playlist[e.player.current]["in"])},0))},e.isActive=function(t){return e.player.current===t},e["delete"]=function(){var t;return t=c.confirm("Please Confirm","You are about to delete the sequence "+e.sequence.name+", this procedure is irreversible. Do you want to continue ?"),t.result.then(function(){return h.sequencesDelete({name:e.project,param:e.sequence.id},function(){return g.send("success","Success!","Sequence "+e.sequence.name+" was successfully deleted."),o.url("/projects/"+e.project)})})},e.refresh()}]),angular.module("narra.ui").controller("SettingsCtrl",["$scope","$q","apiSettings","elzoidoMessages","elzoidoPromises",function(e,t,n,i,r){return e.gridOptions={data:"settings"},e.gridOptions.enableCellEditOnFocus=!0,e.gridOptions.columnDefs=[{name:"name",displayName:"Name",enableCellEdit:!1},{name:"value",displayName:"Value",enableCellEdit:!0}],e.gridOptions.onRegisterApi=function(t){return t.edit.on.afterCellEdit(e,function(e){return n.update(e,function(){return i.send("success","Success!","Property "+e.name+" was successfully updated.")})})},e.refresh=function(){var i,o;return i=t.defer(),o=t.defer(),n.all(function(t){return e.settings=t.settings,angular.element(document.getElementsByClassName("grid")[0]).css("width","100%"),angular.element(document.getElementsByClassName("grid")[0]).css("height",Math.floor(33*e.settings.length)+"px"),i.resolve(!0)}),n.defaults(function(t){return e.defaults=t.defaults,o.resolve(!0)}),r.register("settings",[i.promise,o.promise]),r.wait("settings","Loading settings ...")},e.refresh()}]),angular.module("narra.ui").controller("UsersCtrl",["$scope","$rootScope","$q","$location","dialogs","apiUser","elzoidoPromises","elzoidoAuthUser","elzoidoAuthAPI",function(e,t,n,i,r,o,s,a,l){return e.refresh=function(){var t;return t=n.defer(),o.all(function(n){return e.users=n.users,e.empty=n.length<1,t.resolve(!0)}),s.register("users",t.promise),s.wait("users","Loading users ...")},e.edit=function(e){var n;return n=r.create("partials/usersEdit.html","UsersEditCtrl",{user:e},{size:"lg",keyboard:!1}),n.result.then(function(n){return n.result.then(function(){return t.$broadcast("event:narra-user-updated"),_.isEqual(e.username,a.get().username)?l.signin():void 0})})},t.$on("event:narra-user-updated",function(){return e.refresh()}),e.refresh()}]),angular.module("narra.ui").controller("UsersEditCtrl",["$scope","$q","$location","$filter","$modalInstance","dialogs","apiUser","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o,s,a,l,u){return e.user=u.user,e.username=u.user.username,e.admin=l.get().isAdmin(),s.all(function(t){return e.users=t.users}),s.roles(function(t){return e.roles=t.roles}),e.close=function(){return r.dismiss("canceled")},e.edit=function(){var t,n;return n=o.wait("Please Wait","Saving user ..."),r.close(n),t=i("projectname")(e.user.username),s.update({username:e.username,new_username:t,email:e.user.email,roles:e.user.roles},function(e){return n.close(),a.send("success","Success!","User "+e.user.name+" was successfully saved.")})},e.validateUsername=function(t){return!_.contains(_.pluck(e.users,"username"),i("projectname")(t))},e.validateRolesRequired=function(e){return!_.isEmpty(e)},e.validateRolesAdmin=function(t){var n;return _.contains(t,"admin")?!0:(n=_.where(e.users,{roles:["admin"]}),n.length>1?!0:_.isEmpty(_.where(n,{username:e.username}))?!0:void 0)}}]),angular.module("narra.ui").controller("VersionCtrl",["$scope","apiSystem","serviceVersion",function(e,t,n){return n.version(function(t){return e.uiVersion=t.version}),t.version(function(t){return e.coreVersion=t.version})}]),angular.module("narra.ui").controller("ViewerCtrl",["$scope","$routeParams","$window","$rootScope","$q","apiProject","elzoidoPromises","angularLoad",function(e,t,n,i,r,o,s,a){return n.narra={width:n.innerWidth-5,height:n.innerHeight-5,getProject:function(){return e.project},getJunctions:function(t){return e.junctions[t]},getItems:function(){return e.items},getItem:function(t){return _.find(e.items,{id:t})}},e.refresh=function(){var l,u,c;
return c=r.defer(),u=r.defer(),l=r.defer(),e.junctions={},o.get({name:t.project},function(t){return _.forEach(t.project.visualizations,function(e){return e.thumbnail="/images/bars.png"}),_.forEach(t.project.libraries,function(e){var t;for(_.isUndefined(e.thumbnails)&&(e.thumbnails=[]),t=[];e.thumbnails.length<5;)t.push(e.thumbnails.push("/images/bars.png"));return t}),t.project.metadata=_.filter(t.project.metadata,function(e){return!_.isEqual(e.name,"public")}),e.project=t.project,e.visualization=t.project.visualizations[0],i.project=t.project,c.resolve(!0)}),c.promise.then(function(){return _.forEach(e.project.synthesizers,function(n,i){return o.junctions({name:t.project,param:n.identifier},function(t){return e.junctions[n.identifier]=t.junctions,i+1===e.project.synthesizers.length?u.resolve(!0):void 0})})}),u.promise.then(function(){return o.items({name:t.project},function(t){return e.items=t.items,l.resolve(!0)})}),l.promise.then(function(){return e.ready=!0,"p5.js"===e.visualization.type?a.loadScript(e.visualization.script).then(function(){return e.sketch=n.visualization}):void 0}),s.register("viewer",[c.promise,u.promise,l.promise]),s.wait("viewer","Loading viewer ...")},e.refresh()}]),angular.module("narra.ui").controller("VisualizationsCtrl",["$scope","$rootScope","$location","$interval","$filter","$q","dialogs","apiProject","apiVisualization","apiUser","elzoidoPromises","elzoidoAuthUser",function(e,t,n,i,r,o,s,a,l,u,c,h){return e.refresh=function(){var t;return e.user=h.get(),t=o.defer(),l.all(function(n){return _.forEach(n.visualizations,function(e){return e.thumbnail="/images/bars.png"}),e.myVisualizations=_.filter(n.visualizations,function(t){return _.isEqual(t.author.username,e.user.username)}),e.publicVisualizations=_.filter(n.visualizations,function(t){return t["public"]&&!_.contains(_.pluck(e.myVisualizations,"id"),t.id)}),t.resolve(!0)}),c.register("visualizations",[t.promise]),c.wait("visualizations","Loading visualizations ...")},e.detail=function(e){return n.path("/visualizations/"+e.id)},t.$on("event:elzoido-auth-user",function(){return e.refresh()}),t.$on("event:narra-visualization-created",function(){return e.refresh()}),e.refresh()}]),angular.module("narra.ui").controller("VisualizationsAddCtrl",["$scope","$modalInstance","$timeout","dialogs","apiVisualization","apiUser","elzoidoMessages","elzoidoAuthUser","FileUploader",function(e,t,n,i,r,o,s,a,l){return e.user=a.get(),e.visualization={name:"",author:e.user,description:"",file:""},e.uploader=new l,e.uploader.onAfterAddingFile=function(t){var n;return n=t._file.name.split(".")[1],_.isEqual(n,"pde")?e.visualization.type="processing":_.isEqual(n,"js")&&(e.visualization.type="p5.js"),e.visualization.file=t._file,e.visualization.name=t._file.name.split(".")[0],e.second=!0},o.all(function(t){return e.users=t.users}),r.all(function(t){return e.visualizations=t.visualizations}),e.close=function(){return t.dismiss("canceled")},e.back=function(){return e.second=!1},e["new"]=function(){var o,a;return o=new FormData,o.append("name",e.visualization.name),o.append("type",e.visualization.type),o.append("author",e.visualization.author.username),o.append("description",e.visualization.description),o.append("file",e.visualization.file),a=i.wait("Please Wait","Registering new visualization ..."),t.close(a),r["new"]({},o,function(){return n(function(){return a.close(e.visualization.name),s.send("success","Success!","Visualization "+e.visualization.name+" was successfully created.")},1e3)})},e.validateName=function(t){return!_.contains(_.pluck(e.visualizations,"name"),t)}}]),angular.module("narra.ui").controller("VisualizationsDetailCtrl",["$scope","$sce","$timeout","$rootScope","$http","$routeParams","$location","$document","$interval","$filter","$q","dialogs","apiVisualization","apiUser","elzoidoPromises","elzoidoAuthUser","elzoidoMessages",function(e,t,n,i,r,o,s,a,l,u,c,h,d,p,f,g,m){return e.editorOption={theme:"xcode",require:["ace/ext/language_tools","ace/ext/static_highlight","ace/ext/error_marker","ace/ext/searchbox"],advanced:{enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0},onLoad:function(t){var n;return n=t.getSession(),_.isEqual(e.visualization.type,"processing")?n.setMode("ace/mode/java"):n.setMode("ace/mode/javascript"),n.on("change",function(){return e.newContent=n.getValue()})}},e.refresh=function(){var t;return e.user=g.get(),t=c.defer(),d.get({id:o.visualization},function(n){return e.visualization=n.visualization,r.get(e.visualization.script).success(function(n){return e.content=n,e.ready=!0,t.resolve(!0)})}),f.register("visualization",[t.promise]),f.wait("visualization","Loading visualization ...")},e.edit=function(){var t;return t=h.create("partials/visualizationsInformationEdit.html","VisualizationsInformationEditCtrl",{visualization:e.visualization},{size:"lg",keyboard:!1}),t.result.then(function(e){return e.result.then(function(){return i.$broadcast("event:narra-visualization-updated",o.visualization)})})},e["delete"]=function(){var t;return t=h.confirm("Please Confirm","You are about to delete the visualization "+e.visualization.name+", this procedure is irreversible. Do you want to continue ?"),t.result.then(function(){return d["delete"]({id:e.visualization.id},function(){return m.send("success","Success!","Visualization "+e.visualization.name+" was successfully deleted."),s.url("/visualizations")})})},e.save=function(){var t,i,r,o;return t=new FormData,r=_.isEqual(e.visualization.type,"processing")?e.visualization.type+".pde":e.visualization.type+".js",i=new File([e.newContent],r),t.append("file",i),o=h.wait("Please Wait","Saving visualization ..."),d.update({id:e.visualization.id},t,function(){return n(function(){return e.refresh(),o.close(e.visualization.name),m.send("success","Success!","Visualization "+e.visualization.name+" was successfully updated.")},1e3)})},e.$on("event:narra-visualization-updated",function(t,n){return!_.isUndefined(o.visualization)&&_.isEqual(o.visualization,n)?e.refresh():void 0}),e.refresh()}]),angular.module("narra.ui").controller("VisualizationsInformationEditCtrl",["$scope","$filter","$modalInstance","$timeout","dialogs","apiVisualization","apiUser","apiGenerator","elzoidoMessages","elzoidoAuthUser","FileUploader","data",function(e,t,n,i,r,o,s,a,l,u,c,h){return e.user=u.get(),e.visualization=h.visualization,e.initial=angular.copy(h.visualization),e.uploader=new c,o.all(function(t){return e.visualizations=t.visualizations}),s.all(function(t){return e.users=t.users,e.filter()}),e.uploader.onAfterAddingFile=function(t){var n;return n=t._file.name.split(".")[1],_.isEqual(n,"pde")?(console.log(e.visualization.file),e.visualization.file=t._file,console.log(e.visualization.file)):void 0},e.filter=function(){return e.contributors=_.filter(e.users,function(t){return!_.isEqual(e.visualization.author.username,t.username)})},e.close=function(){return n.dismiss("canceled")},e.edit=function(){var t;return h=new FormData,h.append("name",e.visualization.name),h.append("author",e.visualization.author.username),h.append("description",e.visualization.description),h.append("public",e.visualization["public"]),e.visualization.file&&h.append("file",e.visualization.file),t=r.wait("Please Wait","Saving visualization ..."),n.close(t),o.update({id:e.visualization.id},h,function(){return i(function(){return t.close(e.visualization.name),l.send("success","Success!","Visualization "+e.visualization.name+" was successfully updated.")},1e3)})},e.validateName=function(t){return!_.contains(_.pluck(e.visualizations,"name"),t)}}]),angular.module("narra.ui").directive("narraAdd",function(){return{restrict:"A",transclude:!0,scope:{},controller:"AddCtrl",templateUrl:"partials/add.html",replace:!1}}),angular.module("narra.ui").directive("narraEvents",function(){return{restrict:"A",transclude:!0,scope:{},controller:"EventsCtrl",templateUrl:"partials/events.html",replace:!1}}),angular.module("narra.ui").directive("filtervalue",["$filter",function(e){return{require:"?ngModel",link:function(t,n,i,r){return _.isUndefined(i.filtervalue)?void 0:r.$parsers.unshift(function(t){var r;return r=e(i.filtervalue)(t),n.val(r),r})}}}]),angular.module("narra.ui").directive("holder",function(){return{link:function(e,t){return Holder.run({images:t.get(0),nocss:!0})}}}),angular.module("narra.ui").directive("narraMetadata",function(){return{restrict:"A",transclude:!0,scope:{api:"=narraMetadataApi",data:"=narraMetadataData",player:"=narraMetadataPlayer",search:"=narraMetadataSearch",type:"@narraMetadataType"},controller:"MetadataCtrl",templateUrl:"partials/metadata/metadata.html",replace:!1}}),angular.module("narra.ui").directive("onRenderFinished",["$timeout",function(e){return{restrict:"A",link:function(t){return t.$last===!0?e(function(){return t.$emit("event:narra-render-finished")}):void 0}}}]),angular.module("narra.ui").directive("p5",["p5Factory",function(e){return{scope:!0,link:function(t,n){var i;return i=e(),t.$watch("sketch",function(e){return i.init(e,n[0])}),t.$on("$destroy",function(){return i.destroy()})}}}]),angular.module("narra.ui").directive("processing",function(){return{scope:!0,link:function(e,t,n){return e.$sketch=Processing.loadSketchFromSources(t[0],[n.processing])}}}),angular.module("narra.ui").directive("uiSelectRequired",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,i){return i.$isEmpty=function(e){return!e.length}}}}),angular.module("narra.ui").directive("narraVersion",function(){return{restrict:"A",transclude:!0,scope:{},controller:"VersionCtrl",templateUrl:"partials/version.html",replace:!1}}),angular.module("narra.ui").filter("capitalize",function(){return function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}}),angular.module("narra.ui").filter("generator",function(){return function(e){return angular.uppercase(e).replace("_"," ")}}),angular.module("narra.ui").filter("guest",function(){return function(e){return _.isUndefined(e)?"Guest":e.name}}),angular.module("narra.ui").filter("metadata",function(){return function(e){var t;return t=e.split("_"),_.forEach(t,function(e,n){return t[n]=e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}),t.join(" ")}}),angular.module("narra.ui").filter("projectname",function(){return function(e){return _.isUndefined(e)&&(e=""),angular.lowercase(e).replace(/\W+/g,"_").replace(/_{2,}/g,"_")}}),angular.module("narra.ui").filter("trimunderscore",function(){return function(e){return _.isUndefined(e)&&(e=""),String(e).replace(/(^_+|_+$)/g,"")}}),angular.module("narra.ui").filter("unescape",function(){return function(e){return _.unescape(e)}}),angular.module("narra.ui").config(["uiGmapGoogleMapApiProvider",function(e){return e.configure({libraries:"places"})}]),angular.module("narra.ui").run(["$rootScope","$window","dialogs","serviceServer",function(e){return e.$on("$routeChangeStart",function(t,n){return e.viewer="partials/viewer.html"===n.templateUrl?!0:!1})}]),angular.module("narra.ui").constant("constantMetadata",{providers:[{id:"user_shot_type",name:"Shot Type",templateAdd:"partials/metadata/metadataShotTypeAdd.html",templateEdit:"partials/metadata/metadataShotTypeEdit.html",controller:"MetadataShotTypeCtrl"},{id:"user_custom",name:"Custom",templateAdd:"partials/metadata/metadataCustomAdd.html",templateEdit:"partials/metadata/metadataCustomEdit.html",controller:"MetadataCustomCtrl"},{id:"user_location",name:"Location",templateAdd:"partials/metadata/metadataLocationAdd.html",templateEdit:"partials/metadata/metadataLocationEdit.html",controller:"MetadataLocationCtrl"}]}),angular.module("narra.ui").config(["elzoidoPromisesModule",function(e){return e.config.timeout=1e3}]),angular.module("narra.ui").factory("p5Factory",["$injector",function(e){var t;return t={init:function(t,n){return this.destroy(),t?(e.has(t)&&(t=e.get(t)),this.instance=new p5(t,n)):void 0},destroy:function(){return this.instance?(this.instance.remove(),this.instance=null):void 0}},function(){return Object.create(t)}}]),angular.module("narra.ui").factory("serviceServer",function(){return{url:"http://api.narra.eu"}}),angular.module("narra.ui").factory("serviceToken",["$location","$cookieStore",function(e,t){var n;return n=t.get("_narra_ui_token"),_.isUndefined(e.search().token)||(n=e.search().token,t.put("_narra_ui_token",n)),{get:function(){return n},clean:function(){return n=null}}}]),angular.module("narra.ui").factory("serviceVersion",["$resource",function(e){return e("/package.json",{},{version:{method:"GET"}})}]);