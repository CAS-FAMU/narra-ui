angular.module("narra.ui",["ngRoute","ngResource","ngSanitize","ngCookies","ngAnimate","ui.bootstrap","ui.event","ui.validate","ui.scrollpoint","ui.select","ui.ace","ui.map","ui.tree","dialogs.main","dialogs.default-translations","elzoido.auth","elzoido.navigation","elzoido.messages","elzoido.promises","wu.masonry","duScroll","com.2fdevs.videogular","com.2fdevs.videogular.plugins.controls","com.2fdevs.videogular.plugins.overlayplay","com.2fdevs.videogular.plugins.poster","com.2fdevs.videogular.plugins.buffering","uiGmapgoogle-maps","angularFileUpload","angularLoad","angular-loading-bar"]),angular.module("narra.ui").config(["$routeProvider","$locationProvider",function(e,t){return t.html5Mode(!0),e.when("/",{templateUrl:"partials/dashboard.html",controller:"DashboardCtrl"}).when("/viewer/:project",{templateUrl:"partials/viewer.html",controller:"ViewerCtrl"}).when("/projects",{templateUrl:"partials/projects.html",controller:"ProjectsCtrl"}).when("/projects/:project",{templateUrl:"partials/projectsDetail.html",controller:"ProjectsDetailCtrl"}).when("/sequences/:sequence",{templateUrl:"partials/sequencesDetail.html",controller:"SequencesDetailCtrl"}).when("/visualizations",{templateUrl:"partials/visualizations.html",controller:"VisualizationsCtrl"}).when("/visualizations/:visualization",{templateUrl:"partials/visualizationsDetail.html",controller:"VisualizationsDetailCtrl"}).when("/libraries",{templateUrl:"partials/libraries.html",controller:"LibrariesCtrl"}).when("/libraries/:library",{templateUrl:"partials/librariesDetail.html",controller:"LibrariesDetailCtrl"}).when("/items/:item",{templateUrl:"partials/itemsDetail.html",controller:"ItemsDetailCtrl"}).when("/users",{templateUrl:"partials/users.html",controller:"UsersCtrl"}).when("/system/info",{templateUrl:"partials/info.html",controller:"InfoCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("narra.ui").config(["$httpProvider","elzoidoAuthModule",function(e,t){return e.interceptors.push("elzoidoAuthInterceptor"),t.config.userProvider="apiUser",t.config.providersProvider="apiAuth"}]).run(["$rootScope","$q","$window","$cookies","dialogs","elzoidoAuthModule","elzoidoAuthUser","elzoidoAuthAPI","elzoidoPromises","serviceToken","serviceServer","apiUser",function(e,t,n,i,r,o,a,s,l,u,c,h){var d;return o.config.functionProfile=function(){var t;return t=r.create("partials/usersEdit.html","UsersEditCtrl",{user:a.get()},{size:"lg",keyboard:!1}),t.result.then(function(t){return t.result.then(function(){return e.$broadcast("event:narra-user-updated"),s.signin()})})},o.config.functionSignin=function(e){var i;return i=t.defer(),u.get()||(r.wait("Please wait","You are being authenticated right now ..."),n.location.href=c.url+"/auth/"+e),i.resolve(!0),i.promise},o.config.functionSignout=function(){var e;return e=t.defer(),h.signout(function(){return i.remove("_narra_ui_token"),n.location.href="/",e.resolve(!0)}),e.promise},d=t.defer(),e.$on("event:elzoido-auth-user",function(){return d.resolve(!0)}),u.get()&&s.signin(),l.register("authentication",d.promise)}]),angular.module("narra.ui").config(["elzoidoNavigationModule",function(e){return e.config.navigationTree=[{name:"projects",title:"Projects",url:"/projects",access:"admin,author",items:[]},{name:"libraries",title:"Libraries",url:"/libraries",access:"admin,author",items:[]},{name:"visualizations",title:"Visualizations",url:"/visualizations",access:"admin,author",items:[]},{name:"system",title:"System",access:"admin",url:"#",items:[{name:"information",title:"Information",url:"/system/info"},{name:"users",title:"Users",url:"/users"}]}]}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/add.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<button class="btn btn-danger btn-xs navbar-btn dropdown-toggle" type="button" data-toggle="dropdown"\n        aria-expanded="false">\n    <span class="fa fa-plus"></span> Add New <span class="caret"></span>\n</button>\n<ul class="dropdown-menu" role="menu">\n    <li><a href="#" ng-click="addItem()">Add Item</a></li>\n    <li class="divider"></li>\n    <li><a href="#" ng-click="addLibrary()">Add Library</a></li>\n    <li><a href="#" ng-click="addProject()">Add Project</a></li>\n    <li><a href="#" ng-click="addSequence()">Add Sequence</a></li>\n    <li><a href="#" ng-click="addVisualization()">Add Visualization</a></li>\n</ul>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/dashboard.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container" style="margin-top: 60px;">\n    <div class="row">\n        <div class="col-md-12">\n\n            <div ng-hide="projects.length" class="col-md-12 dashboard-item-empty"><img src="/images/logo_header.png"></div>\n\n            <div ng-repeat="project in projects" class="col-md-12 dashboard-item pointer-hand" style="width: 100%; height: 150px;"\n                 ng-mouseover="hover$index=true" ng-mouseleave="hover$index=false" ng-click="view(project)">\n                <div ng-repeat="thumbnail in project.thumbnails track by $index"\n                     ng-class="{\'dashboard-item-image\': hover$index}"\n                     class="background-cover"\n                     style="background-image: url(\'{{thumbnail}}\'); width: 20%; height: 150px; float: left"></div>\n                <div class="dashboard-item-title" ng-class="{\'dashboard-item-title-anim\': hover$index}">\n                    <h1>{{project.title}}</h1>\n\n                    <p>by {{project.author.name}}</p>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/events.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div ng-show="events.length">\n    <ul class="nav navbar-nav nav-pills dropdown-toggle" data-toggle="dropdown"\n        role="tablist">\n        <li role="presentation"><a href="#">Queue <span class="badge">{{events.length}}</span></a></li>\n    </ul>\n    <ul class="dropdown-menu queue" role="menu" style="width: 300px;">\n        <li ng-repeat="event in events" ng-if="event.status == \'running\'">\n            <p ng-if="event.item">{{event.item.type | capitalize}} {{event.item.name}} is being processed</p>\n            <p ng-if="event.library">Library {{event.library.name}} is being purged</p>\n            <p ng-if="event.project">Project {{event.project.name}} is being synthesized</p>\n\n            <div ng-if="(event.item || event.project) && event.progress > 0" class="progress">\n                <div class="progress-bar progress-bar-striped progress-bar-danger active" role="progressbar"\n                     aria-valuenow="{{event.progress}}" aria-valuemin="0" aria-valuemax="100"\n                     ng-style="{width: event.progress + \'%\'}">\n                    <span>{{event.message}}</span>\n                </div>\n            </div>\n\n            <div ng-if="event.library" class="progress">\n                <div class="progress-bar progress-bar-striped progress-bar-danger active" role="progressbar"\n                     aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"\n                     style="width: 100%">\n                    <span>Please wait ...</span>\n                </div>\n            </div>\n        </li>\n        <li>\n            <h1>\n                <ng-pluralize count="events.length"\n                              when="{\'one\': \'There is 1 job in queue.\', \'other\': \'There are {} jobs in queue.\'}">\n                </ng-pluralize>\n            </h1>\n        </li>\n    </ul>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/generators/lemmatizer.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="text-center">{{generator.description}}</div>\n\n<div style="margin-top: 20px;" ng-repeat="(key, value) in generator.options">\n    <div class="form-group">\n        <label class="col-sm-6 control-label">{{key|propertyname}}</label>\n\n        <div class="col-sm-6">\n            <input name="name" ng-model="generator.options[key]" class="form-control" ng-trim="false"\n                   type="text"/>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/info.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-12" role="main">\n            <div class="bs-docs-section" id="version">\n                <h5 class="page-header">System Version</h5>\n\n                <div class="well">\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">narra-api</dt>\n                        <dd>{{coreVersion}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">narra-ui</dt>\n                        <dd>{{uiVersion}}</dd>\n                    </dl>\n                </div>\n            </div>\n\n            <div class="bs-docs-section" id="modules">\n                <h5 class="page-header">Modules</h5>\n\n                <div ng-repeat="module in coreModules" class="well">\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">{{module.name}}</dt>\n                        <dd></dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>version</dt>\n                        <dd>{{module.version}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>summary</dt>\n                        <dd>{{module.summary}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>description</dt>\n                        <dd>{{module.description}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>homepage</dt>\n                        <dd><a href="{{module.homepage}}" target="_blank">{{module.homepage}}</a></dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>contact</dt>\n                        <dd><a ng-repeat="email in module.email" href="mailto: {{email}}" target="_blank">{{email}}<span\n                                ng-hide="$last">, </span></a></dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>authors</dt>\n                        <dd><span ng-repeat="author in module.authors">{{author}}<span ng-hide="$last">, </span></span>\n                        </dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>license</dt>\n                        <dd>{{module.license}}</dd>\n                    </dl>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/itemsAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new items</h4></div>\n<div class="modal-body">\n    <form name="newItem" class="form-horizontal">\n        <div ng-if="!second && !third">\n            <textarea name="url" ng-model="item.url" class="form-control" placeholder="Drop a list of URLs here"\n                      rows="10" required></textarea>\n        </div>\n\n        <div ng-if="second">\n            <div style="max-height: 400px; overflow-y: scroll; margin-bottom: 20px;">\n                <div ng-repeat="item in items">\n                    <div class="well well-sm">\n                        <div class="pull-left">\n                            <img src="{{item.thumbnail}}" style="height: 70px;">\n                        </div>\n                        <div style="margin-left: 120px;">\n                            <h4>{{item.name}}</h4>\n\n                            <p><span class="label label-danger">{{item.type}}</span> <span\n                                    class="label label-danger">{{item.connector}}</span></p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div ng-if="third">\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Author</label>\n\n                <div class="col-sm-10" ng-show="!author">\n                    <ui-select ng-model="item.author" required>\n                        <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                        <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n\n                <div class="col-sm-10" style="margin-top: 7px;" ng-show="author">\n                    <span class="text-muted">Author is provided by all items.</span>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Library</label>\n\n                <div class="col-sm-10">\n                    <ui-select ng-model="item.library" required>\n                        <ui-select-match placeholder="Pick a library">{{$select.selected.name}}</ui-select-match>\n                        <ui-select-choices repeat="library in libraries | filter:$select.search">{{library.name}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <span ng-if="second || third" class="btn btn-default" ng-click="back()">Back</span>\n    <span ng-if="!third" class="btn btn-danger" ng-click="next()" ng-disabled="!newItem.$valid">Next</span>\n    <button ng-if="third" class="btn btn-danger" ng-disabled="!newItem.$valid"\n            ng-click="new()">Add Items\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/itemsDetail.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-12" role="main">\n            <h5 class="page-header">\n                <span ng-show="project"><a href="/projects/{{project.name}}?tab=libraries">{{project.title}}</a> / </span>\n                <span ng-show="library"><a href="/libraries/{{library.id}}?tab=items&project={{project.name}}">{{library.name}}</a> / </span>\n                {{item.name}}</h5>\n\n            <div ui-scrollpoint="+30">\n                <div class="pull-right" ng-if="isAuthor() || isContributor()">\n                    <div class="btn-group" uib-dropdown>\n                        <button id="metadata" class="btn btn-danger" type="button" uib-dropdown-toggle>\n                            <span class="fa fa-plus"></span> Add Metadata <span class="caret"></span>\n                        </button>\n                        <ul class="uib-dropdown-menu" role="menu" aria-labelledby="metadata">\n                            <li ng-repeat="provider in metadataProviders | orderBy:\'name\'">\n                                <a href="#" ng-click="itemMetadata.add(provider)">{{provider.name}}</a>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class="btn-group" ng-show="generators.length" uib-dropdown>\n                        <button id="regenerate" class="btn btn-danger" type="button" uib-dropdown-toggle>\n                            <span class="fa fa-repeat"></span> Regenerate <span class="caret"></span>\n                        </button>\n                        <ul class="uib-dropdown-menu" role="menu" aria-labelledby="regenerate">\n                            <li ng-repeat="generator in generators">\n                                <a href="#"\n                                   ng-click="itemMetadata.regenerate(generator.identifier)">{{generator.title}}</a>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class="btn-group" uib-dropdown>\n                        <button id="actions" type="button" class="btn btn-danger" uib-dropdown-toggle>\n                            <span class="fa fa-cog"></span> <span class="caret"></span>\n                        </button>\n                        <ul class="uib-dropdown-menu" role="menu" aria-labelledby="actions">\n                            <li role="menuitem"><a href="#" ng-click="delete()">Delete</a></li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div ng-if="player.ready"\n                     ng-class="{\'videogular-container\': tabs.player.active, \'videogular-container-floating\': !tabs.player.active}">\n                    <videogular vg-player-ready="onPlayerReady($API)" vg-responsive="true"\n                                vg-cue-points="player.cuePoints">\n                        <vg-media vg-src="player.sources"\n                                  vg-tracks="player.tracks" vg-preload="player.preload">\n                        </vg-media>\n\n                        <vg-controls vg-autohide="true" vg-autohide-time="1000">\n                            <vg-scrub-bar>\n                                <vg-scrub-bar-current-time></vg-scrub-bar-current-time>\n                                <vg-scrub-bar-cue-points class="metadata" vg-cue-points="player.cuePoints.metadata"></vg-scrub-bar-cue-points>\n                            </vg-scrub-bar>\n                            <vg-time-display>{{ currentTime | date:\'mm:ss\' }}</vg-time-display>\n                            <vg-volume>\n                                <vg-mute-button></vg-mute-button>\n                                <vg-volume-bar></vg-volume-bar>\n                            </vg-volume>\n                            <vg-fullscreen-button></vg-fullscreen-button>\n                        </vg-controls>\n\n                        <vg-overlay-play></vg-overlay-play>\n                        <vg-buffering></vg-buffering>\n\n                        <div ng-show="live" class="my-logo-layer">\n                            <div class="alert alert-danger" role="alert"><strong>{{live.name}}</strong></br>\n                                {{live.value}}\n                            </div>\n                        </div>\n                    </videogular>\n                </div>\n            </div>\n\n            <uib-tabset type="pills">\n                <uib-tab heading="Metadata" active="tabs.metadata.active">\n                    <div narra-metadata-api="itemMetadata" narra-metadata-type="item" narra-metadata-data="item"\n                         narra-metadata-player="player.api" narra-metadata-search="search" narra-metadata-ui="true"\n                         narra-metadata></div>\n                </uib-tab>\n                <uib-tab ng-if="text" heading="Text" active="tabs.text.active">\n                    <div ui-ace="editorOption" ng-model="text"></div>\n                </uib-tab>\n                <uib-tab ng-if="player.ready" heading="Player" active="tabs.player.active">\n                    <div style="height: 500px;"></div>\n                </uib-tab>\n            </uib-tabset>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/layouts/layoutsSequencePlayerOnly.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div ng-if="player.ready" class="videogular-container-player-only">\n    <videogular vg-player-ready="onPlayerReady($API)" vg-responsive="true"\n                vg-cue-points="player.cuePoints" vg-update-time="playlistHandler($currentTime)">\n        <vg-media vg-src="player.sources"\n                  vg-tracks="player.tracks" vg-preload="player.preload">\n        </vg-media>\n\n        <vg-controls vg-autohide="true" vg-autohide-time="1000">\n            <vg-play-pause-button></vg-play-pause-button>\n            <vg-scrub-bar>\n                <vg-scrub-bar-current-time></vg-scrub-bar-current-time>\n            </vg-scrub-bar>\n            <vg-time-display>{{ currentTime | date:\'mm:ss\' }}</vg-time-display>\n            <vg-volume>\n                <vg-mute-button></vg-mute-button>\n                <vg-volume-bar></vg-volume-bar>\n            </vg-volume>\n            <vg-fullscreen-button></vg-fullscreen-button>\n        </vg-controls>\n\n        <vg-overlay-play></vg-overlay-play>\n        <vg-buffering></vg-buffering>\n    </videogular>\n</div>\n')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/layouts/layoutsSequencePlayerWithContext.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div ng-if="player.ready" class="videogular-container-player-only videogular-container-player-only-metadata">\n    <videogular vg-player-ready="onPlayerReady($API)" vg-responsive="true"\n                vg-cue-points="player.cuePoints" vg-update-time="playlistHandler($currentTime)" vg-update-state="playerStateChanged($state)">\n        <vg-media vg-src="player.sources"\n                  vg-tracks="player.tracks" vg-preload="player.preload">\n        </vg-media>\n\n        <vg-controls vg-autohide="true" vg-autohide-time="1000">\n            <vg-play-pause-button></vg-play-pause-button>\n            <vg-scrub-bar>\n                <vg-scrub-bar-current-time></vg-scrub-bar-current-time>\n            </vg-scrub-bar>\n            <vg-time-display>{{ currentTime | date:\'mm:ss\' }}</vg-time-display>\n            <vg-volume>\n                <vg-mute-button></vg-mute-button>\n                <vg-volume-bar></vg-volume-bar>\n            </vg-volume>\n            <vg-fullscreen-button></vg-fullscreen-button>\n        </vg-controls>\n\n        <vg-overlay-play></vg-overlay-play>\n        <vg-buffering></vg-buffering>\n    </videogular>\n</div>\n\n<div style="position:fixed; left: 20px; bottom: 0; width: 100%; height: 33%; overflow: hidden;">\n    <div class="row" style="width: 100%; height: 100%; overflow: auto;">\n        <div ng-repeat="item in context.values[player.current]" class="col-sm-2" style="margin-bottom: 20px;">\n            <span class="context pointer-hand" ng-click="contextPlay(item, $index)">\n                <img ng-show="!contextPlayer[$index]" src="{{item.thumbnail}}" style="width: 100%; height: 56%;">\n                <div ng-if="contextPlayer[$index]">\n                    <videogular ng-if="contextPlayer[$index]" style="height: auto;" vg-auto-play="true">\n                        <vg-media vg-src="contextPlayer[$index]" vg-native-controls="true"></vg-media>\n                    </videogular>\n                    <span class="context-caption">\n                        <div>{{item.name | uppercase}}</div>\n                        <div>{{item.author}}</div>\n                    </span>\n                </div>\n            </span>\n        </div>\n    </div>\n</div>\n')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/layouts/layoutsSequencePlayerWithMetadata.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div ng-if="player.ready" class="videogular-container-player-only videogular-container-player-only-metadata">\n    <videogular vg-player-ready="onPlayerReady($API)" vg-responsive="true"\n                vg-cue-points="player.cuePoints" vg-update-time="playlistHandler($currentTime)">\n        <vg-media vg-src="player.sources"\n                  vg-tracks="player.tracks" vg-preload="player.preload">\n        </vg-media>\n\n        <vg-controls vg-autohide="true" vg-autohide-time="1000">\n            <vg-play-pause-button></vg-play-pause-button>\n            <vg-scrub-bar>\n                <vg-scrub-bar-current-time></vg-scrub-bar-current-time>\n            </vg-scrub-bar>\n            <vg-time-display>{{ currentTime | date:\'mm:ss\' }}</vg-time-display>\n            <vg-volume>\n                <vg-mute-button></vg-mute-button>\n                <vg-volume-bar></vg-volume-bar>\n            </vg-volume>\n            <vg-fullscreen-button></vg-fullscreen-button>\n        </vg-controls>\n\n        <vg-overlay-play></vg-overlay-play>\n        <vg-buffering></vg-buffering>\n    </videogular>\n</div>\n\n<div style="position:fixed; left: 20px; bottom: 0; width: 100%; height: 33%; overflow: hidden;">\n    <div class="row" style="width: 100%; height: 100%; overflow: auto;">\n        <div ng-repeat="field in metadata.fields" class="col-sm-2" style="margin-bottom: 20px;" ng-if="metadata.values[player.current][field]">\n            <span class="context">\n                <div class="metadata-caption"><span>{{field | uppercase}}</span></div>\n                <div ng-switch="field">\n                    <div ng-switch-default>\n                        <div ng-repeat="item in metadata.values[player.current][field].split(\',\')">{{item}}</div>\n                    </div>\n                    <div ng-switch-when="location">\n                        <div id="map_canvas" ui-map="map" class="map-canvas" ui-event="{\'map-tilesloaded\': \'mapTilesLoaded(map, field)\'}"\n                             ui-options="mapOptions" style="height: 200px;">\n                    </div>\n                </div>\n            </span>\n        </div>\n    </div>\n</div>\n')
}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/layouts/layoutsVisualizationOnly.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div ng-if="visualization.type == \'p5js\'">\n    <p5 sketch="sketch"></p5>\n</div>\n\n<div ng-if="visualization.type == \'processing\' && ready">\n    <canvas processing="{{visualization.script}}"></canvas>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/layouts/options/sequence_player_only.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="text-center">{{layout.description}}</div>\n\n<div style="margin-top: 20px;" ng-repeat="(key, value) in layout.options">\n    <div class="form-group">\n        <label class="col-sm-6 control-label">{{key|propertyname}}</label>\n\n        <div class="col-sm-6">\n            <div ng-switch="key">\n                <div ng-switch-when="sequence">\n                    <ui-select ng-model="layout.options[key]">\n                        <ui-select-match placeholder="Pick a sequence">{{$select.selected.name}}</ui-select-match>\n                        <ui-select-choices repeat="sequence.id as sequence in sequences | filter:$select.search">{{sequence.name}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/layouts/options/sequence_player_with_context.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="text-center">{{layout.description}}</div>\n\n<div style="margin-top: 20px;" ng-repeat="(key, value) in layout.options">\n    <div class="form-group">\n        <label class="col-sm-6 control-label">{{key|propertyname}}</label>\n\n        <div class="col-sm-6">\n            <div ng-switch="key">\n                <div ng-switch-when="sequence">\n                    <ui-select ng-model="layout.options[key]">\n                        <ui-select-match placeholder="Pick a sequence">{{$select.selected.name}}</ui-select-match>\n                        <ui-select-choices repeat="sequence.id as sequence in sequences | filter:$select.search">{{sequence.name}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n                <div ng-switch-when="contextual_synthesizers">\n                    <input name="name" ng-model="layout.options[key]" class="form-control" ng-trim="false" type="text"/>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/layouts/options/sequence_player_with_metadata.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="text-center">{{layout.description}}</div>\n\n<div style="margin-top: 20px;" ng-repeat="(key, value) in layout.options">\n    <div class="form-group">\n        <label class="col-sm-6 control-label">{{key|propertyname}}</label>\n\n        <div class="col-sm-6">\n            <div ng-switch="key">\n                <div ng-switch-when="sequence">\n                    <ui-select ng-model="layout.options[key]">\n                        <ui-select-match placeholder="Pick a sequence">{{$select.selected.name}}</ui-select-match>\n                        <ui-select-choices repeat="sequence.id as sequence in sequences | filter:$select.search">{{sequence.name}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n                <div ng-switch-when="metadata_fields">\n                    <input name="name" ng-model="layout.options[key]" class="form-control" ng-trim="false" type="text"/>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/layouts/options/visualization_only.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="text-center">{{layout.description}}</div>\n\n<div style="margin-top: 20px;" ng-repeat="(key, value) in layout.options">\n    <div class="form-group">\n        <label class="col-sm-6 control-label">{{key|propertyname}}</label>\n\n        <div class="col-sm-6">\n            <div ng-switch="key">\n                <div ng-switch-when="visualization">\n                    <ui-select ng-model="layout.options[\'visualization\']">\n                        <ui-select-match placeholder="Pick a visualization">{{$select.selected.name}}</ui-select-match>\n                        <ui-select-choices repeat="visualization.id as visualization in project.visualizations | filter:$select.search">{{visualization.name}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n                <div ng-switch-when="visualization_selector">\n                    <input type="checkbox" ng-model="layout.options[\'visualization_selector\']">\n                    <span class="text-muted" style="margin-left: 10px;">Enable visualization selector</span>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/libraries.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n\n        <div ng-hide="myLibraries.length > 0 || contribLibraries.length > 0 || sharedLibraries.length > 0"\n             class="col-md-12 item-empty">\n            Create a new library clicking the red button.\n        </div>\n\n        <div class="col-md-12" role="main" ng-show="myLibraries.length > 0 || contribLibraries.length > 0 || sharedLibraries.length > 0">\n\n            <h5 class="page-header">LIBRARIES</h5>\n\n            <uib-tabset type="pills">\n                <uib-tab heading="My Libraries" active="tabs.myLibraries.active" ng-show="myLibraries.length > 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item" ng-class="{\'well-hover\': !library.purged, \'pointer-hand\': !library.purged, \'preparing\': library.purged}"\n                                    ng-repeat="library in myLibraries | orderBy:\'name\'">\n                                    <span ng-if="!library.purged">\n                                        <span ng-show="library.shared" class="label label-success narra-badge">shared</span>\n                                        <span ng-hide="library.shared" class="label label-danger narra-badge">private</span>\n                                    </span>\n                                    <div class="input-item-overlay">\n                                        <div ng-if="!library.purged" ng-click="detail(library)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{library.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{library.name|uppercase}}</span>\n                                        </div>\n\n                                        <div ng-if="library.purged" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{library.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{library.name|uppercase}}</span>\n                                            <span style="font-size: 35px; position: absolute; right: 0px; opacity: 0.5;">PURGED</span>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="My Contributions" active="tabs.contribLibraries.active"\n                         ng-show="contribLibraries.length > 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item" ng-class="{\'well-hover\': !library.purged, \'pointer-hand\': !library.purged, \'preparing\': library.purged}"\n                                    ng-repeat="library in contribLibraries | orderBy:\'name\'">\n                                    <span ng-if="!library.purged">\n                                        <span ng-show="library.shared" class="label label-success narra-badge">shared</span>\n                                        <span ng-hide="library.shared" class="label label-danger narra-badge">private</span>\n                                    </span>\n                                    <div class="input-item-overlay">\n                                        <div ng-if="!library.purged" ng-click="detail(library)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{library.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{library.name|uppercase}}</span>\n                                        </div>\n\n                                        <div ng-if="library.purged" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{library.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{library.name|uppercase}}</span>\n                                            <span style="font-size: 35px; position: absolute; right: 0px; opacity: 0.5;">PURGED</span>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="Shared Libraries" active="tabs.sharedLibraries.active"\n                         ng-show="sharedLibraries.length > 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item" ng-class="{\'well-hover\': !library.purged, \'pointer-hand\': !library.purged, \'preparing\': library.purged}"\n                                    ng-repeat="library in sharedLibraries | orderBy:\'name\'">\n                                    <span ng-if="!library.purged">\n                                        <span ng-show="library.shared" class="label label-success narra-badge">shared</span>\n                                        <span ng-hide="library.shared" class="label label-danger narra-badge">private</span>\n                                    </span>\n                                    <div class="input-item-overlay">\n                                        <div ng-if="!library.purged" ng-click="detail(library)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{library.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{library.name|uppercase}}</span>\n                                        </div>\n\n                                        <div ng-if="library.purged" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{library.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{library.name|uppercase}}</span>\n                                            <span style="font-size: 35px; position: absolute; right: 0px; opacity: 0.5;">PURGED</span>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n            </uib-tabset>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/librariesAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add a\n    new library</h4></div>\n<div class="modal-body">\n    <form name="newLibrary" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Name</label>\n\n            <div class="col-sm-10">\n                <input name="name" ng-model="library.name" class="form-control" ng-trim="false"\n                       ui-validate-async="{exists: \'validateName($value)\' }"\n                       type="text" placeholder="Enter a name here" required/>\n            </div>\n        </div>\n\n        <div ng-show="newLibrary.name.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Library already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="newLibrary.name.$dirty && newLibrary.name.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Library name is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Author</label>\n\n            <div class="col-sm-10">\n                <ui-select ng-model="library.author" ng-disabled="!user.isAdmin()" ng-change="filter()" required>\n                    <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Project</label>\n\n            <div class="col-sm-10">\n                <ui-select ng-model="library.project">\n                    <ui-select-match placeholder="Pick a project (Optional)">{{$select.selected.title}}</ui-select-match>\n                    <ui-select-choices repeat="project in projects | filter:$select.search">{{project.title}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Description</label>\n\n            <div class="col-sm-10">\n                <textarea name="description" ng-model="library.description" class="form-control"\n                          placeholder="Enter a description here (Optional)" rows="5"></textarea>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newLibrary.$valid"\n            ng-click="new()">Add Library\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/librariesDetail.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-12" role="main">\n            <h5 class="page-header">\n                <span ng-show="project"><a\n                        href="/projects/{{project.name}}?tab=libraries">{{project.title}}</a> / </span>\n                {{library.name}}\n            </h5>\n\n            <div ng-if="isAuthor() || isContributor()" ui-scrollpoint="+30">\n                <div class="pull-right">\n                    <div class="btn-group" ng-show="isSelected()" uib-dropdown>\n                        <button id="metadata" class="btn btn-danger" type="button" uib-dropdown-toggle>\n                            <span class="fa fa-plus"></span> Add Metadata To Selected <span class="caret"></span>\n                        </button>\n                        <ul class="uib-dropdown-menu pull-right" role="menu" aria-labelledby="metadata">\n                            <li ng-repeat="provider in metadataProviders | orderBy:\'name\'">\n                                <a href="#" ng-click="itemsMetadata.add(provider)">{{provider.name}}</a>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class="btn-group" ng-show="isSelected()">\n                        <button class="btn btn-danger" ng-click="deleteItems()">Delete Selected</button>\n                    </div>\n                    <div class="btn-group" ng-show="tabs.items.active" uib-dropdown>\n                        <button id="select" type="button" class="btn btn-danger" uib-dropdown-toggle>\n                            Select <span class="caret"></span>\n                        </button>\n                        <ul class="uib-dropdown-menu pull-right" role="menu" aria-labelledby="select">\n                            <li role="menuitem"><a href="#" ng-click="select(true)">All</a></li>\n                            <li role="menuitem"><a href="#" ng-click="select()">None</a></li>\n                        </ul>\n                    </div>\n                    <div class="btn-group" ng-show="library.generators.length > 0" uib-dropdown>\n                        <button id="regenerate" class="btn btn-danger" type="button" uib-dropdown-toggle>\n                            <span class="fa fa-repeat"></span> Regenerate <span class="caret"></span>\n                        </button>\n                        <ul class="uib-dropdown-menu pull-right" role="menu" ng-controller="AddCtrl"\n                            aria-labelledby="regenerate">\n                            <li ng-repeat="generator in library.generators">\n                                <a href="#" ng-click="libraryMetadata.regenerate(generator.identifier)">{{generator.title}}</a>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class="btn-group" uib-dropdown>\n                        <button id="settings" type="button" class="btn btn-danger" uib-dropdown-toggle>\n                            <span class="fa fa-cog"></span> <span class="caret"></span>\n                        </button>\n                        <ul class="uib-dropdown-menu pull-right" role="menu" aria-labelledby="settings">\n                            <li role="menuitem"><a href="#" ng-click="libraryMetadata.add()">Add Metadata</a></li>\n                            <li class="divider"></li>\n                            <li role="menuitem" ng-show="isAuthor() || isContributor()"><a href="#" ng-click="edit()">Settings</a>\n                            </li>\n                            <li role="menuitem" ng-show="isAuthor()"><a href="#" ng-click="deleteLibrary()">Delete</a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n\n            <uib-tabset type="pills">\n                <uib-tab heading="Library" active="tabs.library.active">\n                    <div>\n                        <span ng-show="library.shared" class="label label-success narra-badge">shared</span>\n                        <span ng-hide="library.shared" class="label label-danger narra-badge">private</span>\n\n                        <div ng-repeat="thumbnail in library.thumbnails track by $index"\n                             class="background-cover"\n                             style="background-image: url(\'{{thumbnail}}\'); background-size: contain; width: 20%; height: 100px; float: left; margin-bottom: 10px;"></div>\n                        <div class="well">\n                            <dl class="dl-horizontal">\n                                <dt class="block-header">{{library.name}}</dt>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>description</dt>\n                                <dd>{{library.description}}</dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>author</dt>\n                                <dd>{{library.author.name}}</dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>contributors</dt>\n                                <dd><span ng-repeat="contributor in library.contributors">{{contributor.name}}<span\n                                        ng-hide="$last">, </span></span><span ng-show="library.contributors.length == 0"\n                                                                              class="text-muted">There is no contributors in this library.</span>\n                                </dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>generators</dt>\n                                <dd><span ng-repeat="generator in library.generators">{{generator.title}}<span\n                                        ng-hide="$last">, </span></span><span ng-show="library.generators.length == 0"\n                                                                              class="text-muted">There is no generators assigned to this library.</span>\n                                </dd>\n                            </dl>\n                            <dl class="dl-horizontal" ng-hide="project">\n                                <dt>projects</dt>\n                                <dd><span ng-repeat="project in library.projects">{{project.title}}<span\n                                        ng-hide="$last">, </span></span><span ng-show="library.projects.length == 0"\n                                                                              class="text-muted">There is no projects using this library.</span>\n                                </dd>\n                            </dl>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="Items" active="tabs.items.active" disable="items.length == 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item" ng-class="{\'well-hover\': item.prepared, \'pointer-hand\': item.prepared, \'preparing\': !item.prepared}"\n                                    ng-repeat="item in filtered = (items | filter:global.search) | orderBy:\'name\'">\n                                    <div class="input-item-overlay">\n                                        <input ng-if="(isAuthor() || isContributor()) && item.prepared" type="checkbox"\n                                               ng-model="item.selected">\n\n                                        <div ng-if="item.prepared" ng-click="detail(item)" class="small-item-overlay"\n                                             style="margin-left: 30px;">\n                                            <img src="{{thumbnail[item.name]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{item.name|uppercase}}</span>\n                                            <small ng-show="item.keywords && !item.master">{{item.keywords}}</small>\n                                            <span ng-show="item.master" style="font-size: 35px; position: absolute; right: 0px; opacity: 0.25;">MASTER</span>\n                                        </div>\n\n                                        <div ng-if="!item.prepared" class="small-item-overlay"\n                                             style="margin-left: 30px;">\n                                            <img src="{{thumbnail[item.name]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{item.name|uppercase}}</span>\n                                            <span style="font-size: 35px; position: absolute; right: 0px; opacity: 0.5;">PREPARING</span>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="Metadata" active="tabs.metadata.active" disable="library.metadata.length == 0">\n                    <div class="tab-content">\n                        <div narra-metadata-api="libraryMetadata" narra-metadata-type="library"\n                             narra-metadata-data="library" narra-metadata-ui="true"\n                             narra-metadata></div>\n                        <span narra-metadata-api="itemsMetadata" narra-metadata-type="items"\n                              narra-metadata-data="selectedItems"\n                              narra-metadata></span>\n                    </div>\n                </uib-tab>\n\n            </uib-tabset>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/librariesInformationEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-edit"></span> {{initial.name}}</h4></div>\n<div class="modal-body">\n    <form name="editLibrary" class="form-horizontal">\n        <uib-tabset type="pills">\n            <uib-tab heading="Library">\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Name</label>\n\n                    <div class="col-sm-10">\n                        <input name="name" ng-model="library.name" class="form-control" ng-trim="false"\n                               ui-validate="{exists: \'validateName($value)\' }"\n                               type="text" placeholder="Enter a name here" required/>\n                    </div>\n                </div>\n\n                <div ng-show="editLibrary.name.$error.exists" class="col-md-offset-2">\n                    <p class="text-danger left-buffer-10">\n                        <strong>Already exists!</strong>\n                        <small>Library already exists.</small>\n                    </p>\n                </div>\n\n                <div ng-show="editLibrary.name.$dirty && editLibrary.name.$error.required" class="col-md-offset-2">\n                    <p class="text-danger left-buffer-10">\n                        <strong>Required!</strong>\n                        <small>Library name is required.</small>\n                    </p>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Description</label>\n\n                    <div class="col-sm-10">\n                <textarea name="description" ng-model="library.description" class="form-control"\n                          placeholder="Enter a description here" rows="5"></textarea>\n                    </div>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Author</label>\n\n                    <div class="col-sm-10">\n                        <ui-select ng-model="library.author" ng-disabled="!isAuthor()" ng-change="filter()"\n                                   required>\n                            <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                            <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}\n                            </ui-select-choices>\n                        </ui-select>\n                    </div>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Shared</label>\n\n                    <div class="col-sm-10">\n                        <input type="checkbox" ng-model="library.shared" ng-disabled="!isAuthor()"><span class="text-muted"\n                                                                               style="margin-left: 10px;">Turn this library into the shared mode</span>\n                    </div>\n                </div>\n            </uib-tab>\n            <uib-tab heading="Contributors" disable="(contributors.length == 0 && library.contributors == 0) || !isAuthor()">\n                <div class="form-group">\n                    <div class="col-sm-5">\n                        <ui-select ng-model="contributor.selected"\n                                   theme="bootstrap"\n                                   reset-search-input="true"\n                                   on-select="addContribution($select.selected)"\n                                   style="width: 300px;">\n                            <ui-select-match placeholder="Select a contributor...">{{$select.selected.name}}</ui-select-match>\n                            <ui-select-choices repeat="contributor in contributors"\n                                               refresh-delay="0">\n                                <div ng-bind-html="contributor.name | highlight: $select.search"></div>\n                            </ui-select-choices>\n                        </ui-select>\n                    </div>\n\n                    <div class="col-sm-7">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <div ng-show="library.contributors.length == 0" style="text-align: center; color: grey;">Select\n                                a user you would like to be a part of the project.\n                            </div>\n                            <div ng-hide="library.contributors.length == 0">\n                                <ul class="list-group">\n                                    <li class="list-group-item" ng-repeat="contributor in library.contributors">\n                                        {{contributor.name}} <span class="fa fa-times pull-right pointer-hand" ng-click="removeContribution(contributor)"></span>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </uib-tab>\n            <uib-tab heading="Generators" disable="generators.length == 0">\n                <div class="form-group">\n                    <div class="col-sm-5">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <ul class="list-group">\n                                <li class="list-group-item"\n                                    ng-class="{\'plugin-selected\': isSelected(g), \'pointer-hand\': g.active}"\n                                    ng-repeat="g in generators"\n                                    ng-click="select(g)">\n                                    <input type="checkbox" ng-model="g.active" ng-change="activate(g)"> {{g.title}}\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                    <div class="col-sm-7">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <div ng-if="!generator" style="text-align: center; color: grey;">Select generator you\n                                would like to set up.\n                            </div>\n                            <div ng-if="generator"\n                                 ng-include="\'partials/generators/\' + generator.identifier + \'.html\'"></div>\n                        </div>\n                    </div>\n                </div>\n            </uib-tab>\n        </uib-tabset>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!editLibrary.$valid"\n            ng-click="edit()">Save Library\n    </button>\n</div>')
}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadata.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div ng-if="ui">\n    <div ng-switch="type">\n        <div ng-switch-when="item">\n            <div ng-hide="filtered.length == 0" class="well" ng-repeat="generator in meta | orderBy:\'name\'"\n                 id="meta-{{generator.name}}">\n                <table class="table table-condensed">\n                    <thead>\n                        <tr>\n                            <th width="20%">{{generator.name | generator}}</th>\n                            <th width="45%"></th>\n                            <th width="10%"></th>\n                            <th width="10%"></th>\n                            <th width="15%"></th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr ng-repeat="entry in filtered = (generator.data | filter:search | orderBy:\'name\')" ng-mouseenter="hover$index = true" ng-mouseleave="hover$index = false">\n                            <td>{{entry.name | metadata}}</td>\n                            <td>\n                                <span ng-show="isLink(entry.value)">\n                                    <a href="{{entry.value}}" target="_blank">{{entry.value}}</a>\n                                </span>\n                                <span ng-hide="isLink(entry.value)">{{entry.value}}</span>\n\n                                <span ng-show="generator.name != \'source\'">\n                                    <span ng-show="hover$index" class="button pointer-hand" ng-click="edit(entry)">EDIT</span>\n                                    <span ng-show="hover$index" class="button pointer-hand" ng-click="delete(entry)">DELETE</span>\n                                </span>\n                            </td>\n                            <td>\n                                <span ng-repeat="mark in entry.marks" class="fa fa-bookmark bookmark-hover" ng-click="seek(mark.in)"></span>\n                            </td>\n                            <td class="small">{{date(entry.updated_at)}}</td>\n                            <td class="small">{{entry.author.name}}</td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n        <div ng-switch-when="library">\n            <div ng-hide="filtered.length == 0" class="well">\n                <table class="table table-condensed">\n                    <thead>\n                    <tr>\n                        <th width="20%">USER</th>\n                        <th width="45%"></th>\n                        <th width="10%"></th>\n                        <th width="10%"></th>\n                        <th width="15%"></th>\n                    </tr>\n                    </thead>\n                    <tbody>\n                    <tr ng-repeat="entry in filtered = (meta | filter:search | orderBy:\'name\')" ng-mouseenter="hover$index = true" ng-mouseleave="hover$index = false">\n                        <td>{{entry.name | metadata}}</td>\n                        <td>\n                                <span ng-show="isLink(entry.value)">\n                                    <a href="{{entry.value}}" target="_blank">{{entry.value}}</a>\n                                </span>\n                            <span ng-hide="isLink(entry.value)">{{entry.value}}</span>\n\n                                <span ng-show="generator.name != \'source\'">\n                                    <span ng-show="hover$index" class="button pointer-hand" ng-click="edit(entry)">EDIT</span>\n                                    <span ng-show="hover$index" class="button pointer-hand" ng-click="delete(entry)">DELETE</span>\n                                </span>\n                        </td>\n                        <td>\n                            <span ng-repeat="mark in entry.marks" class="fa fa-bookmark bookmark-hover" ng-click="seek(mark.in)"></span>\n                        </td>\n                        <td class="small">{{date(entry.updated_at)}}</td>\n                        <td class="small">{{entry.author.name}}</td>\n                    </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n        <div ng-switch-when="project">\n            <div ng-hide="filtered.length == 0" class="well">\n                <table class="table table-condensed">\n                    <thead>\n                    <tr>\n                        <th width="20%">USER</th>\n                        <th width="45%"></th>\n                        <th width="10%"></th>\n                        <th width="10%"></th>\n                        <th width="15%"></th>\n                    </tr>\n                    </thead>\n                    <tbody>\n                    <tr ng-repeat="entry in filtered = (meta | filter:search | orderBy:\'name\')" ng-mouseenter="hover$index = true" ng-mouseleave="hover$index = false">\n                        <td>{{entry.name | metadata}}</td>\n                        <td>\n                                <span ng-show="isLink(entry.value)">\n                                    <a href="{{entry.value}}" target="_blank">{{entry.value}}</a>\n                                </span>\n                            <span ng-hide="isLink(entry.value)">{{entry.value}}</span>\n\n                                <span ng-show="generator.name != \'source\'">\n                                    <span ng-show="hover$index" class="button pointer-hand" ng-click="edit(entry)">EDIT</span>\n                                    <span ng-show="hover$index" class="button pointer-hand" ng-click="delete(entry)">DELETE</span>\n                                </span>\n                        </td>\n                        <td>\n                            <span ng-repeat="mark in entry.marks" class="fa fa-bookmark bookmark-hover" ng-click="seek(mark.in)"></span>\n                        </td>\n                        <td class="small">{{date(entry.updated_at)}}</td>\n                        <td class="small">{{entry.author.name}}</td>\n                    </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataAuthorAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Author Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Author</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple tagging tagging-label="false" ng-model="meta.value" sortable="true" style="width: 100%;" ui-validate=" \'$value.length\' ">\n                    <ui-select-match placeholder="Select or type author...">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="author in authors | filter:$select.search">\n                      {{author}}\n                    </ui-select-choices>\n                 </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataAuthorEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Author Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Author</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple tagging tagging-label="false" ng-model="meta.value" sortable="true" style="width: 100%;" ui-validate=" \'$value.length\' ">\n                    <ui-select-match placeholder="Select or type author...">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="author in authors | filter:$select.search">\n                      {{author}}\n                    </ui-select-choices>\n                 </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataCustomAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Custom Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Name</label>\n\n            <div class="col-sm-10">\n                <input name="name" ng-model="meta.name" class="form-control" ng-trim="false" ui-validate="{exists: \'validateName($value)\' }"\n                       type="text" placeholder="Enter a name here" required/>\n            </div>\n        </div>\n\n        <div ng-show="newMeta.name.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Metadata with same name already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="newMeta.name.$dirty && newMeta.name.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Name is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Value</label>\n\n            <div class="col-sm-10">\n                <textarea name="value" ng-model="meta.value" class="form-control"\n                          placeholder="Enter a value here" rows="5" required></textarea>\n            </div>\n        </div>\n\n        <div ng-show="newMeta.value.$dirty && newMeta.value.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Value is required.</small>\n            </p>\n        </div>\n\n        <div ng-show="mark" class="form-group">\n            <label class="col-sm-2 control-label">Marks</label>\n\n            <div class="col-sm-10">\n                <div class="checkbox">\n                    <label>\n                        <input type="checkbox" ng-model="mark.use">\n                        Use marks to restrict area\n                    </label>\n                </div>\n\n                <span ng-class="{\'text-muted\': !mark.use}">Mark in <input ng-disabled="!mark.use" type="number" ng-model="mark.in" min="0" max="{{mark.out || mark.max}}" style="width: 50px;"/>\n                Mark out <input ng-disabled="!mark.use" type="number" ng-model="mark.out" min="{{mark.in}}" max="{{mark.max}}" style="width: 50px;"/></span>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataCustomEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Custom Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Name</label>\n\n            <div class="col-sm-10">\n                <input name="name" ng-model="meta.name" class="form-control" ng-trim="false"\n                       type="text" placeholder="Enter a name here" disabled/>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Value</label>\n\n            <div class="col-sm-10">\n                <textarea name="value" ng-model="meta.value" class="form-control"\n                          placeholder="Enter an url here" rows="5" required></textarea>\n            </div>\n        </div>\n\n        <div ng-show="editMeta.value.$dirty && editMeta.value.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Value is required.</small>\n            </p>\n        </div>\n\n        <div ng-show="mark" class="form-group">\n            <label class="col-sm-2 control-label">Marks</label>\n\n            <div class="col-sm-10">\n                <div class="checkbox">\n                    <label>\n                        <input type="checkbox" ng-model="mark.use"/>\n                        Use marks to restrict area\n                    </label>\n                </div>\n\n                <span ng-class="{\'text-muted\': !mark.use}">Mark in <input ng-disabled="!mark.use" type="number" ng-model="mark.in" min="0" max="{{mark.out || mark.max}}" style="width: 50px;"/>\n                Mark out <input ng-disabled="!mark.use" type="number" ng-model="mark.out" min="{{mark.in}}" max="{{mark.max}}" style="width: 50px;"/></span>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataDescriptionAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Description Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Description</label>\n\n            <div class="col-sm-10">\n                <textarea name="value" ng-model="meta.value" class="form-control"\n                          placeholder="Enter a description here" rows="5" required></textarea>\n            </div>\n        </div>\n\n        <div ng-show="newMeta.value.$dirty && newMeta.value.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Value is required.</small>\n            </p>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataDescriptionEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Description Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Description</label>\n\n            <div class="col-sm-10">\n                <textarea name="value" ng-model="meta.value" class="form-control"\n                          placeholder="Enter a description here" rows="5" required></textarea>\n            </div>\n        </div>\n\n        <div ng-show="editMeta.value.$dirty && editMeta.value.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Value is required.</small>\n            </p>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataKeywordsAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Keywords Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Keywords</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple tagging tagging-label="false" ng-model="meta.value" sortable="true" style="width: 100%;" ui-validate=" \'$value.length\' ">\n                    <ui-select-match placeholder="Select or type keyword...">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="keyword in keywords | filter:$select.search">\n                      {{keyword}}\n                    </ui-select-choices>\n                 </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataKeywordsEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Keywords Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Keywords</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple tagging tagging-label="false" ng-model="meta.value" sortable="true" style="width: 100%;" ui-validate=" \'$value.length\' ">\n                    <ui-select-match placeholder="Select or type keyword...">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="keyword in keywords | filter:$select.search">\n                      {{keyword}}\n                    </ui-select-choices>\n                 </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataLanguageAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Language Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Language</label>\n\n            <div class="col-sm-10">\n                <ui-select name="value" ng-model="meta.value" required>\n                    <ui-select-match placeholder="Select language...">{{languages[$select.selected].name}}</ui-select-match>\n                    <ui-select-choices repeat="code in codes | filter:$select.search">\n                        <div ng-bind-html="code | highlight: $select.search"></div>\n                          <small><span ng-bind-html="languages[code].name | highlight: $select.search"></span> (<span ng-bind-html="languages[code].nativeName | highlight: $select.search"></span>)</small>\n                    </ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataLanguageEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Language Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Language</label>\n\n            <div class="col-sm-10">\n                <ui-select name="value" ng-model="meta.value" required>\n                    <ui-select-match placeholder="Select language...">{{languages[$select.selected].name}}</ui-select-match>\n                    <ui-select-choices repeat="code in codes | filter:$select.search">\n                        <div ng-bind-html="code | highlight: $select.search"></div>\n                          <small><span ng-bind-html="languages[code].name | highlight: $select.search"></span> (<span ng-bind-html="languages[code].nativeName | highlight: $select.search"></span>)</small>\n                    </ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataLocationAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Location Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group" ng-if="ready">\n            <div id="map_canvas" ui-map="map" class="map-canvas" ui-event="{\'map-click\': \'setMarkerPosition($event, $params)\', \'map-tilesloaded\': \'mapTilesLoaded(map)\'}"\n                ui-options="mapOptions">\n        </div>\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Location</label>\n\n            <div class="col-sm-9">\n                <input name="location" ng-model="meta.value" class="form-control" ng-trim="false"\n                       type="text" placeholder="Enter a coordinates here" disabled required/>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')
}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataLocationEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Location Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group" ng-if="ready">\n            <div id="map_canvas" ui-map="map" class="map-canvas" ui-event="{\'map-click\': \'setMarkerPosition($event, $params)\', \'map-tilesloaded\': \'mapTilesLoaded(map)\'}"\n                ui-options="mapOptions">\n        </div>\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Location</label>\n\n            <div class="col-sm-9">\n                <input name="location" ng-model="meta.value" class="form-control" ng-trim="false"\n                       type="text" placeholder="Enter a coordinates here" disabled required/>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataOrganizationsAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Organizations Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Organizations</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple tagging ng-model="meta.value" sortable="true" style="width: 100%;" ui-validate=" \'$value.length\' ">\n                    <ui-select-match placeholder="Select or type organization...">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="organization in organizations | filter:$select.search">\n                      {{organization}}\n                    </ui-select-choices>\n                 </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataOrganizationsEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Organizations Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Organizations</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple tagging ng-model="meta.value" sortable="true" style="width: 100%;" ui-validate=" \'$value.length\' ">\n                    <ui-select-match placeholder="Select or type organization...">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="organization in organizations track by $index | filter:$select.search">\n                      {{organization}}\n                    </ui-select-choices>\n                 </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataPeopleAdd.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new People Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">People</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple tagging tagging-label="false" ng-model="meta.value" sortable="true" style="width: 100%;">\n                    <ui-select-match placeholder="Select or type people...">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="person in people | filter:$select.search">\n                      {{person}}\n                    </ui-select-choices>\n                 </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataPeopleEdit.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit People Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">People</label>\n\n            <div class="col-sm-10">\n                <ui-select multiple tagging tagging-label="false" ng-model="meta.value" sortable="true" style="width: 100%;" ui-validate=" \'$value.length\' ">\n                    <ui-select-match placeholder="Select or type people...">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="person in people | filter:$select.search">\n                      {{person}}\n                    </ui-select-choices>\n                 </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataShotTypeAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Shot Type Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Shot Type</label>\n\n            <div class="col-sm-10">\n                <ui-select name="value" multiple ng-model="meta.value" style="width: 100%;" rows="5" ui-validate=" \'$value.length\' ">\n                    <ui-select-match placeholder="Select shot types">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="shot in shots | filter:$select.search">{{shot}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataShotTypeEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Shot Type Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Shot Type</label>\n\n            <div class="col-sm-10">\n                <ui-select name="value" multiple ng-model="meta.value" style="width: 100%;" rows="5" ui-validate=" \'$value.length\' ">\n                    <ui-select-match placeholder="Select shot types">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="shot in shots | filter:$select.search">{{shot}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataSummaryAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new Summary Metadata</h4></div>\n<div class="modal-body">\n    <form name="newMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Summary</label>\n\n            <div class="col-sm-10">\n                <textarea name="value" ng-model="meta.value" class="form-control"\n                          placeholder="Enter a summary here" rows="2" required></textarea>\n            </div>\n        </div>\n\n        <div ng-show="newMeta.value.$dirty && newMeta.value.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Value is required.</small>\n            </p>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newMeta.$valid"\n            ng-click="add()">Add Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/metadata/metadataSummaryEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Edit Summary Metadata</h4></div>\n<div class="modal-body">\n    <form name="editMeta" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Summary</label>\n\n            <div class="col-sm-10">\n                <textarea name="value" ng-model="meta.value" class="form-control"\n                          placeholder="Enter a summary here" rows="2" required></textarea>\n            </div>\n        </div>\n\n        <div ng-show="editMeta.value.$dirty && editMeta.value.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Value is required.</small>\n            </p>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-click="delete()">Delete</button>\n    <button class="btn btn-danger" ng-disabled="!editMeta.$valid"\n            ng-click="edit()">Update Meta\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/projects.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n\n        <div ng-hide="projects.length > 0 || contributions.length > 0" class="col-md-12 item-empty">\n            Create a new project clicking the red button.\n        </div>\n\n        <div class="col-md-12" role="main" ng-show="projects.length > 0 || contributions.length > 0">\n\n            <h5 class="page-header">PROJECTS</h5>\n\n            <uib-tabset type="pills">\n                <uib-tab heading="My Projects" active="tabs.myProjects.active" ng-show="projects.length > 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item pointer-hand well-hover"\n                                    ng-repeat="project in projects | orderBy:\'name\'">\n                                    <span ng-show="project.public" class="label label-success narra-badge">public</span>\n                                    <span ng-hide="project.public" class="label label-danger narra-badge">private</span>\n                                    <div class="input-item-overlay">\n                                        <div ng-click="detail(project)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{project.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{project.title|uppercase}}</span>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="My Contributions" active="tabs.contribProjects.active" ng-show="contributions.length > 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item pointer-hand well-hover"\n                                    ng-repeat="project in contributions | orderBy:\'name\'">\n                                    <span ng-show="project.public" class="label label-success narra-badge">public</span>\n                                    <span ng-hide="project.public" class="label label-danger narra-badge">private</span>\n                                    <div class="input-item-overlay">\n                                        <div ng-click="detail(project)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{project.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{project.title|uppercase}}</span>\n                                            <small>by <strong>{{project.author.name}}</strong></small>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n            </uib-tabset>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/projectsAdd.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add a\n    new project</h4></div>\n<div class="modal-body">\n    <form name="newProject" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Title</label>\n\n            <div class="col-sm-10">\n                <input name="title" ng-model="project.title" class="form-control" ng-trim="false"\n                       ui-validate-async="{exists: \'validateTitle($value)\' }"\n                       type="text" placeholder="Enter a title here" required/>\n            </div>\n        </div>\n\n        <div ng-show="newProject.title.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Project with same title already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="newProject.title.$dirty && newProject.title.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Project title is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Name</label>\n\n            <div class="col-sm-10">\n                <input name="name" ng-model="project.name" class="form-control" ng-trim="false"\n                       ui-validate-async="{exists: \'validateName($value)\' }"\n                       type="text" placeholder="Enter a name here" filtervalue="projectname" required/>\n            </div>\n        </div>\n\n        <div ng-show="newProject.name.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>Project already exists.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Author</label>\n\n            <div class="col-sm-10">\n                <ui-select ng-model="project.author" ng-disabled="!user.isAdmin()" ng-change="filter()" required>\n                    <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                    <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div ng-show="newProject.name.$dirty && newProject.name.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Project name is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Description</label>\n\n            <div class="col-sm-10">\n                <textarea name="description" ng-model="project.description" class="form-control"\n                          placeholder="Enter a description here (Optional)" rows="5"></textarea>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!newProject.$valid"\n            ng-click="new()">Add Project\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/projectsDetail.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-12" role="main">\n\n            <h5 class="page-header">{{project.title}}</h5>\n\n            <div ui-scrollpoint="+30">\n                <div class="pull-right">\n                    <div class="btn-group" uib-dropdown>\n                        <button id="single-button" type="button" class="btn btn-danger" uib-dropdown-toggle>\n                            <span class="fa fa-cog"></span> <span class="caret"></span>\n                        </button>\n                        <ul class="uib-dropdown-menu" role="menu" aria-labelledby="single-button">\n                            <li role="menuitem"><a href="#" ng-click="projectMetadata.add()">Add Metadata</a></li>\n                            <li class="divider"></li>\n                            <li role="menuitem"><a href="#" ng-click="edit()">Settings</a></li>\n                            <li role="menuitem" ng-show="isAuthor()"><a href="#" ng-click="delete()">Delete</a></li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n\n            <uib-tabset type="pills">\n                <uib-tab heading="Project" active="tabs.project.active">\n                    <div>\n                        <span ng-show="project.public" class="label label-success narra-badge">public</span>\n                        <span ng-hide="project.public" class="label label-danger narra-badge">private</span>\n\n                        <div ng-repeat="thumbnail in project.thumbnails track by $index"\n                             class="background-cover"\n                             style="background-image: url(\'{{thumbnail}}\'); background-size: contain; width: 20%; height: 100px; float: left; margin-bottom: 10px;"></div>\n                        <div class="well">\n                            <dl class="dl-horizontal">\n                                <dt>description</dt>\n                                <dd>{{project.description}}</dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>author</dt>\n                                <dd>{{project.author.name}}</dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>contributors</dt>\n                                <dd><span ng-repeat="contributor in project.contributors">{{contributor.name}}<span\n                                        ng-hide="$last">, </span></span><span ng-show="project.contributors.length == 0"\n                                                                              class="text-muted">There is no contributors in this project.</span>\n                                </dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>synthesizers</dt>\n                                <dd><span ng-repeat="synthesizer in project.synthesizers">{{synthesizer.title}}<span\n                                        ng-hide="$last">, </span></span><span ng-show="project.synthesizers.length == 0"\n                                                                              class="text-muted">There is no synthesizers assigned to this project.</span>\n                                </dd>\n                            </dl>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="Libraries" active="tabs.libraries.active" disable="project.libraries.length == 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item" ng-class="{\'well-hover\': !library.purged, \'pointer-hand\': !library.purged, \'preparing\': library.purged}"\n                                    ng-repeat="library in project.libraries | orderBy:\'name\'">\n                                    <span ng-if="!library.purged">\n                                        <span ng-show="library.shared" class="label label-success narra-badge">shared</span>\n                                        <span ng-hide="library.shared" class="label label-danger narra-badge">private</span>\n                                    </span>\n                                    <div class="input-item-overlay">\n                                        <div ng-if="!library.purged" ng-click="detailLibrary(library)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{library.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{library.name|uppercase}}</span>\n                                        </div>\n\n                                        <div ng-if="library.purged" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{library.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{library.name|uppercase}}</span>\n                                            <span style="font-size: 35px; position: absolute; right: 0px; opacity: 0.5;">PURGED</span>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="Sequences" active="tabs.sequences.active" disable="sequences.length == 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item" ng-class="{\'well-hover\': sequence.prepared, \'pointer-hand\': sequence.prepared, \'preparing\': !sequence.prepared}"\n                                    ng-repeat="sequence in sequences | orderBy:\'name\'">\n                                    <span ng-if="sequence.prepared">\n                                        <span ng-show="sequence.public" class="label label-success narra-badge">public</span>\n                                        <span ng-hide="sequence.public" class="label label-danger narra-badge">private</span>\n                                    </span>\n                                    <div class="input-item-overlay">\n                                        <div ng-if="sequence.prepared" ng-click="detailSequence(sequence)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{sequence.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{sequence.name|uppercase}}</span>\n                                        </div>\n\n                                        <div ng-if="!sequence.prepared" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{sequence.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{sequence.name|uppercase}}</span>\n                                            <span style="font-size: 35px; position: absolute; right: 0px; opacity: 0.5;">PREPARING</span>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="Visualizations" active="tabs.visualizations.active" disable="visualizations.length == 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item pointer-hand well-hover"\n                                    ng-repeat="visualization in visualizations | orderBy:\'name\'">\n                                    <div class="input-item-overlay">\n                                        <div ng-click="preview(\'visualization\', visualization)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{visualization.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{visualization.name|uppercase}}</span>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="Junctions" active="tabs.junctions.active" disable="isEmpty(junctions)">\n                    <uib-tabset type="pills">\n                        <uib-tab ng-repeat="synthesizer in project.synthesizers" heading="{{synthesizer.title}}">\n                            <div class="tab-content">\n                                <div class="row">\n                                    <ul class="list-group">\n                                        <li class="list-group-item" style="background-color: rgb({{getColor(junction.weight)}},{{getColor(junction.weight)}},{{getColor(junction.weight)}});"\n                                            ng-repeat="junction in junctions[synthesizer.identifier] | orderBy:\'name\'">\n                                            <div class="input-item-overlay">\n                                                <div class="small-item-overlay"\n                                                     style="margin-left: 10px;">\n                                                    <img ng-repeat="item in junction.items" src="{{item.thumbnail}}" height="50">\n                                                    <span style="margin-left: 20px;"><strong>{{getItem(junction.direction.from, junction.items).name}}</strong> => <strong>{{getItem(junction.direction.to, junction.items).name}}</strong></span><small class="pull-right">weight <strong>{{junction.weight}}</strong></small>\n                                                </div>\n                                            </div>\n                                        </li>\n                                    </ul>\n                                </div>\n                            </div>\n                        </uib-tab>\n                    </uib-tabset>\n                </uib-tab>\n                <uib-tab heading="Layouts" active="tabs.layouts.active" disable="project.layouts.length == 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item pointer-hand well-hover"\n                                    ng-repeat="layout in project.layouts | orderBy:\'name\'">\n                                    <div class="input-item-overlay">\n                                        <div ng-click="preview(\'layout\', layout)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <span style="font-size: 20px;">{{layout.name|uppercase}}</span>\n                                            <span ng-show="layout.main" style="font-size: 20px; position: absolute; right: 0px; opacity: 0.5;">MAIN</span>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="Metadata" active="tabs.metadata.active" disable="project.metadata.length == 0">\n                    <div class="tab-content">\n                        <div narra-metadata-api="projectMetadata" narra-metadata-type="project"\n                             narra-metadata-data="project" narra-metadata-ui="true" narra-metadata></div>\n                    </div>\n                </uib-tab>\n            </uib-tabset>\n        </div>\n    </div>\n</div>')
}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/projectsInformationEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-edit"></span> {{initial.title}}</h4></div>\n<div class="modal-body">\n    <form name="editProject" class="form-horizontal">\n        <uib-tabset type="pills">\n            <uib-tab heading="Project">\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Title</label>\n\n                    <div class="col-sm-10">\n                        <input name="title" ng-model="project.title" class="form-control" ng-trim="false"\n                               ui-validate="{exists: \'validateTitle($value)\' }"\n                               type="text" placeholder="Enter a title here" required/>\n                    </div>\n                </div>\n\n                <div ng-show="editProject.title.$error.exists" class="col-md-offset-2">\n                    <p class="text-danger left-buffer-10">\n                        <strong>Already exists!</strong>\n                        <small>Project with same title already exists.</small>\n                    </p>\n                </div>\n\n                <div ng-show="editProject.title.$dirty && editProject.title.$error.required" class="col-md-offset-2">\n                    <p class="text-danger left-buffer-10">\n                        <strong>Required!</strong>\n                        <small>Project title is required.</small>\n                    </p>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Name</label>\n\n                    <div class="col-sm-10">\n                        <input name="name" ng-model="project.name" class="form-control" ng-trim="false"\n                               ui-validate="{exists: \'validateName($value)\' }"\n                               type="text" placeholder="Enter a name here" filtervalue="projectname" required/>\n                    </div>\n                </div>\n\n                <div ng-show="editProject.name.$error.exists" class="col-md-offset-2">\n                    <p class="text-danger left-buffer-10">\n                        <strong>Already exists!</strong>\n                        <small>Project already exists.</small>\n                    </p>\n                </div>\n\n                <div ng-show="editProject.name.$dirty && editProject.name.$error.required" class="col-md-offset-2">\n                    <p class="text-danger left-buffer-10">\n                        <strong>Required!</strong>\n                        <small>Project name is required.</small>\n                    </p>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Description</label>\n\n                    <div class="col-sm-10">\n                <textarea name="description" ng-model="project.description" class="form-control"\n                          placeholder="Enter a description here" rows="5"></textarea>\n                    </div>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Author</label>\n\n                    <div class="col-sm-10">\n                        <ui-select ng-model="project.author" ng-disabled="!isAuthor()" ng-change="filter()"\n                                   required>\n                            <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                            <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}\n                            </ui-select-choices>\n                        </ui-select>\n                    </div>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Public</label>\n\n                    <div class="col-sm-10">\n                        <input type="checkbox" ng-model="project.public" ng-disabled="!isAuthor()"><span class="text-muted"\n                                                                               style="margin-left: 10px;">Turn this project into the public mode</span>\n                    </div>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Layout</label>\n\n                    <div class="col-sm-10">\n                        <ui-select ng-model="project.layout" ng-disabled="!isAuthor() || !project.public">\n                            <ui-select-match placeholder="Pick a layout">{{$select.selected.name}}</ui-select-match>\n                            <ui-select-choices repeat="layout in project.layouts | filter:$select.search">{{layout.name}}\n                            </ui-select-choices>\n                        </ui-select>\n                    </div>\n                </div>\n            </uib-tab>\n            <uib-tab heading="Contributors" disable="(contributors.length == 0 && project.contributors == 0) || !isAuthor()">\n                <div class="form-group">\n                    <div class="col-sm-5">\n                        <ui-select ng-model="contributor.selected"\n                                   theme="bootstrap"\n                                   reset-search-input="true"\n                                   on-select="addContribution($select.selected)"\n                                   style="width: 300px;">\n                            <ui-select-match placeholder="Select a contributor...">{{$select.selected.name}}</ui-select-match>\n                            <ui-select-choices repeat="contributor in contributors"\n                                               refresh-delay="0">\n                                <div ng-bind-html="contributor.name | highlight: $select.search"></div>\n                            </ui-select-choices>\n                        </ui-select>\n                    </div>\n\n                    <div class="col-sm-7">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <div ng-show="project.contributors.length == 0" style="text-align: center; color: grey;">Select\n                                a user you would like to be a part of the project.\n                            </div>\n                            <div ng-hide="project.contributors.length == 0">\n                                <ul class="list-group">\n                                    <li class="list-group-item" ng-repeat="contributor in project.contributors">\n                                        {{contributor.name}} <span class="fa fa-times pull-right pointer-hand" ng-click="removeContribution(contributor)"></span>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </uib-tab>\n            <uib-tab heading="Libraries" disable="(libraries.length == 0 && project.libraries == 0) || !isAuthor()">\n                <div class="form-group">\n                    <div class="col-sm-5">\n                        <ui-select ng-model="library.selected"\n                                   theme="bootstrap"\n                                   reset-search-input="true"\n                                   on-select="addLibrary($select.selected)"\n                                   style="width: 300px;">\n                            <ui-select-match placeholder="Select a library...">{{$select.selected.name}}</ui-select-match>\n                            <ui-select-choices repeat="library in libraries"\n                                               refresh-delay="0">\n                                <div ng-bind-html="library.name | highlight: $select.search"></div>\n                            </ui-select-choices>\n                        </ui-select>\n                    </div>\n\n                    <div class="col-sm-7">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <div ng-show="project.libraries.length == 0" style="text-align: center; color: grey;">Select\n                                a library you would like to add to the project.\n                            </div>\n                            <div ng-hide="project.libraries.length == 0">\n                                <ul class="list-group">\n                                    <li class="list-group-item" ng-repeat="library in project.libraries">\n                                        {{library.name}} <span class="fa fa-times pull-right pointer-hand" ng-click="removeLibrary(library)"></span>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </uib-tab>\n            <uib-tab heading="Synthesizers" disable="synthesizers.length == 0">\n                <div class="form-group">\n                    <div class="col-sm-5">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <ul class="list-group">\n                                <li class="list-group-item"\n                                    ng-class="{\'plugin-selected\': isSelectedSynthesizer(s), \'pointer-hand\': s.active}"\n                                    ng-repeat="s in synthesizers"\n                                    ng-click="selectSynthesizer(s)">\n                                    <input type="checkbox" ng-model="s.active" ng-change="activateSynthesizer(s)"> {{s.title}}\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                    <div class="col-sm-7">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <div ng-if="!synthesizer" style="text-align: center; color: grey;">Select synthesizer you\n                                would like to set up.\n                            </div>\n                            <div ng-if="synthesizer"\n                                 ng-include="\'partials/synthesizers/\' + synthesizer.identifier + \'.html\'"></div>\n                        </div>\n                    </div>\n                </div>\n            </uib-tab>\n            <uib-tab heading="Visualizations" disable="visualizations.length == 0">\n                <div class="form-group">\n                    <div class="col-sm-5">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <ul class="list-group">\n                                <li class="list-group-item"\n                                    ng-class="{\'plugin-selected\': isSelectedVisualization(v), \'pointer-hand\': s.active}"\n                                    ng-repeat="v in visualizations"\n                                    ng-click="selectVisualization(v)">\n                                    <input type="checkbox" ng-model="v.active" ng-change="activateVisualization(v)"> {{v.name}}\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                    <div class="col-sm-7">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <div ng-if="!visualization" style="text-align: center; color: grey;">Select visualization you\n                                would like to set up.\n                            </div>\n                            <div ng-if="visualization"\n                                 ng-include="\'partials/visualizations/generic.html\'"></div>\n                        </div>\n                    </div>\n                </div>\n            </uib-tab>\n            <uib-tab heading="Layouts" disable="layouts.length == 0">\n                <div class="form-group">\n                    <div class="col-sm-5">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <ul class="list-group">\n                                <li class="list-group-item"\n                                    ng-class="{\'plugin-selected\': isSelectedLayout(l), \'pointer-hand\': s.active}"\n                                    ng-repeat="l in layouts"\n                                    ng-click="selectLayout(l)">\n                                    <input type="checkbox" ng-model="l.active" ng-change="activateLayout(l)"> {{l.name}}\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                    <div class="col-sm-7">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <div ng-if="!layout" style="text-align: center; color: grey;">Select layout you\n                                would like to set up.\n                            </div>\n                            <div ng-if="layout"\n                                 ng-include="\'partials/layouts/options/\' + layout.id + \'.html\'"></div>\n                        </div>\n                    </div>\n                </div>\n            </uib-tab>\n        </uib-tabset>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!editProject.$valid"\n            ng-click="edit()">Save Project\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/search.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="input-group input-group-sm navbar-right" style="width: 200px; margin-top: 10px; margin-right: 10px;">\n    <span class="input-group-addon"><span class="fa fa-search"></span></span>\n    <input type="text" class="form-control" ng-model="global.search" placeholder="Search">\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/sequencesAdd.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new sequence</h4></div>\n<div class="modal-body">\n    <form name="newSequence" class="form-horizontal">\n        <div ng-if="!second">\n            <div class="text-center">\n                Create an empty <span class="btn btn-danger" ng-click="select(\'narra\')">Sequence</span>\n            </div>\n\n            <br/>\n\n            <div nv-file-drop="" uploader="uploader">\n                <div nv-file-over="" uploader="uploader" over-class="drop-zone-over"\n                     class="well drop-zone">\n                    or drop your sequence script here\n                </div>\n            </div>\n        </div>\n\n        <div ng-if="second">\n            <div ng-show="sequence.file" class="form-group">\n                <label class="col-sm-2 control-label">Script</label>\n\n                <div class="col-sm-10">\n                    <input name="file" ng-model="sequence.file.name" class="form-control" type="text" disabled/>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Name</label>\n\n                <div class="col-sm-10">\n                    <input name="name" ng-model="sequence.name" class="form-control" ng-trim="false"\n                           type="text" placeholder="Enter a name here" required/>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Type</label>\n\n                <div class="col-sm-10">\n                    <input name="type" ng-model="sequence.type" class="form-control" type="text" disabled/>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Framerate</label>\n\n                <div class="col-sm-10">\n                    <ui-select ng-model="sequence.fps" required>\n                        <ui-select-match placeholder="Pick an framerate">{{$select.selected}}</ui-select-match>\n                        <ui-select-choices repeat="framerate in framerates | filter:$select.search">\n                            {{framerate}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Project</label>\n\n                <div class="col-sm-10">\n                    <ui-select ng-model="sequence.project" required>\n                        <ui-select-match placeholder="Pick a project">{{$select.selected.title}}</ui-select-match>\n                        <ui-select-choices repeat="project in projects | filter:$select.search">{{project.title}}</ui-select-choices>\n                    </ui-select>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Author</label>\n\n                <div class="col-sm-10">\n                    <ui-select ng-model="sequence.author" required>\n                        <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                        <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Description</label>\n\n                <div class="col-sm-10">\n                <textarea name="description" ng-model="sequence.description" class="form-control"\n                          placeholder="Enter a description here (Optional)" rows="5"></textarea>\n                </div>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <span ng-if="second" class="btn btn-default" ng-click="back()">Back</span>\n    <button ng-if="second" class="btn btn-danger" ng-disabled="!newSequence.$valid"\n            ng-click="new()">Add Sequence\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/sequencesDetail.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-12" role="main">\n            <h5 class="page-header">\n                <span><a href="/projects/{{sequence.project.name}}?tab=sequences">{{sequence.project.title}}</a> / </span>{{sequence.name}}\n            </h5>\n\n            <div ui-scrollpoint="+30">\n                <div class="pull-right" ng-if="isAuthor() || isContributor()">\n                    <div class="btn-group" uib-dropdown>\n                        <button id="settings" type="button" class="btn btn-danger" uib-dropdown-toggle>\n                            <span class="fa fa-cog"></span> <span class="caret"></span>\n                        </button>\n                        <ul class="uib-dropdown-menu pull-right" role="menu" aria-labelledby="settings">\n                            <li role="menuitem"><a href="#" ng-click="edit()">Settings</a></li>\n                            <li role="menuitem" ng-show="isAuthor()"><a href="#" ng-click="delete()">Delete</a></li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div ng-if="player.ready" ng-class="{\'videogular-container\': tabs.player.active, \'videogular-container-floating\': !tabs.player.active, \'videogular-container-none\': tabs.sequence.active}">\n                    <videogular vg-player-ready="onPlayerReady($API)" vg-responsive="true"\n                                vg-cue-points="player.cuePoints" vg-update-time="playlistHandler($currentTime)">\n                        <vg-media vg-src="player.sources"\n                                  vg-tracks="player.tracks" vg-preload="player.preload">\n                        </vg-media>\n\n                        <vg-controls vg-autohide="true" vg-autohide-time="1000">\n                            <vg-play-pause-button></vg-play-pause-button>\n                            <vg-scrub-bar>\n                                <vg-scrub-bar-current-time></vg-scrub-bar-current-time>\n                            </vg-scrub-bar>\n                            <vg-time-display>{{ currentTime | date:\'mm:ss\' }}</vg-time-display>\n                            <vg-volume>\n                                <vg-mute-button></vg-mute-button>\n                                <vg-volume-bar></vg-volume-bar>\n                            </vg-volume>\n                            <vg-fullscreen-button></vg-fullscreen-button>\n                        </vg-controls>\n\n                        <vg-overlay-play></vg-overlay-play>\n                        <vg-buffering></vg-buffering>\n                    </videogular>\n                </div>\n            </div>\n\n            <uib-tabset type="pills">\n                <uib-tab heading="Sequence" active="tabs.sequence.active">\n                    <div>\n                        <span ng-show="sequence.public" class="label label-success narra-badge">public</span>\n                        <span ng-hide="sequence.public" class="label label-danger narra-badge">private</span>\n\n                        <div ng-repeat="thumbnail in sequence.thumbnails track by $index"\n                             class="background-cover"\n                             style="background-image: url(\'{{thumbnail}}\'); background-size: contain; width: 20%; height: 100px; float: left; margin-bottom: 10px;"></div>\n                        <div class="well">\n                            <dl class="dl-horizontal">\n                                <dt class="block-header">{{sequence.name}}</dt>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>description</dt>\n                                <dd>{{sequence.description}}</dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>author</dt>\n                                <dd>{{sequence.author.name}}</dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>contributors</dt>\n                                <dd><span\n                                        ng-repeat="contributor in sequence.contributors">{{contributor.name}}<span\n                                        ng-hide="$last">, </span></span><span\n                                        ng-show="sequence.contributors.length == 0"\n                                        class="text-muted">There is no contributors in this library.</span>\n                                </dd>\n                            </dl>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="Player" active="tabs.player.active">\n                    <div style="height: 500px;"></div>\n                </uib-tab>\n                <uib-tab heading="Items" active="tabs.editor.active">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item pointer-hand well-hover" ng-class="{\'well-active\': isActive($index)}"\n                                    ng-repeat="mark in sequence.marks | orderBy:\'row\'">\n                                    <div class="input-item-overlay">\n                                        <div ng-click="seek($index)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{mark.clip.thumbnail}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{mark.clip.name|uppercase}}</span>\n                                            <span ng-show="isActive($index)" style="font-size: 35px; position: absolute; right: 0px; opacity: 0.5;">NOW PLAYING</span>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n            </uib-tabset>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/sequencesInformationEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-edit"></span> {{initial.name}}</h4></div>\n<div class="modal-body">\n    <form name="editSequence" class="form-horizontal">\n        <uib-tabset type="pills">\n            <uib-tab heading="Sequence">\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Name</label>\n\n                    <div class="col-sm-10">\n                        <input name="name" ng-model="sequence.name" class="form-control" ng-trim="false"\n                               ui-validate="{exists: \'validateName($value)\' }"\n                               type="text" placeholder="Enter a name here" required/>\n                    </div>\n                </div>\n\n                <div ng-show="editSequence.name.$error.exists" class="col-md-offset-2">\n                    <p class="text-danger left-buffer-10">\n                        <strong>Already exists!</strong>\n                        <small>Sequence already exists.</small>\n                    </p>\n                </div>\n\n                <div ng-show="editSequence.name.$dirty && editSequence.name.$error.required"\n                     class="col-md-offset-2">\n                    <p class="text-danger left-buffer-10">\n                        <strong>Required!</strong>\n                        <small>Sequence name is required.</small>\n                    </p>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Description</label>\n\n                    <div class="col-sm-10">\n                <textarea name="description" ng-model="sequence.description" class="form-control"\n                          placeholder="Enter a description here" rows="5"></textarea>\n                    </div>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Author</label>\n\n                    <div class="col-sm-10">\n                        <ui-select ng-model="sequence.author" ng-disabled="!isAuthor()" ng-change="filter()"\n                                   required>\n                            <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                            <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}\n                            </ui-select-choices>\n                        </ui-select>\n                    </div>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Public</label>\n\n                    <div class="col-sm-10">\n                        <input type="checkbox" ng-model="sequence.public" ng-disabled="!isAuthor()"><span class="text-muted"\n                                                                                     style="margin-left: 10px;">Turn this sequence into the public mode</span>\n                    </div>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Master</label>\n\n                    <div class="col-sm-10">\n                        <ui-select ng-model="sequence.master" ng-disabled="!isAuthor()">\n                            <ui-select-match placeholder="Select master clip">{{$select.selected.name}}</ui-select-match>\n                            <ui-select-choices repeat="item in items | filter:$select.search">\n                                <div class="small-item-overlay">\n                                    <img src="{{item.thumbnails[0]}}" height="30">\n                                    <span style="margin-left: 15px;" ng-bind-html="item.name | highlight: $select.search"></span>\n                                </div>\n                            </ui-select-choices>\n                        </ui-select>\n                    </div>\n                </div>\n            </uib-tab>\n            <uib-tab heading="Contributors" disable="(contributors.length == 0 && sequence.contributors == 0) || !isAuthor()">\n                <div class="form-group">\n                    <div class="col-sm-5">\n                        <ui-select ng-model="contributor.selected"\n                                   theme="bootstrap"\n                                   reset-search-input="true"\n                                   on-select="addContribution($select.selected)"\n                                   style="width: 300px;">\n                            <ui-select-match placeholder="Select a contributor...">{{$select.selected.name}}</ui-select-match>\n                            <ui-select-choices repeat="contributor in contributors"\n                                               refresh-delay="0">\n                                <div ng-bind-html="contributor.name | highlight: $select.search"></div>\n                            </ui-select-choices>\n                        </ui-select>\n                    </div>\n\n                    <div class="col-sm-7">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <div ng-show="sequence.contributors.length == 0" style="text-align: center; color: grey;">Select\n                                a user you would like to be a part of the project.\n                            </div>\n                            <div ng-hide="sequence.contributors.length == 0">\n                                <ul class="list-group">\n                                    <li class="list-group-item" ng-repeat="contributor in sequence.contributors">\n                                        {{contributor.name}} <span class="fa fa-times pull-right pointer-hand" ng-click="removeContribution(contributor)"></span>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </uib-tab>\n        </uib-tabset>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!editSequence.$valid"\n            ng-click="edit()">Save Sequence\n    </button>\n</div>')
}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/synthesizers/sequence.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="text-center">{{synthesizer.description}}</div>\n')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/users.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-12" role="main">\n            <div class="bs-docs-section" id="users">\n                <h5 class="page-header">Users</h5>\n\n                <div ng-hide="filtered.length > 0" class="col-md-12 item-empty">Any user meets you search\n                    criteria..\n                </div>\n\n                <div ng-repeat="user in filtered = (users | filter:search) | orderBy:\'name\'"\n                     class="well well-hover" ng-click="edit(user)">\n                    <dl class="dl-horizontal">\n                        <dt class="block-header">{{user.name}}</dt>\n                        <dd></dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>username</dt>\n                        <dd>{{user.username}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>email</dt>\n                        <dd>{{user.email}}</dd>\n                    </dl>\n                    <dl class="dl-horizontal">\n                        <dt>roles</dt>\n                        <dd><span ng-repeat="role in user.roles"\n                                  ng-class="{label:true, \'label-danger\':role==\'admin\', \'label-default\':role!=\'admin\'}"\n                                  style="display: inline-block; margin-right: 10px;">{{role}}</span></dd>\n                    </dl>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/usersEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-edit"></span> {{user.name}}</h4></div>\n<div class="modal-body">\n    <form name="editUser" class="form-horizontal">\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Username</label>\n\n            <div class="col-sm-10">\n                <input name="username" ng-model="user.username" class="form-control" ng-trim="false"\n                       ui-validate="{exists: \'validateUsername($value)\' }" type="text" placeholder="Enter a username here"\n                       filtervalue="projectname" required/>\n            </div>\n        </div>\n\n        <div ng-show="editUser.username.$error.exists" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Already exists!</strong>\n                <small>User with same username already exists.</small>\n            </p>\n        </div>\n\n        <div ng-show="editUser.username.$dirty && editUser.username.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>Username is required.</small>\n            </p>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Email</label>\n\n            <div class="col-sm-10">\n                <input name="email" ng-model="user.email" class="form-control" ng-trim="false" type="text" placeholder="Optional"/>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-sm-2 control-label">Roles</label>\n\n            <div class="col-sm-10">\n                <ui-select name="roles" multiple ng-model="user.roles" style="width: 100%;" ng-disabled="!admin" ui-validate="{required: \'validateRolesRequired($value)\', admin: \'validateRolesAdmin($value)\'}">\n                    <ui-select-match placeholder="Select roles">{{$item}}</ui-select-match>\n                    <ui-select-choices repeat="role in roles | filter:$select.search">{{role}}</ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n\n        <div ng-show="editUser.roles.$error.admin" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Error!</strong>\n                <small>At least one user has to be an admin.</small>\n            </p>\n        </div>\n\n        <div ng-show="editUser.roles.$error.required" class="col-md-offset-2">\n            <p class="text-danger left-buffer-10">\n                <strong>Required!</strong>\n                <small>At least one role is required.</small>\n            </p>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!editUser.$valid"\n            ng-click="edit()">Save Profile\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/version.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<span>Currently version <span style="font-weight: bolder">ui<span class="fa fa-at"></span>{{uiVersion}}</span> and <span style="font-weight: bolder">core<span class="fa fa-at"></span>{{coreVersion}}</span></span>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/viewer.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div ng-switch="layout.id" style="position: fixed; top: 0; width: 100%; height: 100%;">\n    <div ng-switch-when="visualization_only">\n        <div narra-project="project" narra-layout="layout" layouts-visualization-only></div>\n    </div>\n\n    <div ng-switch-when="sequence_player_only">\n        <div narra-project="project" narra-layout="layout" layouts-sequence-player-only></div>\n    </div>\n\n    <div ng-switch-when="sequence_player_with_metadata">\n        <div narra-project="project" narra-layout="layout" layouts-sequence-player-with-metadata></div>\n    </div>\n\n    <div ng-switch-when="sequence_player_with_context">\n        <div narra-project="project" narra-layout="layout" layouts-sequence-player-with-context></div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/visualizations.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n\n        <div ng-hide="myVisualizations.length > 0 || publicVisualizations.length > 0 || contribVisualizations.length > 0" class="col-md-12 item-empty">\n            Create a new visualization clicking the red button.\n        </div>\n\n        <div class="col-md-12" role="main" ng-show="myVisualizations.length > 0 || contribVisualizations.length > 0 || publicVisualizations.length > 0">\n\n            <h5 class="page-header">VISUALIZATION</h5>\n\n            <uib-tabset type="pills">\n                <uib-tab heading="My Visualizations" active="tabs.myVisualizations.active" ng-show="myVisualizations.length > 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item pointer-hand well-hover"\n                                    ng-repeat="visualization in myVisualizations | orderBy:\'name\'">\n                                    <span ng-show="visualization.public" class="label label-success narra-badge">public</span>\n                                    <span ng-hide="visualization.public" class="label label-danger narra-badge">private</span>\n                                    <div class="input-item-overlay">\n                                        <div ng-click="detail(visualization)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{visualization.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{visualization.name|uppercase}}</span>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="My Contributions" active="tabs.contribVisualizations.active" ng-show="contribVisualizations.length > 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item pointer-hand well-hover"\n                                    ng-repeat="visualization in contribVisualizations | orderBy:\'name\'">\n                                    <span ng-show="visualization.public" class="label label-success narra-badge">public</span>\n                                    <span ng-hide="visualization.public" class="label label-danger narra-badge">private</span>\n                                    <div class="input-item-overlay">\n                                        <div ng-click="detail(visualization)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{visualization.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{visualization.name|uppercase}}</span>\n                                            <small>by <strong>{{visualization.author.name}}</strong></small>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="Public Visualizations" active="tabs.publicVisualizations.active" ng-show="publicVisualizations.length > 0">\n                    <div class="tab-content">\n                        <div class="row">\n                            <ul class="list-group">\n                                <li class="list-group-item pointer-hand well-hover"\n                                    ng-repeat="visualization in publicVisualizations | orderBy:\'name\'">\n                                    <span ng-show="visualization.public" class="label label-success narra-badge">public</span>\n                                    <span ng-hide="visualization.public" class="label label-danger narra-badge">private</span>\n                                    <div class="input-item-overlay">\n                                        <div ng-click="detail(visualization)" class="small-item-overlay"\n                                             style="margin-left: 10px;">\n                                            <img src="{{visualization.thumbnails[0]}}" height="50">\n                                            <span style="margin-left: 15px; font-weight: bold; font-size: 12px;">{{visualization.name|uppercase}}</span>\n                                            <small>by <strong>{{visualization.author.name}}</strong></small>\n                                        </div>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </uib-tab>\n            </uib-tabset>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/visualizations/generic.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n<div class="text-center">{{visualization.description}}</div>\n\n<div style="margin-top: 20px;" ng-repeat="(key, value) in visualization.options">\n    <div class="form-group">\n        <label class="col-sm-6 control-label">{{key|propertyname}}</label>\n\n        <div class="col-sm-6">\n            <input name="name" ng-model="visualization.options[key]" class="form-control" ng-trim="false"\n                   type="text"/>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/visualizationsAdd.html",'<!--\n#\n# Copyright (C) 2015 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-plus"></span> Add new visualization</h4></div>\n<div class="modal-body">\n    <form name="newVisualization" class="form-horizontal">\n            <div ng-if="!second">\n                <div class="text-center">Select visualization type</div>\n\n                <div class="text-center">\n                    <span class="btn btn-danger" ng-click="select(\'processing\')">Processing</span>\n                    <span class="btn btn-danger" ng-click="select(\'p5js\')">p5.js</span>\n                </div>\n\n                <br/>\n\n                <div nv-file-drop="" uploader="uploader">\n                    <div nv-file-over="" uploader="uploader" over-class="drop-zone-over"\n                         class="well drop-zone">\n                        or drop your visualization script here\n                    </div>\n                </div>\n            </div>\n\n        <div ng-if="second">\n            <div ng-show="visualization.file" class="form-group">\n                <label class="col-sm-2 control-label">Script</label>\n\n                <div class="col-sm-10">\n                    <input name="file" ng-model="visualization.file.name" class="form-control" type="text" disabled/>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Name</label>\n\n                <div class="col-sm-10">\n                    <input name="name" ng-model="visualization.name" class="form-control" ng-trim="false"\n                           type="text" placeholder="Enter a name here" required/>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Type</label>\n\n                <div class="col-sm-10">\n                    <input name="type" ng-model="visualization.type" class="form-control" type="text" disabled/>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Author</label>\n\n                <div class="col-sm-10">\n                    <ui-select ng-model="visualization.author" required>\n                        <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                        <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <label class="col-sm-2 control-label">Description</label>\n\n                <div class="col-sm-10">\n                <textarea name="description" ng-model="visualization.description" class="form-control"\n                          placeholder="Enter a description here (Optional)" rows="5"></textarea>\n                </div>\n            </div>\n        </div>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <span ng-if="second" class="btn btn-default" ng-click="back()">Back</span>\n    <button ng-if="second" class="btn btn-danger" ng-disabled="!newVisualization.$valid"\n            ng-click="new()">Add Visualization\n    </button>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/visualizationsDetail.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="container bs-docs-container">\n\n    <div class="row">\n        <div class="col-md-12" role="main">\n            <h5 class="page-header">{{visualization.name}}</h5>\n\n            <div ng-if="isAuthor() || isContributor()" ui-scrollpoint="+30">\n                <div class="pull-right">\n                    <div class="btn-group" ng-show="tabs.code.active">\n                        <button class="btn btn-danger" ng-click="save()">Save Script</button>\n                    </div>\n                    <div class="btn-group" uib-dropdown>\n                        <button id="preview" type="button" class="btn btn-danger" uib-dropdown-toggle>\n                            Preview <span class="caret"></span>\n                        </button>\n                        <ul class="uib-dropdown-menu pull-right" role="menu" aria-labelledby="preview">\n                            <li ng-repeat="project in projects" role="menuitem"><a href="#" ng-click="preview(project)">{{project.title}}</a>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class="btn-group" uib-dropdown>\n                        <button id="settings" type="button" class="btn btn-danger" uib-dropdown-toggle>\n                            <span class="fa fa-cog"></span> <span class="caret"></span>\n                        </button>\n                        <ul class="uib-dropdown-menu pull-right" role="menu" aria-labelledby="settings">\n                            <li role="menuitem"><a href="#" ng-click="edit()">Settings</a></li>\n                            <li role="menuitem" ng-show="isAuthor()"><a href="#" ng-click="delete()">Delete</a></li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n\n            <uib-tabset type="pills">\n                <uib-tab heading="Visualization" active="tabs.visualization.active">\n                    <div>\n                        <span ng-show="visualization.public" class="label label-success narra-badge">public</span>\n                        <span ng-hide="visualization.public" class="label label-danger narra-badge">private</span>\n\n                        <div ng-repeat="thumbnail in visualization.thumbnails track by $index"\n                             class="background-cover"\n                             style="background-image: url(\'{{thumbnail}}\'); background-size: contain; width: 20%; height: 100px; float: left; margin-bottom: 10px;"></div>\n                        <div class="well">\n                            <dl class="dl-horizontal">\n                                <dt class="block-header">{{visualization.name}}</dt>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>description</dt>\n                                <dd>{{visualization.description}}</dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>author</dt>\n                                <dd>{{visualization.author.name}}</dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>contributors</dt>\n                                <dd><span\n                                        ng-repeat="contributor in visualization.contributors">{{contributor.name}}<span\n                                        ng-hide="$last">, </span></span><span\n                                        ng-show="visualization.contributors.length == 0"\n                                        class="text-muted">There is no contributors in this library.</span>\n                                </dd>\n                            </dl>\n                            <dl class="dl-horizontal">\n                                <dt>type</dt>\n                                <dd>{{visualization.type}}</dd>\n                            </dl>\n                        </div>\n                    </div>\n                </uib-tab>\n                <uib-tab heading="Code" active="tabs.code.active">\n                    <div ng-if="ready" ui-ace="editorOption" ng-model="content"></div>\n                </uib-tab>\n            </uib-tabset>\n        </div>\n    </div>\n</div>')}]),angular.module("narra.ui").run(["$templateCache",function(e){e.put("partials/visualizationsInformationEdit.html",'<!--\n#\n# Copyright (C) 2014 CAS / FAMU\n#\n# This file is part of Narra Core.\n#\n# Narra Core is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Narra Core is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Narra Core. If not, see <http://www.gnu.org/licenses/>.\n#\n# Authors: Michal Mocnak <michal@marigan.net>\n#\n-->\n\n<div class="modal-header"><h4 class="modal-title"><span class="fa fa-edit"></span> {{initial.name}}</h4></div>\n<div class="modal-body">\n    <form name="editVisualization" class="form-horizontal">\n        <uib-tabset type="pills">\n            <uib-tab heading="Visualization">\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Name</label>\n\n                    <div class="col-sm-10">\n                        <input name="name" ng-model="visualization.name" class="form-control" ng-trim="false"\n                               ui-validate="{exists: \'validateName($value)\' }"\n                               type="text" placeholder="Enter a name here" required/>\n                    </div>\n                </div>\n\n                <div ng-show="editVisualization.name.$error.exists" class="col-md-offset-2">\n                    <p class="text-danger left-buffer-10">\n                        <strong>Already exists!</strong>\n                        <small>Visualization already exists.</small>\n                    </p>\n                </div>\n\n                <div ng-show="editVisualization.name.$dirty && editVisualization.name.$error.required"\n                     class="col-md-offset-2">\n                    <p class="text-danger left-buffer-10">\n                        <strong>Required!</strong>\n                        <small>Visualization name is required.</small>\n                    </p>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Description</label>\n\n                    <div class="col-sm-10">\n                <textarea name="description" ng-model="visualization.description" class="form-control"\n                          placeholder="Enter a description here" rows="5"></textarea>\n                    </div>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Author</label>\n\n                    <div class="col-sm-10">\n                        <ui-select ng-model="visualization.author" ng-disabled="!isAuthor()" ng-change="filter()"\n                                   required>\n                            <ui-select-match placeholder="Pick an author">{{$select.selected.name}}</ui-select-match>\n                            <ui-select-choices repeat="user in users | filter:$select.search">{{user.name}}\n                            </ui-select-choices>\n                        </ui-select>\n                    </div>\n                </div>\n\n                <div class="form-group">\n                    <label class="col-sm-2 control-label">Public</label>\n\n                    <div class="col-sm-10">\n                        <input type="checkbox" ng-model="visualization.public" ng-disabled="!isAuthor()"><span class="text-muted"\n                                                                                     style="margin-left: 10px;">Turn this visualization into the public mode</span>\n                    </div>\n                </div>\n            </uib-tab>\n            <uib-tab heading="Contributors" disable="(contributors.length == 0 && visualization.contributors == 0) || !isAuthor()">\n                <div class="form-group">\n                    <div class="col-sm-5">\n                        <ui-select ng-model="contributor.selected"\n                                   theme="bootstrap"\n                                   reset-search-input="true"\n                                   on-select="addContribution($select.selected)"\n                                   style="width: 300px;">\n                            <ui-select-match placeholder="Select a contributor...">{{$select.selected.name}}</ui-select-match>\n                            <ui-select-choices repeat="contributor in contributors"\n                                               refresh-delay="0">\n                                <div ng-bind-html="contributor.name | highlight: $select.search"></div>\n                            </ui-select-choices>\n                        </ui-select>\n                    </div>\n\n                    <div class="col-sm-7">\n                        <div class="well" style="max-height: 300px; overflow: auto;">\n                            <div ng-show="visualization.contributors.length == 0" style="text-align: center; color: grey;">Select\n                                a user you would like to be a part of the project.\n                            </div>\n                            <div ng-hide="visualization.contributors.length == 0">\n                                <ul class="list-group">\n                                    <li class="list-group-item" ng-repeat="contributor in visualization.contributors">\n                                        {{contributor.name}} <span class="fa fa-times pull-right pointer-hand" ng-click="removeContribution(contributor)"></span>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </uib-tab>\n        </uib-tabset>\n    </form>\n</div>\n<div class="modal-footer">\n    <span class="btn btn-default" ng-click="close()">Cancel</span>\n    <button class="btn btn-danger" ng-disabled="!editVisualization.$valid"\n            ng-click="edit()">Save Visualization\n    </button>\n</div>')
}]),angular.module("narra.ui").factory("apiAuth",["$resource","serviceServer",function(e,t){return e(t.url+"/auth/:action",{},{providers:{method:"GET",params:{action:"providers"}}})}]),angular.module("narra.ui").factory("apiEvent",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/events/:scope",{token:n.get()},{all:{method:"GET"},me:{method:"GET",params:{scope:"me"}}})}]),angular.module("narra.ui").factory("apiGenerator",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/generators",{token:n.get()},{all:{method:"GET"}})}]),angular.module("narra.ui").factory("apiItem",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/items/:id/:action0/:param/:action1",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},check:{method:"POST",params:{action0:"check"}},"new":{method:"POST",params:{action0:"new"}},"delete":{method:"GET",params:{action0:"delete"}},events:{method:"GET",params:{action0:"events"}},thumbnails:{method:"GET",params:{id:"thumbnails"}},regenerate:{method:"GET",params:{action0:"regenerate"}},metadata:{method:"GET",params:{id:"@id",action0:"metadata"}},metadataNew:{method:"POST",params:{id:"@id",action0:"metadata",action1:"new"}},metadataUpdate:{method:"POST",params:{id:"@id",param:"@meta",action0:"metadata",action1:"update"}},metadataDelete:{method:"GET",params:{action0:"metadata",action1:"delete"}}})}]),angular.module("narra.ui").factory("apiLibrary",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/libraries/:id/:action0/:param/:action1/:name",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},"new":{method:"POST",params:{action0:"new"}},"delete":{method:"GET",params:{action0:"delete"}},validate:{method:"POST",params:{action0:"validate"}},items:{method:"GET",params:{action0:"items"}},metaValues:{method:"GET",params:{action0:"items",param:"metadata"}},update:{method:"POST",params:{id:"@id",action0:"update"}},regenerate:{method:"GET",params:{action0:"regenerate"}},metadataNew:{method:"POST",params:{id:"@id",action0:"metadata",action1:"new"}},metadataUpdate:{method:"POST",params:{id:"@id",param:"@meta",action0:"metadata",action1:"update"}},metadataDelete:{method:"GET",params:{action0:"metadata",action1:"delete"}}})}]),angular.module("narra.ui").factory("apiProject",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/projects/:action0/:name/:action1/:param/:action2",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},"new":{method:"POST",params:{action1:"new"}},"delete":{method:"GET",params:{action1:"delete"}},validate:{method:"POST",params:{action0:"validate"}},update:{method:"POST",params:{name:"@name",action1:"update"}},items:{method:"GET",params:{action1:"items"}},item:{method:"POST",params:{name:"@name",action1:"items",param:"@id",action2:"metadata"}},junctions:{method:"GET",params:{action1:"junctions"}},junctionsItems:{method:"GET",params:{action1:"junctions",action2:"items"}},sequences:{method:"GET",params:{action1:"sequences"}},sequencesNew:{method:"POST",headers:{"Content-Type":void 0},params:{name:"@name",action1:"sequences",action2:"new"}},sequencesDelete:{method:"GET",params:{action1:"sequences",action2:"delete"}},sequencesUpdate:{method:"POST",params:{name:"@name",param:"@sequence",action1:"sequences",action2:"update"}},metadataNew:{method:"POST",params:{name:"@name",action1:"metadata",action2:"new"}},metadataUpdate:{method:"POST",params:{name:"@name",param:"@meta",action1:"metadata",action2:"update"}},metadataDelete:{method:"GET",params:{action1:"metadata",action2:"delete"}},visualizationsAction:{method:"POST",params:{name:"@name",action1:"visualizations",action2:"@action"}}})}]),angular.module("narra.ui").factory("apiSettings",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/settings/:name/:action",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},defaults:{method:"GET",params:{name:"defaults"}},update:{method:"POST",params:{name:"@name",action:"update"}}})}]),angular.module("narra.ui").factory("apiSynthesizers",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/synthesizers",{token:n.get()},{all:{method:"GET"}})}]),angular.module("narra.ui").factory("apiSystem",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/system/:action",{token:n.get()},{version:{method:"GET",params:{action:"version"}},modules:{method:"GET",params:{action:"modules"}}})}]),angular.module("narra.ui").factory("apiUser",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/users/:username/:action",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},profile:{method:"GET",params:{username:"me"}},signout:{method:"GET",params:{username:"me",action:"signout"}},roles:{method:"GET",params:{username:"roles"}},"delete":{method:"GET",params:{action:"delete"}},update:{method:"POST",params:{username:"@username",action:"update"}}})}]),angular.module("narra.ui").factory("apiVisualization",["$resource","serviceServer","serviceToken",function(e,t,n){return e(t.url+"/v1/visualizations/:id/:action0",{token:n.get()},{all:{method:"GET"},get:{method:"GET"},"new":{method:"POST",headers:{"Content-Type":void 0},params:{action0:"new"}},"delete":{method:"GET",params:{action0:"delete"}},update:{method:"POST",headers:{"Content-Type":void 0},params:{id:"@id",action0:"update"}}})}]),angular.module("narra.ui").controller("AddCtrl",["$scope","$rootScope","dialogs",function(e,t,n){return e.addProject=function(){var e;return e=n.create("partials/projectsAdd.html","ProjectsAddCtrl",{},{size:"lg",keyboard:!1}),e.result.then(function(e){return e.result.then(function(){return t.$broadcast("event:narra-project-created")})})},e.addLibrary=function(){var e;return e=n.create("partials/librariesAdd.html","LibrariesAddCtrl",{},{size:"lg",keyboard:!1}),e.result.then(function(e){return e.result.then(function(){return t.$broadcast("event:narra-library-created")})})},e.addItem=function(){var e;return e=n.create("partials/itemsAdd.html","ItemsAddCtrl",{},{size:"lg",keyboard:!1}),e.result.then(function(e){return e.result.then(function(){return t.$broadcast("event:narra-item-created")})})},e.addSequence=function(){var e;return e=n.create("partials/sequencesAdd.html","SequencesAddCtrl",{},{size:"lg",keyboard:!1}),e.result.then(function(e){return e.result.then(function(){return t.$broadcast("event:narra-sequence-created")})})},e.addVisualization=function(){var e;return e=n.create("partials/visualizationsAdd.html","VisualizationsAddCtrl",{},{size:"lg",keyboard:!1}),e.result.then(function(e){return e.result.then(function(){return t.$broadcast("event:narra-visualization-created")})})}}]),angular.module("narra.ui").controller("DashboardCtrl",["$scope","$rootScope","$location","$q","apiProject","apiItem","elzoidoPromises",function(e,t,n,i,r,o,a){return e.refresh=function(){var t,n;return n=i.defer(),t=i.defer(),o.thumbnails({param:10},function(t){return e.thumbnails=_.isEmpty(t.thumbnails)?["/images/empty_carousel.png"]:t.thumbnails,n.resolve(!0)}),r.all(function(n){return e.projects=_.where(n.projects,{"public":!0}),t.resolve(!0)}),a.register("dashboard",[t.promise,n.promise])},e.view=function(e){return n.path("/viewer/"+e.name)},t.$on("event:narra-project-created",function(){return e.refresh()}),e.refresh()}]),angular.module("narra.ui").controller("EventsCtrl",["$scope","$rootScope","$interval","dialogs","apiEvent",function(e,t,n,i,r){return e.refresh=function(){return r.me({},function(t){return _.forEach(t.events,function(e){return e.progress=Math.floor(100*e.progress)}),e.events=t.events})},e.startRefreshInterval=function(){return angular.isDefined(e.refreshInterval)?void 0:(e.refresh(),e.refreshInterval=n(function(){return e.refresh()},2e4))},e.stopRefreshInterval=function(){return angular.isDefined(e.refreshInterval)?(n.cancel(e.refreshInterval),e.refreshInterval=void 0):void 0},e.$on("event:elzoido-auth-user",function(){return e.startRefreshInterval()}),e.$on("$destroy",function(){return e.stopRefreshInterval()}),e.$watch("events",function(e,n){var i;return i=_.difference(_.pluck(n,"id"),_.pluck(e,"id")),i.length>0?_.forEach(i,function(e){var i;return i=_.find(n,{id:e}),_.isUndefined(i.item)||t.$broadcast("event:narra-item-updated",i.item.id),_.isUndefined(i.project)||t.$broadcast("event:narra-project-updated",i.project.name),_.isUndefined(i.library)?void 0:t.$broadcast("event:narra-library-purged",i.library.id)}):void 0})}]),angular.module("narra.ui").controller("InfoCtrl",["$scope","serviceVersion","apiSystem",function(e,t,n){return t.version(function(t){return e.uiVersion=t.version}),n.version(function(t){return e.coreVersion=t.version}),n.modules(function(t){return e.coreModules=t.modules})}]),angular.module("narra.ui").controller("ItemsAddCtrl",["$scope","$rootScope","$q","$timeout","$filter","$modalInstance","dialogs","apiItem","apiLibrary","apiUser","elzoidoMessages","elzoidoAuthUser","elzoidoPromises","serviceThumbnail",function(e,t,n,i,r,o,a,s,l,u,c,h,d,p){return e.user=h.get(),e.item={url:"",library:"",author:e.user},l.all(function(t){var n;return n=angular.copy(t.libraries),e.user.isAdmin()||_.remove(n,function(t){return!_.contains(_.pluck(t.contributors,"username").concat([t.author.username]),e.user.username)}),e.libraries=n}),u.all(function(t){return e.users=t.users}),e.close=function(){return o.dismiss("canceled")},e.next=function(){var t,r,o;return e.second?(e.third=!0,e.second=!1):(e.author=!0,e.items=[],o=a.wait("Please Wait","Checking new items ..."),r=[],t=e.item.url.split("\n"),_.forEach(t,function(t){var o;return o=n.defer(),r.push(o.promise),i(function(){return s.check({url:t},function(t){return _.forEach(t.items,function(t){return _.isNull(t.thumbnail)&&(t.thumbnail=p.thumbnail(t.type)),e.items.push(t),e.author=e.author&&t.author}),o.resolve(!0)},function(){return o.resolve(!0)})},100)}),d.register("check-items",r),d.promise("check-items").then(function(){return o.close(),_.isEmpty(e.items)?void 0:e.second=!0}))},e.back=function(){return e.third?(e.third=!1,e.second=!0):e.second?(e.items=[],e.second=!1):void 0},e["new"]=function(){var t,n;return n=a.wait("Please Wait","Registering new items ..."),o.close(n),t=[],_.forEach(e.items,function(n){return t.push({url:n.url,author:e.item.author.name,library:e.item.library.id,connector:n.connector,options:n[n.connector]})}),s["new"]({items:t},function(){return c.send("success","Success!","Items were successfully created."),n.close()})}}]),angular.module("narra.ui").controller("ItemsDetailCtrl",["$scope","$rootScope","$routeParams","$location","$sce","$document","$interval","$timeout","$filter","$q","dialogs","apiProject","apiLibrary","apiItem","apiUser","uiGmapGoogleMapApi","constantMetadata","elzoidoPromises","elzoidoMessages","elzoidoAuthUser",function(e,t,n,i,r,o,a,s,l,u,c,h,d,p,f,g,m,v,y,b){return e.itemMetadata={},e.tabs={player:{},text:{},metadata:{active:!0}},e.player={api:void 0,ready:!1,preload:!0,autoHide:!0,autoHideTime:2e3,autoPlay:!1,sources:[],tracks:[],cuePoints:{},plugins:{}},e.editorOption={theme:"chrome",require:["ace/ext/language_tools","ace/ext/static_highlight","ace/ext/error_marker","ace/ext/searchbox"],useWrapMode:!0,showGutter:!1,showPrintMargin:!1,advanced:{},onLoad:function(e){var t;return e.setReadOnly(!0),t=e.getSession(),t.setMode("ace/mode/text"),e.setAutoScrollEditorIntoView(!0),e.setOption("maxLines",120),e.setFontSize("14px")}},v.promise("authentication").then(function(){return e.refresh=function(){var t,i;return e.user=b.get(),t=u.defer(),i=u.defer(),d.get({id:n.library},function(t){return e.generators=t.library.generators,e.library=t.library,_.isUndefined(n.project)||(e.project=_.find(e.library.projects,{name:n.project})),i.resolve(!0)}),p.get({id:n.item},function(n){var i;switch(n.item.type){case"video":e.player.sources=[{src:r.trustAsResourceUrl(n.item.video_proxy_hq),type:"video/webm"}],e.duration=_.where(n.item.metadata,{name:"duration"})[0].value,e.cuepoints=_.reduce(n.item.metadata,function(t,n){var i;return!_.isUndefined(n.marks)&&n.marks.length>0&&!_.isEqual(n.generator,"thumbnail")&&!_.isEqual(n.generator,"transcoder")&&(i={timeLapse:{start:n.marks[0]["in"]},onUpdate:function(){return e.active=!0,e.live=n},onComplete:function(){return e.active=!1,s(function(){return e.active?void 0:e.live=void 0},2e3)}},i.timeLapse.end=_.isUndefined(n.marks[0].out)?n.marks[0]["in"]+.3:n.marks[0].out,t.push(i)),t},[]),e.player.cuePoints={metadata:e.cuepoints},e.player.ready=!0;break;case"text":e.text=_.where(n.item.metadata,{name:"text"})[0].value,n.item.metadata=_.filter(n.item.metadata,function(e){return!_.isEqual(e.name,"text")})}return e.item=n.item,i=_.uniq(_.pluck(e.item.metadata,"generator")),e.metadataProviders=_.filter(m.providers,function(e){return!_.include(i,e.id)||_.isEqual(e.id,"user_custom")}),t.resolve(!0)}),v.register("item",[t.promise,i.promise])},e.refreshMetadata=function(){return p.get({id:n.item},function(t){var n;return e.item=t.item,n=_.uniq(_.pluck(e.item.metadata,"name")),e.metadataProviders=_.filter(m.providers,function(e){return!_.include(n,e.id)||_.isEqual(e.id,"custom")})})},e.isAuthor=function(){return!_.isUndefined(e.library)&&_.isEqual(e.library.author.username,e.user.username)||e.user.isAdmin()},e.isContributor=function(){return!_.isUndefined(e.library)&&_.include(_.pluck(e.library.contributors,"username"),e.user.username)},e["delete"]=function(){var t;return t=c.confirm("Please Confirm","You are about to delete the item "+e.item.name+", this procedure is irreversible. Do you want to continue ?"),t.result.then(function(){return p["delete"]({id:e.item.id},function(){return i.url("/libraries/"+e.library+"#"+e.from),y.send("success","Success!","Item "+e.item.name+" was successfully deleted.")})})},e.onPlayerReady=function(t){return e.player.api=t},e.seek=function(t){return e.api.seekTime(t)},e.$on("event:narra-item-updated",function(t,i){return _.isEqual(n.item,i)?e.refreshMetadata():void 0}),e.refresh()})}]),angular.module("narra.ui").controller("LayoutsSequencePlayerOnlyCtrl",["$scope","$sce","$timeout","$routeParams","$window","$rootScope","$q","apiProject","apiVisualization","elzoidoPromises",function(e,t,n,i,r,o,a,s,l,u){return e.player={api:void 0,ready:!1,preload:!0,autoHide:!0,autoHideTime:2e3,autoPlay:!1,sources:[],playlist:[],tracks:[],cuePoints:{},plugins:{}},e.refresh=function(){var n;return n=a.defer(),s.sequences({name:e.project.name,param:e.layout.options.sequence},function(i){var r;return e.sequence=i.sequence,r=0,_.forEach(e.sequence.marks,function(e){return _.isUndefined(e.clip.source)&&(e.clip.source="black"===e.clip.name?"http://static.rur.cz/narra/black/black.mp4":"http://static.rur.cz/narra/bars/bars.mp4",e["in"]=0,e.out=e.duration),e.master_in=r,r+=e.duration}),_.isUndefined(e.sequence.master)?_.forEach(e.sequence.marks,function(n){return e.player.playlist.push({"in":n["in"],out:n.out,src:{src:t.trustAsResourceUrl(n.clip.source),type:"video/mp4"}})}):e.player.playlist.push({"in":0,src:{src:t.trustAsResourceUrl(e.sequence.master.source),type:"video/mp4"}}),e.player.current=0,e.player.sources=[e.player.playlist[0].src],n.resolve(!0)}),u.register("sequence",[n.promise]),u.promise("sequence").then(function(){return e.player.ready=!0})},e.onPlayerReady=function(t){return e.player.api=t,n(function(){return e.player.api.seekTime(e.player.playlist[0]["in"])},0)},e.playlistHandler=function(t){return _.isUndefined(e.sequence.master)?t>=e.player.playlist[e.player.current].out?(e.player.current+=1,e.playerAction()):void 0:_.forEach(e.sequence.marks,function(n,i){return t>n.master_in&&(e.sequence.marks.length===i+1||t<e.sequence.marks[i+1].master_in)?e.player.current=i:void 0})},e.isActive=function(t){return e.player.current===t},e.playerAction=function(){return e.player.current!==e.player.playlist.length?(e.player.sources=[e.player.playlist[e.player.current].src],n(function(){return e.player.api.seekTime(e.player.playlist[e.player.current]["in"]),e.player.api.play()},0)):(e.player.api.stop(),e.player.current=0,e.player.sources=[e.player.playlist[e.player.current].src],n(function(){return e.player.api.seekTime(e.player.playlist[e.player.current]["in"])},0))},e.refresh()}]),angular.module("narra.ui").controller("LayoutsSequencePlayerWithContextCtrl",["$scope","$sce","$timeout","$routeParams","$window","$rootScope","$q","apiProject","apiVisualization","elzoidoPromises",function(e,t,n,i,r,o,a,s,l,u){return e.player={api:void 0,ready:!1,preload:!0,autoHide:!0,autoHideTime:2e3,autoPlay:!1,sources:[],playlist:[],tracks:[],cuePoints:{},plugins:{}},e.refresh=function(){var n,i;return i=a.defer(),n=a.defer(),s.sequences({name:e.project.name,param:e.layout.options.sequence},function(r){var o;return e.sequence=r.sequence,o=0,_.forEach(e.sequence.marks,function(e){return _.isUndefined(e.clip.source)&&(e.clip.source="black"===e.clip.name?"http://static.rur.cz/narra/black/black.mp4":"http://static.rur.cz/narra/bars/bars.mp4",e["in"]=0,e.out=e.duration),e.master_in=o,o+=e.duration}),_.isUndefined(e.sequence.master)?_.forEach(e.sequence.marks,function(n){return e.player.playlist.push({"in":n["in"],out:n.out,src:{src:t.trustAsResourceUrl(n.clip.source),type:"video/mp4"}})}):e.player.playlist.push({"in":0,src:{src:t.trustAsResourceUrl(e.sequence.master.source),type:"video/mp4"}}),_.isUndefined(e.layout.options.contextual_synthesizers)?n.resolve(!0):(e.context={junctions:[],values:[]},e.context.synthesizers=_.map(e.layout.options.contextual_synthesizers.split(","),function(e){return e.trim()}),_.forEach(e.context.synthesizers,function(t,i){return s.junctions({name:e.project.name,param:t},function(t){return e.context.junctions=e.context.junctions.concat(t.junctions),e.context.synthesizers.length===i+1?n.resolve(!0):void 0})})),e.player.sources=[e.player.playlist[0].src],i.resolve(!0)}),u.register("sequence",[i.promise,n.promise]),u.promise("sequence").then(function(){return e.player.current=0,e.player.ready=!0})},e.onPlayerReady=function(t){return e.player.api=t,n(function(){return e.player.api.seekTime(e.player.playlist[0]["in"])},0)},e.playlistHandler=function(t){return _.isUndefined(e.sequence.master)?t>=e.player.playlist[e.player.current].out?(e.player.current+=1,e.playerAction()):void 0:_.forEach(e.sequence.marks,function(n,i){return t>n.master_in&&(e.sequence.marks.length===i+1||t<e.sequence.marks[i+1].master_in)?e.player.current=i:void 0})},e.$watch("player.current",function(){var t,n;return _.isUndefined(e.sequence)||_.isUndefined(e.context)||(t=e.sequence.marks[e.player.current],_.isUndefined(t.clip.id)||!_.isUndefined(e.context.values[e.player.current]))?void 0:(e.context.values[e.player.current]=[],n=_.where(e.context.junctions,{items:[{id:t.clip.id}]}),_.forEach(n,function(n){return _.forEach(n.items,function(n){return n.id!==t.clip.id?e.context.values[e.player.current].push(n):void 0})}))}),e.isActive=function(t){return e.player.current===t},e.playerAction=function(){return e.player.current!==e.player.playlist.length?(e.player.sources=[e.player.playlist[e.player.current].src],n(function(){return e.player.api.seekTime(e.player.playlist[e.player.current]["in"]),e.player.api.play()},0)):(e.player.api.stop(),e.player.current=0,e.player.sources=[e.player.playlist[e.player.current].src],n(function(){return e.player.api.seekTime(e.player.playlist[e.player.current]["in"])},0))},e.playerStateChanged=function(t){return"play"===t?e.contextPlayer={}:void 0},e.contextPlay=function(n,i){var r;return r=!_.isUndefined(e.contextPlayer)&&!_.isUndefined(e.contextPlayer[i]),e.contextPlayer={},r?e.player.api.play():s.items({name:e.project.name,param:n.id},function(r){var o;return"video"===r.item.type?(e.contextPlayer[i]=[{src:t.trustAsResourceUrl(r.item.video_proxy_hq),type:"video/mp4"}],o=_.find(r.item.metadata,{name:"author"}),_.isUndefined(o)||(n.author=o.value),e.player.api.pause()):void 0})},e.refresh()}]),angular.module("narra.ui").controller("LayoutsSequencePlayerWithMetadataCtrl",["$scope","$sce","$timeout","$routeParams","$window","$rootScope","$q","apiProject","apiVisualization","elzoidoPromises","uiGmapGoogleMapApi",function(e,t,n,i,r,o,a,s,l,u,c){return e.player={api:void 0,ready:!1,preload:!0,autoHide:!0,autoHideTime:2e3,autoPlay:!1,sources:[],playlist:[],tracks:[],cuePoints:{},plugins:{}},c.then(function(){return e.mapTilesLoaded=function(e){var t;return e.marker?void 0:(t=new google.maps.Marker({map:e}),t.setPosition(e.center),e.marker=!0)},e.refresh=function(){var n;return n=a.defer(),s.sequences({name:e.project.name,param:e.layout.options.sequence},function(i){var r;return e.sequence=i.sequence,r=0,_.forEach(e.sequence.marks,function(e){return _.isUndefined(e.clip.source)&&(e.clip.source="black"===e.clip.name?"http://static.rur.cz/narra/black/black.mp4":"http://static.rur.cz/narra/bars/bars.mp4",e["in"]=0,e.out=e.duration),e.master_in=r,r+=e.duration}),_.isUndefined(e.sequence.master)?_.forEach(e.sequence.marks,function(n){return e.player.playlist.push({"in":n["in"],out:n.out,src:{src:t.trustAsResourceUrl(n.clip.source),type:"video/mp4"}})}):e.player.playlist.push({"in":0,src:{src:t.trustAsResourceUrl(e.sequence.master.source),type:"video/mp4"}}),_.isUndefined(e.layout.options.metadata_fields)||(e.metadata={values:{}},e.metadata.fields=_.map(e.layout.options.metadata_fields.split(","),function(e){return e.trim()})),e.player.current=0,e.player.sources=[e.player.playlist[0].src],n.resolve(!0)}),u.register("sequence",[n.promise]),u.promise("sequence").then(function(){return e.player.ready=!0})},e.onPlayerReady=function(t){return e.player.api=t,n(function(){return e.player.api.seekTime(e.player.playlist[0]["in"])},0)},e.playlistHandler=function(t){return _.isUndefined(e.sequence.master)?t>=e.player.playlist[e.player.current].out?(e.player.current+=1,e.playerAction()):void 0:_.forEach(e.sequence.marks,function(n,i){return t>n.master_in&&(e.sequence.marks.length===i+1||t<e.sequence.marks[i+1].master_in)?e.player.current=i:void 0})},e.$watch("player.current",function(){var t;return _.isUndefined(e.sequence)||_.isUndefined(e.metadata)||(t=e.sequence.marks[e.player.current],_.isUndefined(t.clip.id)||!_.isUndefined(e.metadata.values[e.player.current]))?void 0:(e.metadata.values[e.player.current]={},s.item({name:e.project.name,id:t.clip.id},function(t){return _.forEach(e.metadata.fields,function(n){var i,r;return r=_.find(t.metadata,{name:n}),_.isUndefined(r)?void 0:("location"===n&&(i=r.value.split(","),e.mapOptions={center:new google.maps.LatLng(i[0],i[1]),zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP}),e.metadata.values[e.player.current][n]=r.value)})}))}),e.isActive=function(t){return e.player.current===t},e.playerAction=function(){return e.player.current!==e.player.playlist.length?(e.player.sources=[e.player.playlist[e.player.current].src],n(function(){return e.player.api.seekTime(e.player.playlist[e.player.current]["in"]),e.player.api.play()},0)):(e.player.api.stop(),e.player.current=0,e.player.sources=[e.player.playlist[e.player.current].src],n(function(){return e.player.api.seekTime(e.player.playlist[e.player.current]["in"])},0))},e.refresh()})}]),angular.module("narra.ui").controller("LayoutsVisualizationOnlyCtrl",["$scope","$routeParams","$window","$rootScope","$q","apiProject","apiVisualization","elzoidoPromises","angularLoad",function(e,t,n,i,r,o,a,s,l){return n.narra={width:n.innerWidth-5,height:n.innerHeight-5,getProject:function(){return e.project},getItems:function(t,n){return _.isUndefined(t)?e.items:_.reject(_.flatten(_.pluck(_.where(e.junctions[t],{items:[{id:n}]}),"items")),{id:n})},getItem:function(t){return _.find(e.items,{id:t})},getJunctions:function(t,n){return _.isUndefined(n)?e.junctions[t]:_.where(e.junctions[t],{items:[{id:n}]})}},e.visualization={},e.meta={},e.refresh=function(){var t,i,u;return i=r.defer(),t=r.defer(),u=r.defer(),e.junctions={},_.isEmpty(e.project.synthesizers)?i.resolve(!0):_.forEach(e.project.synthesizers,function(t,n){return o.junctions({name:e.project.name,param:t.identifier},function(r){return e.junctions[t.identifier]=r.junctions,n+1===e.project.synthesizers.length?i.resolve(!0):void 0})}),a.get({id:e.layout.options.visualization},function(t){return e.visualization=t.visualization,u.resolve(!0)}),o.items({name:e.project.name},function(n){return e.items=n.items,t.resolve(!0)}),s.register("viewer",[i.promise,t.promise,u.promise]),s.promise("viewer").then(function(){return e.ready=!0,"p5js"===e.visualization.type?l.loadScript(e.visualization.script).then(function(){return e.sketch=n.visualization}):void 0})},e.refresh()}]),angular.module("narra.ui").controller("LibrariesCtrl",["$scope","$rootScope","$location","$interval","$filter","$q","dialogs","apiProject","apiLibrary","apiUser","elzoidoPromises","elzoidoAuthUser","elzoidoMessages",function(e,t,n,i,r,o,a,s,l,u,c,h){return e.rotation={},e.thumbnail={},e.tabs={myLibraries:{},contribLibraries:{},sharedLibraries:{}},c.promise("authentication").then(function(){return e.refresh=function(){var t;return e.user=h.get(),t=o.defer(),l.all(function(n){return _.forEach(n.libraries,function(t){return e.thumbnail[t.name]=t.thumbnails[0]}),e.myLibraries=_.filter(n.libraries,function(t){return _.isEqual(t.author.username,e.user.username)}),e.contribLibraries=_.filter(n.libraries,function(t){return _.contains(_.pluck(t.contributors,"username"),e.user.username)}),e.sharedLibraries=_.filter(n.libraries,function(t){return t.shared&&!_.contains(_.pluck(e.myLibraries,"id"),t.id)&&!_.contains(_.pluck(e.contribLibraries,"id"),t.id)}),0===e.myLibraries.length?0===e.contribLibraries.length?e.tabs.sharedLibraries={active:!0}:e.tabs.contribLibraries={active:!0}:e.tabs.myLibraries={active:!0},t.resolve(!0)}),c.register("libraries",[t.promise])},t.$on("event:narra-library-created",function(){return e.refresh()}),t.$on("event:narra-library-purged",function(){return e.refresh()}),e.detail=function(e){return n.path("/libraries/"+e.id)},e.refresh()})}]),angular.module("narra.ui").controller("LibrariesAddCtrl",["$q","$scope","$filter","$modalInstance","dialogs","apiLibrary","apiProject","apiUser","apiGenerator","elzoidoMessages","elzoidoAuthUser",function(e,t,n,i,r,o,a,s,l,u,c){return t.user=c.get(),t.library={name:"",description:"",author:t.user,project:void 0},o.all(function(e){return t.libraries=e.libraries}),a.all(function(e){var n;return n=angular.copy(e.projects),t.user.isAdmin()||_.remove(n,function(e){return!_.contains(_.pluck(e.contributors,"username").concat([e.author.username]),t.user.username)}),t.projects=n}),s.all(function(e){return t.users=e.users}),l.all(function(e){return t.generators=e.generators}),t.close=function(){return i.dismiss("canceled")},t["new"]=function(){var e;return e=r.wait("Please Wait","Registering new library ..."),i.close(e),_.isUndefined(t.library.project)&&(t.library.project={name:void 0}),o["new"]({name:t.library.name,author:t.library.author.username,description:t.library.description,generators:[],contributors:[],project:t.library.project.name},function(t){return e.close(t.library.id),u.send("success","Success!","Library "+t.library.name+" was successfully created.")})},t.validateName=function(t){var n;return n=e.defer(),o.validate({name:t},function(e){return e.validation?n.resolve():n.reject()}),n.promise}}]),angular.module("narra.ui").controller("LibrariesDetailCtrl",["$timeout","$scope","$rootScope","$routeParams","$location","$document","$interval","$filter","$q","dialogs","apiProject","apiLibrary","apiUser","apiItem","elzoidoPromises","constantMetadata","elzoidoAuthUser","elzoidoMessages",function(e,t,n,i,r,o,a,s,l,u,c,h,d,p,f,g,m,v){return t.rotation={},t.thumbnail={},t.libraryMetadata={},t.itemsMetadata={},t.tabs={library:{active:!0},items:{},metadata:{}},_.isUndefined(i.tab)||(t.tabs[i.tab].active=!0),f.promise("authentication").then(function(){return t.refresh=function(){var e,n;return t.user=m.get(),n=l.defer(),e=l.defer(),h.get({id:i.library},function(e){return e.library.metadata=_.filter(e.library.metadata,function(e){return!_.isEqual(e.name,"shared")}),t.library=e.library,n.resolve(!0)}),h.items({id:i.library},function(n){return _.forEach(n.items,function(e){return t.thumbnail[e.name]=e.thumbnails[0]}),t.items=n.items,t.metadataProviders=g.providers,e.resolve(!0)}),n.promise.then(function(){return _.isUndefined(i.project)?void 0:t.project=_.find(t.library.projects,{name:i.project})}),f.register("library",[n.promise,e.promise])},t.isSelected=function(){return!_.isEmpty(t.selectedItems().items)},t.selectedItems=function(){return{items:_.where(t.items,{selected:!0}),library:t.library}},t.select=function(e){return _.forEach(t.items,function(t){return t.selected=e?!0:void 0})},t.isAuthor=function(){return!_.isUndefined(t.library)&&_.isEqual(t.library.author.username,t.user.username)||t.user.isAdmin()},t.isContributor=function(){return!_.isUndefined(t.library)&&_.include(_.pluck(t.library.contributors,"username"),t.user.username)},t.edit=function(){var e;if(t.isAuthor()||t.isContributor())return e=u.create("partials/librariesInformationEdit.html","LibrariesInformationEditCtrl",{library:t.library},{size:"lg",keyboard:!1}),e.result.then(function(e){return e.result.then(function(){return n.$broadcast("event:narra-library-updated",i.library)})})},t.deleteItems=function(){var n,i;return n=u.confirm("Please Confirm","You are about to delete selected items, this procedure is irreversible. Do you want to continue ?"),i=t.selectedItems().items,n.result.then(function(){var n,r;return r=u.wait("Please Wait","Deleting selected items ..."),n=[],_.forEach(i,function(i){var r;return r=l.defer(),n.push(r.promise),e(function(){return p["delete"]({id:i.id},function(){return t.items.remove(i),r.resolve(!0)},function(){return r.resolve(!0),v.send("danger","Error!","Item "+i.name+" encountered problem.")})},100)}),f.register("delete-items",n),f.promise("delete-items").then(function(){return v.send("success","Success!","Items were successfully deleted."),r.close()})})},t.deleteLibrary=function(){var e;return e=u.confirm("Please Confirm","You are about to delete the library "+t.library.name+", this procedure is irreversible. Do you want to continue ?"),e.result.then(function(){return h["delete"]({id:t.library.id},function(){return v.send("success","Success!","Library "+t.library.name+" was successfully deleted."),_.isUndefined(t.project)?r.url("/libraries"):r.url("/projects/"+t.project+"#"+t.from)})})},t.detail=function(e){var n;return n="/items/"+e.id+"?library="+t.library.id,_.isUndefined(t.project)||(n=n+"&project="+t.project.name),r.url(n)},t.$on("event:narra-item-created",function(){return _.isUndefined(i.library)?void 0:t.refresh()}),t.$on("event:narra-item-updated",function(){}),t.$on("event:narra-library-updated",function(e,n){return!_.isUndefined(i.library)&&_.isEqual(i.library,n)?t.refresh():void 0}),t.refresh()})}]),angular.module("narra.ui").controller("LibrariesInformationEditCtrl",["$scope","$filter","$modalInstance","dialogs","apiProject","apiLibrary","apiUser","apiGenerator","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o,a,s,l,u,c){return e.user=u.get(),e.library=c.library,e.initial=angular.copy(c.library),e.contributor={},o.all(function(t){return e.libraries=t.libraries}),r.all(function(t){return e.projects=t.projects}),a.all(function(t){return e.users=t.users,e.filter()}),s.all(function(t){return _.isEmpty(e.library.generators)||_.forEach(t.generators,function(t){var n;return n=_.find(e.library.generators,{identifier:t.identifier}),!_.isUndefined(n)&&(t.options=n.options,t.active=!0,_.isUndefined(e.generator))?e.generator=t:void 0}),e.generators=t.generators}),e.select=function(t){return t.active?e.generator=t:void 0},e.activate=function(t){return e.generator=t.active?t:null},e.addContribution=function(t){return e.library.contributors.push(t),e.contributor.selected=void 0,e.filter()},e.removeContribution=function(t){return _.pull(e.library.contributors,t),e.filter()},e.isSelected=function(t){return e.generator?e.generator.identifier===t.identifier:void 0
},e.isAuthor=function(){return!_.isUndefined(e.library)&&_.isEqual(e.library.author.username,e.user.username)||e.user.isAdmin()},e.filter=function(){return e.contributors=_.filter(e.users,function(t){return!_.isEqual(e.library.author.username,t.username)&&!_.include(_.pluck(e.library.contributors,"username"),t.username)})},e.close=function(){return n.dismiss("canceled")},e.edit=function(){var t;return t=i.wait("Please Wait","Saving library ..."),n.close(t),e.library.generators=_.filter(e.generators,function(e){return e.active}),o.update({id:e.library.id,name:e.library.name,author:e.library.author.username,shared:e.library.shared.toString(),description:e.library.description,generators:_.map(e.library.generators,function(e){return{identifier:e.identifier,options:e.options}}),contributors:_.pluck(e.library.contributors,"username")},function(e){return t.close(e.library),l.send("success","Success!","Library "+e.library.name+" was successfully saved.")})},e.validateName=function(t){return!_.contains(_.pluck(e.libraries,"name"),t)}}]),angular.module("narra.ui").controller("MetadataCtrl",["$scope","$q","$rootScope","$routeParams","dialogs","constantMetadata","elzoidoMessages","elzoidoAuthUser","apiItem","apiLibrary","apiProject",function(e,t,n,i,r,o,a,s,l,u,c){return e.refresh=function(){var i,h,d;switch(e.user=s.get(),e.api=e.api||{},e.player=e.api||{},e.type){case"items":return e.api.add=function(i){var o,s,c;return o=e.data(),s={},c=t.defer(),_.isUndefined(s[i.id])?u.metaValues({id:o.library.id,name:i.id},function(e){return _.isEmpty(e.values)||(_.isArray(e.values)||(e.values=[e.values]),s[i.id]=e.values),c.resolve(!0)}):c.resolve(!0),c.promise.then(function(){var e;return e=r.create(i.templateAdd,i.controller,{values:s[i.id]},{size:"lg",keyboard:!1}),e.result.then(function(e){var t;return t=r.wait("Please Wait","Adding new metadata ..."),_.isArray(e.value)&&(e.value=e.value.join(", ")),l.metadataNew({items:_.pluck(o.items,"id"),meta:e.name,value:e.value,generator:"user"},function(){return t.close(),a.send("success","Success!","New metadata was successfully created."),_.forEach(o.items,function(e){return n.$broadcast("event:narra-item-updated",e.id)})})})})};case"item":return e.item=e.data,e.auth=e.data.library,e.connector=_.result(_.find(e.item.metadata,{name:"connector",generator:"source"}),"value"),h={},d={},i=[],_.forEach(_.filter(_.uniq(_.pluck(e.item.metadata,"generator")),function(e){return!_.isEqual(e,"thumbnail")&&!_.isEqual(e,"transcoder")}),function(t){return i.push(t),t.indexOf("user")>-1?(_.isUndefined(h.user)&&(h.user={name:"user",data:[]}),h.user.data=h.user.data.concat(_.where(e.item.metadata,{generator:t}))):h[t]={name:t,data:_.where(e.item.metadata,{generator:t})}}),e.meta=h,e.generators=i,e["delete"]=function(t){var i;return i=r.wait("Please Wait","Deleting metadata ..."),l.metadataDelete({id:e.item.id,param:t.name,generator:t.generator},function(){return i.close(),a.send("success","Success!","Metadata was successfully deleted."),n.$broadcast("event:narra-item-updated",e.item.id)})},e.edit=function(i){var s,c;return s=_.find(o.providers,{id:i.name}),_.isUndefined(s)&&(s=_.find(o.providers,{id:"custom"})),c=t.defer(),_.isUndefined(d[s.id])?u.metaValues({id:e.item.library.id,name:s.id},function(e){return _.isEmpty(e.values)||(_.isArray(e.values)||(e.values=[e.values]),d[s.id]=e.values),c.resolve(!0)}):c.resolve(!0),c.promise.then(function(){var t,o,u;return o={meta:i,item:e.item,values:d[s.id]},e.player.ready&&(u={use:!_.isEmpty(i.marks),"in":_.isEmpty(i.marks)?Math.floor(e.player.currentTime/1e3):i.marks[0]["in"],out:_.isEmpty(i.marks)?void 0:i.marks[0].out,max:Math.floor(e.player.totalTime/1e3)},_.merge(o,{seek:e.seek,mark:u})),t=r.create(s.templateEdit,s.controller,o,{size:"lg",keyboard:!1}),t.result.then(function(t){var i,o;return o=r.wait("Please Wait","Updating metadata ..."),i=angular.copy(t),_.isArray(i.value)&&(i.value=i.value.join(", ")),l.metadataUpdate({id:e.item.id,meta:i.name,value:i.value,marks:i.marks,generator:i.generator,new_generator:"user"},function(){return o.close(),a.send("success","Success!","Metadata was successfully updated."),n.$broadcast("event:narra-item-updated",e.item.id)})})})},e.api.regenerate=function(t){var i;return i=r.confirm("Please Confirm","You are about to regenerate the item "+e.item.name+", this will erase all metadata by the generator. Do you want to continue ?"),i.result.then(function(){return l.regenerate({id:e.item.id,param:t},function(){return a.send("success","Success!","Item "+e.item.name+" was successfully deleted."),n.$broadcast("event:narra-item-updated",e.item.id)})})},e.api.add=function(i){var o;return o=t.defer(),_.isUndefined(d[i.id])?u.metaValues({id:e.item.library.id,name:i.id},function(e){return _.isEmpty(e.values)||(_.isArray(e.values)||(e.values=[e.values]),d[i.id]=e.values),o.resolve(!0)}):o.resolve(!0),o.promise.then(function(){var t,o;return o={all:_.pluck(e.item.metadata,"name"),values:d[i.id]},e.player.ready&&_.merge(o,{seek:e.seek,mark:{use:!1,"in":Math.floor(e.player.currentTime/1e3),max:Math.floor(e.player.totalTime/1e3)},out:void 0}),t=r.create(i.templateAdd,i.controller,o,{size:"lg",keyboard:!1}),t.result.then(function(t){var i,o;return o=r.wait("Please Wait","Adding new metadata ..."),i=angular.copy(t),_.isArray(i.value)&&(i.value=_(i.value).join(", ")),l.metadataNew({id:e.item.id,meta:i.name,value:i.value,marks:i.marks,generator:"user"},function(){return o.close(),a.send("success","Success!","New metadata was successfully created."),n.$broadcast("event:narra-item-updated",e.item.id)})})})};case"library":return e.library=e.data,e.auth=e.data,e.meta=e.library.metadata,e["delete"]=function(t){var i;return i=r.wait("Please Wait","Deleting metadata ..."),u.metadataDelete({id:e.library.id,param:t.name},function(){return i.close(),a.send("success","Success!","Metadata was successfully deleted."),n.$broadcast("event:narra-library-updated",e.library.id)})},e.edit=function(t){var i,s;return s=_.find(o.providers,{id:"custom"}),i=r.create(s.templateEdit,s.controller,{meta:t},{size:"lg",keyboard:!1}),i.result.then(function(t){var i;return i=r.wait("Please Wait","Updating metadata ..."),u.metadataUpdate({id:e.library.id,meta:t.name,value:t.value},function(){return i.close(),a.send("success","Success!","Metadata was successfully updated."),n.$broadcast("event:narra-library-updated",e.library.id)})})},e.api.regenerate=function(t){var i;return i=r.confirm("Please Confirm","You are about to regenerate the library "+e.library.name+", this will erase all metadata by the generator. Do you want to continue ?"),i.result.then(function(){return u.regenerate({id:e.library.id,param:t},function(){return a.send("success","Success!","Library "+e.library.name+" was successfully regenerated."),n.$broadcast("event:narra-library-updated",e.library.id)})})},e.api.add=function(){var t,i;return i=_.find(o.providers,{id:"custom"}),t=r.create(i.templateAdd,i.controller,{all:_.pluck(e.library.metadata,"name")},{size:"lg",keyboard:!1}),t.result.then(function(t){var i;return i=r.wait("Please Wait","Adding new metadata ..."),u.metadataNew({id:e.library.id,meta:t.name,value:t.value},function(){return i.close(),a.send("success","Success!","New metadata was successfully created."),n.$broadcast("event:narra-library-updated",e.library.id)})})};case"project":return e.project=e.data,e.auth=e.data,e.meta=e.project.metadata,e["delete"]=function(t){var i;return i=r.wait("Please Wait","Deleting metadata ..."),c.metadataDelete({name:e.project.name,param:t.name},function(){return i.close(),a.send("success","Success!","Metadata was successfully deleted."),n.$broadcast("event:narra-project-updated",e.project.name)})},e.edit=function(t){var i,s;return s=_.find(o.providers,{id:"custom"}),i=r.create(s.templateEdit,s.controller,{meta:t},{size:"lg",keyboard:!1}),i.result.then(function(t){var i;return i=r.wait("Please Wait","Updating metadata ..."),c.metadataUpdate({name:e.project.name,meta:t.name,value:t.value},function(){return i.close(),a.send("success","Success!","Metadata was successfully updated."),n.$broadcast("event:narra-project-updated",e.project.name)})})},e.api.add=function(){var t,i;return i=_.find(o.providers,{id:"custom"}),t=r.create(i.templateAdd,i.controller,{all:_.pluck(e.project.metadata,"name").concat(["public"])},{size:"lg",keyboard:!1}),t.result.then(function(t){var i;return i=r.wait("Please Wait","Adding new metadata ..."),c.metadataNew({name:e.project.name,meta:t.name,value:t.value},function(){return i.close(),a.send("success","Success!","New metadata was successfully created."),n.$broadcast("event:narra-project-updated",e.project.name)})})}}},e.$watch("data",function(t){return _.isUndefined(t)?void 0:e.refresh()}),e.seek=function(t){return e.player.seekTime(t)},e.isAuthor=function(){return!_.isUndefined(e.auth)&&_.isEqual(e.auth.author.username,e.user.username)||e.user.isAdmin()},e.isContributor=function(){return!_.isUndefined(e.auth)&&_.include(_.pluck(e.auth.contributors,"username"),e.user.username)},e.isLink=function(e){return 0===e.indexOf("http")},e.date=function(e){return moment(e).format("YYYY-mm-DD HH:MM:ss")},n.$on("event:narra-item-updated",function(t,n){return _.isEqual(e.type,"item")&&_.isEqual(i.item,n)?e.refresh():void 0}),n.$on("event:narra-library-updated",function(t,n){return _.isEqual(e.type,"library")&&_.isEqual(i.library,n)?e.refresh():void 0}),n.$on("event:narra-project-updated",function(t,n){return _.isEqual(e.type,"project")&&_.isEqual(i.project,n)?e.refresh():void 0})}]),angular.module("narra.ui").controller("MetadataAuthorCtrl",["$scope","$modalInstance","dialogs","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o){return e.user=r.get(),_.isUndefined(o.meta)?e.meta={name:"author",value:""}:(e.meta=o.meta,e.meta.value=_.map(o.meta.value.split(","),function(e){return e.trim()})),e.authors=_.isUndefined(o.values)?[]:o.values,e.close=function(){return t.dismiss("canceled")},e.add=function(){return t.close(e.meta)},e.edit=function(){return t.close(e.meta)}}]),angular.module("narra.ui").controller("MetadataCustomCtrl",["$scope","$modalInstance","dialogs","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o){return e.user=r.get(),e.all=o.all||[],e.meta=_.isUndefined(o.meta)?{name:"",value:""}:o.meta,_.isUndefined(o.mark)||(e.seek=o.seek,e.mark=o.mark,e.$watch("mark.in",function(t){return _.isUndefined(t)?void 0:e.seek(t)}),e.$watch("mark.out",function(t){return _.isUndefined(t)?void 0:e.seek(t)})),e.validateName=function(t){return!_.contains(e.all,t)},e.close=function(){return t.dismiss("canceled")},e.add=function(){return!_.isUndefined(e.mark)&&e.mark.use&&(e.meta=_.merge(e.meta,{marks:[{"in":e.mark["in"],out:e.mark.out}]})),t.close(e.meta)},e.edit=function(){return _.isUndefined(e.mark)||(e.mark.use?e.meta=_.merge(e.meta,{marks:[{"in":e.mark["in"],out:e.mark.out}]}):e.meta.marks=[]),t.close(e.meta)}}]),angular.module("narra.ui").controller("MetadataDescriptionCtrl",["$scope","$modalInstance","dialogs","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o){return e.user=r.get(),e.meta=_.isUndefined(o.meta)?{name:"description",value:""}:o.meta,e.close=function(){return t.dismiss("canceled")},e.add=function(){return t.close(e.meta)},e.edit=function(){return t.close(e.meta)}}]),angular.module("narra.ui").controller("MetadataKeywordsCtrl",["$scope","$modalInstance","dialogs","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o){return e.user=r.get(),_.isUndefined(o.meta)?e.meta={name:"keywords",value:""}:(e.meta=o.meta,e.meta.value=_.map(o.meta.value.split(","),function(e){return e.trim()})),e.keywords=_.isUndefined(o.values)?[]:o.values,e.close=function(){return t.dismiss("canceled")},e.add=function(){return t.close(e.meta)},e.edit=function(){return t.close(e.meta)}}]),angular.module("narra.ui").controller("MetadataLanguageCtrl",["$scope","$modalInstance","dialogs","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o){return e.user=r.get(),e.meta=_.isUndefined(o.meta)?{name:"language",value:""}:o.meta,e.languages={ab:{name:"Abkhaz",nativeName:""},aa:{name:"Afar",nativeName:"Afaraf"},af:{name:"Afrikaans",nativeName:"Afrikaans"},ak:{name:"Akan",nativeName:"Akan"},sq:{name:"Albanian",nativeName:"Shqip"},am:{name:"Amharic",nativeName:""},ar:{name:"Arabic",nativeName:""},an:{name:"Aragonese",nativeName:"Aragons"},hy:{name:"Armenian",nativeName:""},as:{name:"Assamese",nativeName:""},av:{name:"Avaric",nativeName:" ,  "},ae:{name:"Avestan",nativeName:"avesta"},ay:{name:"Aymara",nativeName:"aymar aru"},az:{name:"Azerbaijani",nativeName:"azrbaycan dili"},bm:{name:"Bambara",nativeName:"bamanankan"},ba:{name:"Bashkir",nativeName:" "},eu:{name:"Basque",nativeName:"euskara, euskera"},be:{name:"Belarusian",nativeName:""},bn:{name:"Bengali",nativeName:""},bh:{name:"Bihari",nativeName:""},bi:{name:"Bislama",nativeName:"Bislama"},bs:{name:"Bosnian",nativeName:"bosanski jezik"},br:{name:"Breton",nativeName:"brezhoneg"},bg:{name:"Bulgarian",nativeName:" "},my:{name:"Burmese",nativeName:""},ca:{name:"Catalan; Valencian",nativeName:"Catal"},ch:{name:"Chamorro",nativeName:"Chamoru"},ce:{name:"Chechen",nativeName:" "},ny:{name:"Chichewa; Chewa; Nyanja",nativeName:"chiChea, chinyanja"},zh:{name:"Chinese",nativeName:" (Zhngwn), , "},cv:{name:"Chuvash",nativeName:" "},kw:{name:"Cornish",nativeName:"Kernewek"},co:{name:"Corsican",nativeName:"corsu, lingua corsa"},cr:{name:"Cree",nativeName:""},hr:{name:"Croatian",nativeName:"hrvatski"},cs:{name:"Czech",nativeName:"esky, etina"},da:{name:"Danish",nativeName:"dansk"},dv:{name:"Divehi; Dhivehi; Maldivian;",nativeName:""},nl:{name:"Dutch",nativeName:"Nederlands, Vlaams"},en:{name:"English",nativeName:"English"},eo:{name:"Esperanto",nativeName:"Esperanto"},et:{name:"Estonian",nativeName:"eesti, eesti keel"},ee:{name:"Ewe",nativeName:"Eegbe"},fo:{name:"Faroese",nativeName:"froyskt"},fj:{name:"Fijian",nativeName:"vosa Vakaviti"},fi:{name:"Finnish",nativeName:"suomi, suomen kieli"},fr:{name:"French",nativeName:"franais, langue franaise"},ff:{name:"Fula; Fulah; Pulaar; Pular",nativeName:"Fulfulde, Pulaar, Pular"},gl:{name:"Galician",nativeName:"Galego"},ka:{name:"Georgian",nativeName:""},de:{name:"German",nativeName:"Deutsch"},el:{name:"Greek, Modern",nativeName:""},gn:{name:"Guaran",nativeName:"Avae"},gu:{name:"Gujarati",nativeName:""},ht:{name:"Haitian; Haitian Creole",nativeName:"Kreyl ayisyen"},ha:{name:"Hausa",nativeName:"Hausa, "},he:{name:"Hebrew (modern)",nativeName:""},hz:{name:"Herero",nativeName:"Otjiherero"},hi:{name:"Hindi",nativeName:", "},ho:{name:"Hiri Motu",nativeName:"Hiri Motu"},hu:{name:"Hungarian",nativeName:"Magyar"},ia:{name:"Interlingua",nativeName:"Interlingua"},id:{name:"Indonesian",nativeName:"Bahasa Indonesia"},ie:{name:"Interlingue",nativeName:"Originally called Occidental; then Interlingue after WWII"},ga:{name:"Irish",nativeName:"Gaeilge"},ig:{name:"Igbo",nativeName:"Ass Igbo"},ik:{name:"Inupiaq",nativeName:"Iupiaq, Iupiatun"},io:{name:"Ido",nativeName:"Ido"},is:{name:"Icelandic",nativeName:"slenska"},it:{name:"Italian",nativeName:"Italiano"},iu:{name:"Inuktitut",nativeName:""},ja:{name:"Japanese",nativeName:" ()"},jv:{name:"Javanese",nativeName:"basa Jawa"},kl:{name:"Kalaallisut, Greenlandic",nativeName:"kalaallisut, kalaallit oqaasii"},kn:{name:"Kannada",nativeName:""},kr:{name:"Kanuri",nativeName:"Kanuri"},ks:{name:"Kashmiri",nativeName:", "},kk:{name:"Kazakh",nativeName:" "},km:{name:"Khmer",nativeName:""},ki:{name:"Kikuyu, Gikuyu",nativeName:"Gky"},rw:{name:"Kinyarwanda",nativeName:"Ikinyarwanda"},ky:{name:"Kirghiz, Kyrgyz",nativeName:" "},kv:{name:"Komi",nativeName:" "},kg:{name:"Kongo",nativeName:"KiKongo"},ko:{name:"Korean",nativeName:" (),  ()"},ku:{name:"Kurdish",nativeName:"Kurd, "},kj:{name:"Kwanyama, Kuanyama",nativeName:"Kuanyama"},la:{name:"Latin",nativeName:"latine, lingua latina"},lb:{name:"Luxembourgish, Letzeburgesch",nativeName:"Ltzebuergesch"},lg:{name:"Luganda",nativeName:"Luganda"},li:{name:"Limburgish, Limburgan, Limburger",nativeName:"Limburgs"},ln:{name:"Lingala",nativeName:"Lingla"},lo:{name:"Lao",nativeName:""},lt:{name:"Lithuanian",nativeName:"lietuvi kalba"},lu:{name:"Luba-Katanga",nativeName:""},lv:{name:"Latvian",nativeName:"latvieu valoda"},gv:{name:"Manx",nativeName:"Gaelg, Gailck"},mk:{name:"Macedonian",nativeName:" "},mg:{name:"Malagasy",nativeName:"Malagasy fiteny"},ms:{name:"Malay",nativeName:"bahasa Melayu,  "},ml:{name:"Malayalam",nativeName:""},mt:{name:"Maltese",nativeName:"Malti"},mi:{name:"Mori",nativeName:"te reo Mori"},mr:{name:"Marathi (Marh)",nativeName:""},mh:{name:"Marshallese",nativeName:"Kajin Maje"},mn:{name:"Mongolian",nativeName:""},na:{name:"Nauru",nativeName:"Ekakair Naoero"},nv:{name:"Navajo, Navaho",nativeName:"Din bizaad, Dinkeh"},nb:{name:"Norwegian Bokml",nativeName:"Norsk bokml"},nd:{name:"North Ndebele",nativeName:"isiNdebele"},ne:{name:"Nepali",nativeName:""},ng:{name:"Ndonga",nativeName:"Owambo"},nn:{name:"Norwegian Nynorsk",nativeName:"Norsk nynorsk"},no:{name:"Norwegian",nativeName:"Norsk"},ii:{name:"Nuosu",nativeName:" Nuosuhxop"},nr:{name:"South Ndebele",nativeName:"isiNdebele"},oc:{name:"Occitan",nativeName:"Occitan"},oj:{name:"Ojibwe, Ojibwa",nativeName:""},cu:{name:"Old Church Slavonic, Church Slavic, Church Slavonic, Old Bulgarian, Old Slavonic",nativeName:" "},om:{name:"Oromo",nativeName:"Afaan Oromoo"},or:{name:"Oriya",nativeName:""},os:{name:"Ossetian, Ossetic",nativeName:" "},pa:{name:"Panjabi, Punjabi",nativeName:", "},pi:{name:"Pli",nativeName:""},fa:{name:"Persian",nativeName:""},pl:{name:"Polish",nativeName:"polski"},ps:{name:"Pashto, Pushto",nativeName:""},pt:{name:"Portuguese",nativeName:"Portugus"},qu:{name:"Quechua",nativeName:"Runa Simi, Kichwa"},rm:{name:"Romansh",nativeName:"rumantsch grischun"},rn:{name:"Kirundi",nativeName:"kiRundi"},ro:{name:"Romanian, Moldavian, Moldovan",nativeName:"romn"},ru:{name:"Russian",nativeName:" "},sa:{name:"Sanskrit (Saskta)",nativeName:""},sc:{name:"Sardinian",nativeName:"sardu"},sd:{name:"Sindhi",nativeName:",  "},se:{name:"Northern Sami",nativeName:"Davvismegiella"},sm:{name:"Samoan",nativeName:"gagana faa Samoa"},sg:{name:"Sango",nativeName:"yng t sng"},sr:{name:"Serbian",nativeName:" "},gd:{name:"Scottish Gaelic; Gaelic",nativeName:"Gidhlig"},sn:{name:"Shona",nativeName:"chiShona"},si:{name:"Sinhala, Sinhalese",nativeName:""},sk:{name:"Slovak",nativeName:"slovenina"},sl:{name:"Slovene",nativeName:"slovenina"},so:{name:"Somali",nativeName:"Soomaaliga, af Soomaali"},st:{name:"Southern Sotho",nativeName:"Sesotho"},es:{name:"Spanish; Castilian",nativeName:"espaol, castellano"},su:{name:"Sundanese",nativeName:"Basa Sunda"},sw:{name:"Swahili",nativeName:"Kiswahili"},ss:{name:"Swati",nativeName:"SiSwati"},sv:{name:"Swedish",nativeName:"svenska"},ta:{name:"Tamil",nativeName:""},te:{name:"Telugu",nativeName:""},tg:{name:"Tajik",nativeName:", toik, "},th:{name:"Thai",nativeName:""},ti:{name:"Tigrinya",nativeName:""},bo:{name:"Tibetan Standard, Tibetan, Central",nativeName:""},tk:{name:"Turkmen",nativeName:"Trkmen, "},tl:{name:"Tagalog",nativeName:"Wikang Tagalog,  "},tn:{name:"Tswana",nativeName:"Setswana"},to:{name:"Tonga (Tonga Islands)",nativeName:"faka Tonga"},tr:{name:"Turkish",nativeName:"Trke"},ts:{name:"Tsonga",nativeName:"Xitsonga"},tt:{name:"Tatar",nativeName:", tatara, "},tw:{name:"Twi",nativeName:"Twi"},ty:{name:"Tahitian",nativeName:"Reo Tahiti"},ug:{name:"Uighur, Uyghur",nativeName:"Uyurq, "},uk:{name:"Ukrainian",nativeName:""},ur:{name:"Urdu",nativeName:""},uz:{name:"Uzbek",nativeName:"zbek, , "},ve:{name:"Venda",nativeName:"Tshivena"},vi:{name:"Vietnamese",nativeName:"Ting Vit"},vo:{name:"Volapk",nativeName:"Volapk"},wa:{name:"Walloon",nativeName:"Walon"},cy:{name:"Welsh",nativeName:"Cymraeg"},wo:{name:"Wolof",nativeName:"Wollof"},fy:{name:"Western Frisian",nativeName:"Frysk"},xh:{name:"Xhosa",nativeName:"isiXhosa"},yi:{name:"Yiddish",nativeName:""},yo:{name:"Yoruba",nativeName:"Yorb"},za:{name:"Zhuang, Chuang",nativeName:"Sa cue, Saw cuengh"}},e.codes=Object.keys(e.languages),e.close=function(){return t.dismiss("canceled")},e.add=function(){return t.close(e.meta)},e.edit=function(){return t.close(e.meta)}}]),angular.module("narra.ui").controller("MetadataLocationCtrl",["$scope","$timeout","$modalInstance","dialogs","elzoidoAuthUser","uiGmapGoogleMapApi","data",function(e,t,n,i,r,o,a){return e.user=r.get(),o.then(function(){var i;return e.mapOptions={center:new google.maps.LatLng(49.873,15.552),zoom:7,mapTypeId:google.maps.MapTypeId.ROADMAP},e.ready=!1,t(function(){return e.ready=!0},100),e.mapTilesLoaded=function(t){return _.isUndefined(e.marker)&&(e.marker=new google.maps.Marker({map:t}),""!==e.meta.value)?e.marker.setPosition(t.center):void 0},_.isUndefined(a.meta)?e.meta={name:"location",value:""}:(e.meta=a.meta,i=e.meta.value.split(","),e.mapOptions.center=new google.maps.LatLng(i[0],i[1]),e.mapOptions.zoom=15),e.setMarkerPosition=function(t,n){return e.marker.setPosition(new google.maps.LatLng(n[0].latLng.G,n[0].latLng.K)),e.meta.value=n[0].latLng.G+", "+n[0].latLng.K},e.close=function(){return n.dismiss("canceled")},e.add=function(){return n.close(e.meta)},e.edit=function(){return n.close(e.meta)}})}]),angular.module("narra.ui").controller("MetadataOrganizationsCtrl",["$scope","$modalInstance","dialogs","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o){return e.user=r.get(),_.isUndefined(o.meta)?e.meta={name:"organizations",value:""}:(e.meta=o.meta,e.meta.value=_.map(o.meta.value.split(","),function(e){return e.trim()})),e.organizations=_.isUndefined(o.values)?[]:o.values,e.close=function(){return t.dismiss("canceled")},e.add=function(){return t.close(e.meta)},e.edit=function(){return t.close(e.meta)}}]),angular.module("narra.ui").controller("MetadataPeopleCtrl",["$scope","$modalInstance","dialogs","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o){return e.user=r.get(),_.isUndefined(o.meta)?e.meta={name:"people",value:""}:(e.meta=o.meta,e.meta.value=_.map(o.meta.value.split(","),function(e){return e.trim()})),e.people=_.isUndefined(o.values)?[]:o.values,e.close=function(){return t.dismiss("canceled")},e.add=function(){return t.close(e.meta)},e.edit=function(){return t.close(e.meta)}}]),angular.module("narra.ui").controller("MetadataShotTypeCtrl",["$scope","$modalInstance","dialogs","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o){return e.user=r.get(),_.isUndefined(o.meta)?e.meta={name:"shot_type",value:""}:(e.meta=o.meta,e.meta.value=_.map(o.meta.value.split(","),function(e){return e.trim()})),e.shots=["Aerial Shot","Arc Shot","Bridging Shot","Close Up","Medium Shot","Long Shot","Cowboy Shot","Deep Focus","Dolly Zoom","Dutch Tilt","Establishing Shot","Handheld Shot","Low Angle Shot","High Angle Shot","Locked-Down Shot","Library Shot","Matte Shot","Money Shot","Over-The-Shoulder Shot","Pan","POV","The Sequence Shot","Steadicam Shot","Tilt","Top Shot","Tracking Shot","Two-Shot","Whip Pan","Zoom","Crane Shot","Static Shot"],e.close=function(){return t.dismiss("canceled")},e.add=function(){return t.close(e.meta)},e.edit=function(){return t.close(e.meta)}}]),angular.module("narra.ui").controller("MetadataSummaryCtrl",["$scope","$modalInstance","dialogs","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o){return e.user=r.get(),e.meta=_.isUndefined(o.meta)?{name:"summary",value:""}:o.meta,e.close=function(){return t.dismiss("canceled")},e.add=function(){return t.close(e.meta)},e.edit=function(){return t.close(e.meta)}}]),angular.module("narra.ui").controller("ProjectsCtrl",["$scope","$rootScope","$location","$filter","$q","dialogs","apiProject","apiUser","elzoidoPromises","elzoidoAuthUser","elzoidoMessages",function(e,t,n,i,r,o,a,s,l,u){return e.tabs={myProjects:{},contribProjects:{}},l.promise("authentication").then(function(){return e.refresh=function(){var t;return e.user=u.get(),t=r.defer(),a.all(function(n){return e.projects=_.filter(n.projects,function(t){return _.isEqual(t.author.username,e.user.username)}),e.contributions=_.filter(n.projects,function(t){return _.contains(_.pluck(t.contributors,"username"),e.user.username)}),0===e.projects.length?e.tabs.contribProjects={active:!0}:e.tabs.myProjects={active:!0},t.resolve(!0)}),l.register("dashboard",[t.promise])},e.detailProject=function(e){return n.path("/projects/"+e.name)},t.$on("event:narra-project-created",function(){return e.refresh()}),e.detail=function(e){return n.path("/projects/"+e.name)},e.refresh()})}]),angular.module("narra.ui").controller("ProjectsAddCtrl",["$q","$scope","$filter","$modalInstance","dialogs","apiProject","apiUser","elzoidoMessages","elzoidoAuthUser",function(e,t,n,i,r,o,a,s,l){return t.user=l.get(),t.project={name:"",title:"",author:t.user,description:""},o.all(function(e){return t.projects=e.projects}),a.all(function(e){return t.users=e.users}),t.close=function(){return i.dismiss("canceled")},t["new"]=function(){var e,a;return a=r.wait("Please Wait","Registering new project ..."),i.close(a),e=n("projectname")(t.project.name),o["new"]({name:e,title:t.project.title,author:t.project.author.username,description:t.project.description,contributors:[]},function(e){return a.close(e.project.name),s.send("success","Success!","Project "+e.project.title+" was successfully created.")})},t.validateName=function(t){var i;return i=e.defer(),o.validate({name:n("projectname")(t)},function(e){return e.validation?i.resolve():i.reject()}),i.promise},t.validateTitle=function(t){var n;return n=e.defer(),o.validate({title:t},function(e){return e.validation?n.resolve():n.reject()}),n.promise}}]),angular.module("narra.ui").controller("ProjectsDetailCtrl",["$scope","$rootScope","$window","$document","$routeParams","$location","$filter","$q","dialogs","apiProject","apiVisualization","apiUser","elzoidoPromises","elzoidoMessages","elzoidoAuthUser",function(e,t,n,i,r,o,a,s,l,u,c,h,d,p,f){return e.tabs={project:{active:!0},libraries:{},sequences:{},visualizations:{},layouts:{},metadata:{}},d.promise("authentication").then(function(){return e.refresh=function(){var t,n,i,o;return e.user=f.get(),n=s.defer(),i=s.defer(),t=s.defer(),o=s.defer(),e.projectMetadata={},e.junctions={},_.isUndefined(r.tab)||(e.tabs[r.tab].active=!0),u.get({name:r.project},function(t){return t.project.metadata=_.filter(t.project.metadata,function(e){return!_.isEqual(e.name,"public")}),e.project=t.project,n.resolve(!0)}),u.sequences({name:r.project},function(t){return e.sequences=t.sequences,i.resolve(!0)}),n.promise.then(function(){return _.forEach(e.project.synthesizers,function(n,i){return u.junctions({name:r.project,param:n.identifier},function(r){return e.junctions[n.identifier]=r.junctions,i+1===e.project.synthesizers.length?t.resolve(!0):void 0})}),_.isEmpty(e.project.synthesizers)&&t.resolve(!0),c.all(function(t){return e.visualizations=_.filter(t.visualizations,function(t){return _.contains(_.pluck(e.project.visualizations,"id"),t.id)}),o.resolve(!0)})}),d.register("project",[n.promise,i.promise,o.promise,t.promise])},e.getItem=function(e,t){return _.find(t,{id:e})},e.getColor=function(e){return 255-50*e},e.isEmpty=function(e){return 0===Object.keys(e).length},e.edit=function(){var n;return n=l.create("partials/projectsInformationEdit.html","ProjectsInformationEditCtrl",{project:e.project,sequences:e.sequences},{size:"lg",keyboard:!1}),n.result.then(function(e){return e.result.then(function(e){return t.$broadcast("event:narra-project-updated",e.name)})})},e.isAuthor=function(){return!_.isUndefined(e.project)&&_.isEqual(e.project.author.username,e.user.username)||e.user.isAdmin()},e["delete"]=function(){var t;return t=l.confirm("Please Confirm","You are about to delete the project "+e.project.title+", this procedure is irreversible. Do you want to continue ?"),t.result.then(function(){return u["delete"]({name:e.project.name},function(){return o.url("/projects/"),p.send("success","Success!","Project "+e.project.name+" was successfully deleted.")})})},e.detailLibrary=function(t){return o.url("/libraries/"+t.id+"?project="+e.project.name)},e.detailSequence=function(t){return o.url("/sequences/"+t.id+"?project="+e.project.name)},e.addVisualization=function(t){return u.visualizationsAction({name:e.project.name,action:"add",visualizations:[t.id]},function(){return p.send("success","Success!","Visualization "+t.name+" was successfully added."),e.refresh()})},e.removeVisualization=function(t){return u.visualizationsAction({name:e.project.name,action:"remove",visualizations:[t.id]},function(){return p.send("success","Success!","Visualization "+t.name+" was successfully removed."),e.refresh()})},e.preview=function(t,i){return"visualization"===t?n.open("/viewer/"+e.project.name+"?visualization="+i.id,i.id,"_blank"):"layout"===t?n.open("/viewer/"+e.project.name+"?layout="+i.id,i.id,"_blank"):void 0},e.$on("event:narra-library-created",function(){return _.isUndefined(r.project)?void 0:e.refresh()}),t.$on("event:narra-library-purged",function(){return e.refresh()}),e.$on("event:narra-sequence-created",function(){return _.isUndefined(r.project)?void 0:e.refresh()}),e.$on("event:narra-project-updated",function(t,n){return _.isEqual(r.project,n)?e.refresh():void 0}),e.refresh()})}]),angular.module("narra.ui").controller("ProjectsInformationEditCtrl",["$scope","$filter","$modalInstance","dialogs","apiProject","apiLibrary","apiUser","apiSynthesizers","apiVisualization","elzoidoMessages","elzoidoAuthUser","serviceLayouts","data",function(e,t,n,i,r,o,a,s,l,u,c,h,d){var p;return e.user=c.get(),e.project=d.project,e.sequences=d.sequences,e.initial=angular.copy(d.project),e.contributor={},e.library={},e.layouts=[],r.all(function(t){return e.projects=t.projects}),o.all(function(t){return e.allLibraries=t.libraries,e.filterLibraries()}),a.all(function(t){return e.users=t.users,e.filterUsers()}),_.isEmpty(e.project.layouts)?e.layouts=h.layouts():(p=h.layouts(),_.forEach(p,function(t){var n;return n=_.find(e.project.layouts,{id:t.id}),_.isUndefined(n)||(t.options=n.options,t.active=!0,_.isUndefined(e.layout)&&(e.layout=t),n.main&&(e.project.layout=t)),e.layouts.push(t)})),s.all(function(t){return _.isEmpty(e.project.synthesizers)||_.forEach(t.synthesizers,function(t){var n;return n=_.find(e.project.synthesizers,{identifier:t.identifier}),!_.isUndefined(n)&&(t.options=n.options,t.active=!0,_.isUndefined(e.synthesizer))?e.synthesizer=t:void 0}),e.synthesizers=t.synthesizers}),l.all(function(t){return _.isEmpty(e.project.visualizations)||_.forEach(t.visualizations,function(t){var n;return n=_.find(e.project.visualizations,{id:t.id}),!_.isUndefined(n)&&(t.options=n.options,t.active=!0,_.isUndefined(e.visualization))?e.visualization=t:void 0}),e.visualizations=_.filter(t.visualizations,function(e){return e["public"]})}),e.sequences=_.filter(e.sequences,function(e){return e["public"]}),e.selectLayout=function(t){return t.active?e.layout=t:void 0},e.activateLayout=function(t){return e.layout=t.active?t:null,e.project.layouts=_.filter(e.layouts,function(e){return e.active})},e.isSelectedLayout=function(t){return e.layout?e.layout.id===t.id:void 0},e.selectSynthesizer=function(t){return t.active?e.synthesizer=t:void 0},e.activateSynthesizer=function(t){return e.synthesizer=t.active?t:null},e.isSelectedSynthesizer=function(t){return e.synthesizer?e.synthesizer.identifier===t.identifier:void 0},e.selectVisualization=function(t){return t.active?e.visualization=t:void 0
},e.activateVisualization=function(t){return e.visualization=t.active?t:null},e.isSelectedVisualization=function(t){return e.visualization?e.visualization.id===t.id:void 0},e.addContribution=function(t){return e.project.contributors.push(t),e.contributor.selected=void 0,e.filterUsers()},e.removeContribution=function(t){return _.pull(e.project.contributors,t),e.filterUsers()},e.addLibrary=function(t){return e.project.libraries.push(t),e.library.selected=void 0,e.filterLibraries()},e.removeLibrary=function(t){return _.pull(e.project.libraries,t),e.filterLibraries()},e.isAuthor=function(){return!_.isUndefined(e.project)&&_.isEqual(e.project.author.username,e.user.username)||e.user.isAdmin()},e.filterUsers=function(){return e.contributors=_.filter(e.users,function(t){return!_.isEqual(e.project.author.username,t.username)&&!_.include(_.pluck(e.project.contributors,"username"),t.username)})},e.filterLibraries=function(){return e.libraries=_.filter(e.allLibraries,function(t){return!_.include(_.pluck(e.project.libraries,"id"),t.id)})},e.close=function(){return n.dismiss("canceled")},e.edit=function(){var o,a;return a=i.wait("Please Wait","Saving project ..."),n.close(a),o=t("projectname")(e.project.name),e.project.layouts=_.filter(e.layouts,function(e){return e.active}),_.forEach(e.project.layouts,function(t){return _.forEach(Object.keys(t.options),function(e){return _.isArray(t.options[e])?t.options[e]=t.options[e].join(", "):void 0}),console.log(t),_.isUndefined(e.project.layout)||t.id!==e.project.layout.id?void 0:t.main=!0}),e.project.synthesizers=_.filter(e.synthesizers,function(e){return e.active}),e.project.visualizations=_.filter(e.visualizations,function(e){return e.active}),r.update({name:e.initial.name,new_name:o,title:e.project.title,author:e.project.author.username,description:e.project.description,synthesizers:_.collect(e.project.synthesizers,function(e){return{identifier:e.identifier,options:e.options}}),layouts:_.collect(e.project.layouts,function(e){return{id:e.id,name:e.name,main:e.main,options:e.options}}),visualizations:_.collect(e.project.visualizations,function(e){return{id:e.id,type:e.type,options:e.options}}),contributors:_.pluck(e.project.contributors,"username"),libraries:_.pluck(e.project.libraries,"id"),"public":e.project["public"]},function(e){return a.close(e.project),u.send("success","Success!","Project "+e.project.title+" was successfully saved.")})},e.validateName=function(n){return!(_.contains(_.pluck(e.projects,"name"),t("projectname")(n))&&!_.isEqual(n,e.initial.name))},e.validateTitle=function(t){return!(_.contains(_.pluck(e.projects,"title"),t)&&!_.isEqual(t,e.initial.title))}}]),angular.module("narra.ui").controller("SearchCtrl",["$scope","$rootScope","$window",function(){}]),angular.module("narra.ui").controller("SequencesAddCtrl",["$scope","$modalInstance","$timeout","dialogs","apiProject","apiUser","elzoidoMessages","elzoidoAuthUser","FileUploader",function(e,t,n,i,r,o,a,s,l){return e.user=s.get(),e.sequence={name:"",project:"",author:e.user,description:"",file:void 0,fps:""},e.framerates=[24,25,29.97,30],e.uploader=new l,e.uploader.onAfterAddingFile=function(t){var n;return n=t._file.name.split(".")[1],_.isEqual(n,"edl")?e.sequence.type="edl":_.isEqual(n,"xml")&&(e.sequence.type="xml"),e.sequence.file=t._file,e.sequence.name=t._file.name.split(".")[0],e.second=!0},r.all(function(t){return e.projects=t.projects}),o.all(function(t){return e.users=t.users}),e.select=function(t){return e.sequence.type=t,e.second=!0},e.close=function(){return t.dismiss("canceled")},e.back=function(){return e.second=!1},e["new"]=function(){var o,s;return o=new FormData,o.append("title",e.sequence.name),o.append("type",e.sequence.type),o.append("fps",e.sequence.fps),o.append("author",e.sequence.author.username),o.append("description",e.sequence.description),_.isUndefined(e.sequence.file)||o.append("file",e.sequence.file),s=i.wait("Please Wait","Registering new sequence ..."),t.close(s),r.sequencesNew({name:e.sequence.project.name},o,function(){return n(function(){return s.close(),a.send("success","Success!","Sequence "+e.sequence.name+" was successfully created.")},1e3)})}}]),angular.module("narra.ui").controller("SequencesDetailCtrl",["$scope","$sce","$timeout","$rootScope","$routeParams","$location","$document","$interval","$filter","$q","dialogs","apiProject","apiUser","elzoidoPromises","elzoidoAuthUser","elzoidoMessages",function(e,t,n,i,r,o,a,s,l,u,c,h,d,p,f,g){return e.tabs={sequence:{active:!0},player:{},editor:{}},e.player={api:void 0,ready:!1,preload:!0,autoHide:!0,autoHideTime:2e3,autoPlay:!1,sources:[],playlist:[],current:0,tracks:[],cuePoints:{},plugins:{}},p.promise("authentication").then(function(){return e.refresh=function(){var n;return e.user=f.get(),n=u.defer(),h.sequences({name:r.project,param:r.sequence},function(i){var r;return e.sequence=i.sequence,r=0,_.forEach(e.sequence.marks,function(e){return _.isUndefined(e.clip.source)&&(e.clip.source="black"===e.clip.name?"http://static.rur.cz/narra/black/black.mp4":"http://static.rur.cz/narra/bars/bars.mp4",e["in"]=0,e.out=e.duration),e.master_in=r,r+=e.duration}),_.isUndefined(e.sequence.master)?_.forEach(e.sequence.marks,function(n){return e.player.playlist.push({"in":n["in"],out:n.out,src:{src:t.trustAsResourceUrl(n.clip.source),type:"video/mp4"}})}):e.player.playlist.push({"in":0,src:{src:t.trustAsResourceUrl(e.sequence.master.source),type:"video/mp4"}}),e.player.sources=[e.player.playlist[0].src],n.resolve(!0)}),p.register("sequence",[n.promise]),p.promise("sequence").then(function(){return e.player.ready=!0})},e.onPlayerReady=function(t){return e.player.api=t,n(function(){return e.player.api.seekTime(e.player.playlist[0]["in"])},0)},e.playlistHandler=function(t){return _.isUndefined(e.sequence.master)?t>=e.player.playlist[e.player.current].out?(e.player.current+=1,e.playerAction()):void 0:_.forEach(e.sequence.marks,function(n,i){return t>n.master_in&&(e.sequence.marks.length===i+1||t<e.sequence.marks[i+1].master_in)?e.player.current=i:void 0})},e.seek=function(t){return e.player.current=t,_.isUndefined(e.sequence.master)?e.playerAction():e.player.api.seekTime(e.sequence.marks[t].master_in)},e.playerAction=function(){return e.player.current!==e.player.playlist.length?(e.player.sources=[e.player.playlist[e.player.current].src],n(function(){return e.player.api.seekTime(e.player.playlist[e.player.current]["in"]),e.player.api.play()},0)):(e.player.api.stop(),e.player.current=0,e.player.sources=[e.player.playlist[e.player.current].src],n(function(){return e.player.api.seekTime(e.player.playlist[e.player.current]["in"])},0))},e.isAuthor=function(){return!_.isUndefined(e.sequence)&&_.isEqual(e.sequence.author.username,e.user.username)||e.user.isAdmin()},e.isContributor=function(){return!_.isUndefined(e.sequence)&&_.include(_.pluck(e.sequence.contributors,"username"),e.user.username)},e.isActive=function(t){return e.player.current===t},e.edit=function(){var t;if(e.isAuthor()||e.isContributor())return t=c.create("partials/sequencesInformationEdit.html","SequencesInformationEditCtrl",{sequence:e.sequence},{size:"lg",keyboard:!1}),t.result.then(function(t){return t.result.then(function(){return e.refresh(),i.$broadcast("event:narra-sequence-updated",r.sequence)})})},e["delete"]=function(){var t;return t=c.confirm("Please Confirm","You are about to delete the sequence "+e.sequence.name+", this procedure is irreversible. Do you want to continue ?"),t.result.then(function(){return h.sequencesDelete({name:r.project,param:e.sequence.id},function(){return g.send("success","Success!","Sequence "+e.sequence.name+" was successfully deleted."),o.url("/projects/"+r.project)})})},e.refresh()})}]),angular.module("narra.ui").controller("SequencesInformationEditCtrl",["$scope","$filter","$modalInstance","$timeout","dialogs","apiProject","apiUser","apiGenerator","elzoidoMessages","elzoidoAuthUser","FileUploader","data",function(e,t,n,i,r,o,a,s,l,u,c,h){return e.user=u.get(),e.sequence=h.sequence,e.project=h.sequence.project,e.initial=angular.copy(h.sequence),e.contributor={},o.sequences({name:e.project.name},function(t){return e.sequences=t.sequences}),a.all(function(t){return e.users=t.users,e.filter()}),o.items({name:e.project.name},function(t){return e.items=_.filter(t.items,function(t){return _.isEqual(t.type,"video")&&!t.master||!_.isUndefined(e.sequence.master)&&e.sequence.master.id===t.id})}),e.addContribution=function(t){return e.sequence.contributors.push(t),e.contributor.selected=void 0,e.filter()},e.removeContribution=function(t){return _.pull(e.sequence.contributors,t),e.filter()},e.filter=function(){return e.contributors=_.filter(e.users,function(t){return!_.isEqual(e.sequence.author.username,t.username)&&!_.include(_.pluck(e.sequence.contributors,"username"),t.username)})},e.isAuthor=function(){return!_.isUndefined(e.sequence)&&_.isEqual(e.sequence.author.username,e.user.username)||e.user.isAdmin()},e.close=function(){return n.dismiss("canceled")},e.edit=function(){var t;return t=r.wait("Please Wait","Saving sequence ..."),n.close(t),_.isUndefined(e.sequence.master)||(e.sequence.master=e.sequence.master.id),o.sequencesUpdate({name:e.project.name,sequence:e.sequence.id,title:e.sequence.name,"public":e.sequence["public"].toString(),author:e.sequence.author.username,description:e.sequence.description,contributors:_.pluck(e.sequence.contributors,"username"),master:e.sequence.master},function(e){return t.close(e.library),l.send("success","Success!","Sequence "+e.sequence.name+" was successfully saved.")})},e.validateName=function(t){return!_.contains(_.pluck(e.visualizations,"name"),t)}}]),angular.module("narra.ui").controller("UsersCtrl",["$scope","$rootScope","$q","$location","dialogs","apiUser","elzoidoPromises","elzoidoAuthUser","elzoidoAuthAPI",function(e,t,n,i,r,o,a,s,l){return e.refresh=function(){var t;return t=n.defer(),o.all(function(n){return e.users=n.users,e.empty=n.length<1,t.resolve(!0)}),a.register("users",t.promise)},e.edit=function(e){var n;return n=r.create("partials/usersEdit.html","UsersEditCtrl",{user:e},{size:"lg",keyboard:!1}),n.result.then(function(n){return n.result.then(function(){return t.$broadcast("event:narra-user-updated"),_.isEqual(e.username,s.get().username)?l.signin():void 0})})},t.$on("event:narra-user-updated",function(){return e.refresh()}),e.refresh()}]),angular.module("narra.ui").controller("UsersEditCtrl",["$scope","$q","$location","$filter","$modalInstance","dialogs","apiUser","elzoidoMessages","elzoidoAuthUser","data",function(e,t,n,i,r,o,a,s,l,u){return e.user=u.user,e.username=u.user.username,e.admin=l.get().isAdmin(),a.all(function(t){return e.users=t.users}),a.roles(function(t){return e.roles=t.roles}),e.close=function(){return r.dismiss("canceled")},e.edit=function(){var t,n;return n=o.wait("Please Wait","Saving user ..."),r.close(n),t=i("projectname")(e.user.username),a.update({username:e.username,new_username:t,email:e.user.email,roles:e.user.roles},function(e){return n.close(),s.send("success","Success!","User "+e.user.name+" was successfully saved.")})},e.validateUsername=function(t){return!_.contains(_.pluck(e.users,"username"),i("projectname")(t))},e.validateRolesRequired=function(e){return!_.isEmpty(e)},e.validateRolesAdmin=function(t){var n;return _.contains(t,"admin")?!0:(n=_.where(e.users,{roles:["admin"]}),n.length>1?!0:_.isEmpty(_.where(n,{username:e.username}))?!0:void 0)}}]),angular.module("narra.ui").controller("VersionCtrl",["$scope","apiSystem","serviceVersion",function(e,t,n){return n.version(function(t){return e.uiVersion=t.version}),t.version(function(t){return e.coreVersion=t.version})}]),angular.module("narra.ui").controller("ViewerCtrl",["$scope","$routeParams","$window","$rootScope","$q","apiProject","apiVisualization","elzoidoPromises","serviceLayouts",function(e,t,n,i,r,o,a,s,l){return e.refresh=function(){var n;return n=r.defer(),o.get({name:t.project},function(t){return t.project.metadata=_.filter(t.project.metadata,function(e){return!_.isEqual(e.name,"public")}),e.project=t.project,i.project=t.project,n.resolve(!0)}),s.register("viewer",[n.promise]),s.promise("viewer").then(function(){var n;return i.viewer=!0,_.isUndefined(t.visualization)?e.layout=_.isUndefined(t.layout)?_.find(e.project.layouts,{main:!0}):_.find(e.project.layouts,{id:t.layout}):(n=_.find(l.layouts(),{id:"visualization_only"}),n.options.visualization=t.visualization,e.layout=n)})},e.refresh()}]),angular.module("narra.ui").controller("VisualizationsCtrl",["$scope","$rootScope","$location","$interval","$filter","$q","dialogs","apiProject","apiVisualization","apiUser","elzoidoPromises","elzoidoAuthUser",function(e,t,n,i,r,o,a,s,l,u,c,h){return e.tabs={myVisualizations:{},contribVisualizations:{},publicVisualizations:{}},c.promise("authentication").then(function(){return e.refresh=function(){var t;return e.user=h.get(),t=o.defer(),l.all(function(n){return _.forEach(n.visualizations,function(e){return e.thumbnail="/images/bars.png"}),e.myVisualizations=_.filter(n.visualizations,function(t){return _.isEqual(t.author.username,e.user.username)}),e.publicVisualizations=_.filter(n.visualizations,function(t){return t["public"]&&!_.contains(_.pluck(e.myVisualizations,"id"),t.id)}),e.contribVisualizations=_.filter(n.visualizations,function(t){return _.contains(_.pluck(t.contributors,"username"),e.user.username)}),0===e.myVisualizations.length?0===e.contribVisualizations.length?e.tabs.publicVisualizations={active:!0}:e.tabs.contribVisualizations={active:!0}:e.tabs.myVisualizations={active:!0},t.resolve(!0)}),c.register("visualizations",[t.promise])},e.detail=function(e){return n.path("/visualizations/"+e.id)},t.$on("event:narra-visualization-created",function(){return e.refresh()}),e.refresh()})}]),angular.module("narra.ui").controller("VisualizationsAddCtrl",["$scope","$modalInstance","$timeout","dialogs","apiVisualization","apiUser","elzoidoMessages","elzoidoAuthUser","FileUploader",function(e,t,n,i,r,o,a,s,l){return e.user=s.get(),e.visualization={name:"",author:e.user,description:"",file:void 0},e.uploader=new l,e.uploader.onAfterAddingFile=function(t){var n;return n=t._file.name.split(".")[1],_.isEqual(n,"pde")?e.visualization.type="processing":_.isEqual(n,"js")&&(e.visualization.type="p5js"),e.visualization.file=t._file,e.visualization.name=t._file.name.split(".")[0],e.second=!0},o.all(function(t){return e.users=t.users}),r.all(function(t){return e.visualizations=t.visualizations}),e.select=function(t){return e.visualization.type=t,e.second=!0},e.close=function(){return t.dismiss("canceled")},e.back=function(){return e.second=!1},e["new"]=function(){var o,s;return o=new FormData,o.append("name",e.visualization.name),o.append("type",e.visualization.type),o.append("author",e.visualization.author.username),o.append("description",e.visualization.description),_.isUndefined(e.visualization.file)||o.append("file",e.visualization.file),s=i.wait("Please Wait","Registering new visualization ..."),t.close(s),r["new"]({},o,function(){return n(function(){return s.close(e.visualization.name),a.send("success","Success!","Visualization "+e.visualization.name+" was successfully created.")},1e3)})},e.validateName=function(t){return!_.contains(_.pluck(e.visualizations,"name"),t)}}]),angular.module("narra.ui").controller("VisualizationsDetailCtrl",["$scope","$sce","$timeout","$window","$rootScope","$http","$routeParams","$location","$document","$interval","$filter","$q","dialogs","apiVisualization","apiUser","apiProject","elzoidoPromises","elzoidoAuthUser","elzoidoMessages",function(e,t,n,i,r,o,a,s,l,u,c,h,d,p,f,g,m,v,y){return e.tabs={visualization:{active:!0},code:{}},e.editorOption={theme:"xcode",require:["ace/ext/language_tools","ace/ext/static_highlight","ace/ext/error_marker","ace/ext/searchbox"],advanced:{enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0},onLoad:function(t){var n;return n=t.getSession(),_.isEqual(e.visualization.type,"processing")?n.setMode("ace/mode/java"):n.setMode("ace/mode/javascript"),t.setAutoScrollEditorIntoView(!0),t.setOption("maxLines",120),n.on("change",function(){return e.newContent=n.getValue()})}},m.promise("authentication").then(function(){return e.refresh=function(){var t,n;return e.user=v.get(),n=h.defer(),t=h.defer(),p.get({id:a.visualization},function(t){return e.visualization=t.visualization,o.get(e.visualization.script).success(function(t){return e.content=t,e.ready=!0,n.resolve(!0)})}),g.all(function(n){return e.projects=_.filter(n.projects,function(t){return _.isEqual(t.author.username,e.user.username)||_.include(_.pluck(t.contributors,"username"),e.user.username)}),t.resolve(!0)}),m.register("visualization",[n.promise,t.promise])},e.isAuthor=function(){return!_.isUndefined(e.visualization)&&_.isEqual(e.visualization.author.username,e.user.username)||e.user.isAdmin()},e.isContributor=function(){return!_.isUndefined(e.visualization)&&_.include(_.pluck(e.visualization.contributors,"username"),e.user.username)},e.preview=function(t){var n;return n=e.save(),n.then(function(){return i.open("/viewer/"+t.name+"?visualization="+e.visualization.id,e.visualization.id,"_blank")})},e.edit=function(){var t;return t=d.create("partials/visualizationsInformationEdit.html","VisualizationsInformationEditCtrl",{visualization:e.visualization},{size:"lg",keyboard:!1}),t.result.then(function(e){return e.result.then(function(){return r.$broadcast("event:narra-visualization-updated",a.visualization)})})},e["delete"]=function(){var t;return t=d.confirm("Please Confirm","You are about to delete the visualization "+e.visualization.name+", this procedure is irreversible. Do you want to continue ?"),t.result.then(function(){return p["delete"]({id:e.visualization.id},function(){return y.send("success","Success!","Visualization "+e.visualization.name+" was successfully deleted."),s.url("/visualizations")})})},e.save=function(){var t,i,r,o,a;return o=h.defer(),t=new FormData,r=_.isEqual(e.visualization.type,"processing")?e.visualization.type+".pde":e.visualization.type+".js",i=new File([e.newContent],r),t.append("name",e.visualization.name),t.append("author",e.visualization.author.username),t.append("description",e.visualization.description),t.append("public",e.visualization["public"]),t.append("contributors",JSON.stringify(_.pluck(e.visualization.contributors,"username"))),t.append("file",i),a=d.wait("Please Wait","Saving visualization ..."),p.update({id:e.visualization.id},t,function(){return n(function(){return e.refresh(),a.close(e.visualization.name),o.resolve(!0),y.send("success","Success!","Visualization "+e.visualization.name+" was successfully updated.")},1e3)}),o.promise},e.$on("event:narra-visualization-updated",function(t,n){return!_.isUndefined(a.visualization)&&_.isEqual(a.visualization,n)?e.refresh():void 0}),e.refresh()})}]),angular.module("narra.ui").controller("VisualizationsInformationEditCtrl",["$scope","$filter","$modalInstance","$timeout","dialogs","apiVisualization","apiUser","apiGenerator","elzoidoMessages","elzoidoAuthUser","FileUploader","data",function(e,t,n,i,r,o,a,s,l,u,c,h){return e.user=u.get(),e.visualization=h.visualization,e.initial=angular.copy(h.visualization),e.uploader=new c,e.contributor={},o.all(function(t){return e.visualizations=t.visualizations}),a.all(function(t){return e.users=t.users,e.filter()}),e.uploader.onAfterAddingFile=function(t){var n;return n=t._file.name.split(".")[1],_.isEqual(n,"pde")?(console.log(e.visualization.file),e.visualization.file=t._file,console.log(e.visualization.file)):void 0},e.addContribution=function(t){return e.visualization.contributors.push(t),e.contributor.selected=void 0,e.filter()},e.removeContribution=function(t){return _.pull(e.visualization.contributors,t),e.filter()},e.filter=function(){return e.contributors=_.filter(e.users,function(t){return!_.isEqual(e.visualization.author.username,t.username)&&!_.include(_.pluck(e.visualization.contributors,"username"),t.username)})},e.isAuthor=function(){return!_.isUndefined(e.visualization)&&_.isEqual(e.visualization.author.username,e.user.username)||e.user.isAdmin()},e.close=function(){return n.dismiss("canceled")},e.edit=function(){var t;return h=new FormData,h.append("name",e.visualization.name),h.append("author",e.visualization.author.username),h.append("description",e.visualization.description),h.append("public",e.visualization["public"]),h.append("contributors",JSON.stringify(_.pluck(e.visualization.contributors,"username"))),e.visualization.file&&h.append("file",e.visualization.file),t=r.wait("Please Wait","Saving visualization ..."),n.close(t),o.update({id:e.visualization.id},h,function(){return i(function(){return t.close(e.visualization.name),l.send("success","Success!","Visualization "+e.visualization.name+" was successfully updated.")},1e3)})},e.validateName=function(t){return!_.contains(_.pluck(e.visualizations,"name"),t)}}]),angular.module("narra.ui").directive("narraAdd",function(){return{restrict:"A",transclude:!0,scope:{},controller:"AddCtrl",templateUrl:"partials/add.html",replace:!1}}),angular.module("narra.ui").directive("narraEvents",function(){return{restrict:"A",transclude:!0,scope:{},controller:"EventsCtrl",templateUrl:"partials/events.html",replace:!1}}),angular.module("narra.ui").directive("filtervalue",["$filter",function(e){return{require:"?ngModel",link:function(t,n,i,r){return _.isUndefined(i.filtervalue)?void 0:r.$parsers.unshift(function(t){var r;return r=e(i.filtervalue)(t),n.val(r),r})}}}]),angular.module("narra.ui").directive("holder",function(){return{link:function(e,t){return Holder.run({images:t.get(0),nocss:!0})}}}),angular.module("narra.ui").directive("layoutsSequencePlayerOnly",function(){return{restrict:"A",transclude:!0,scope:{project:"=narraProject",layout:"=narraLayout"},controller:"LayoutsSequencePlayerOnlyCtrl",templateUrl:"partials/layouts/layoutsSequencePlayerOnly.html",replace:!1}}),angular.module("narra.ui").directive("layoutsSequencePlayerWithContext",function(){return{restrict:"A",transclude:!0,scope:{project:"=narraProject",layout:"=narraLayout"},controller:"LayoutsSequencePlayerWithContextCtrl",templateUrl:"partials/layouts/layoutsSequencePlayerWithContext.html",replace:!1}}),angular.module("narra.ui").directive("layoutsSequencePlayerWithMetadata",function(){return{restrict:"A",transclude:!0,scope:{project:"=narraProject",layout:"=narraLayout"},controller:"LayoutsSequencePlayerWithMetadataCtrl",templateUrl:"partials/layouts/layoutsSequencePlayerWithMetadata.html",replace:!1}}),angular.module("narra.ui").directive("layoutsVisualizationOnly",function(){return{restrict:"A",transclude:!0,scope:{project:"=narraProject",layout:"=narraLayout"},controller:"LayoutsVisualizationOnlyCtrl",templateUrl:"partials/layouts/layoutsVisualizationOnly.html",replace:!1}}),angular.module("narra.ui").directive("narraMetadata",function(){return{restrict:"A",transclude:!0,scope:{api:"=narraMetadataApi",data:"=narraMetadataData",player:"=narraMetadataPlayer",search:"=narraMetadataSearch",type:"@narraMetadataType",ui:"@narraMetadataUi"},controller:"MetadataCtrl",templateUrl:"partials/metadata/metadata.html",replace:!1}}),angular.module("narra.ui").directive("onRenderFinished",["$timeout",function(e){return{restrict:"A",link:function(t){return t.$last===!0?e(function(){return t.$emit("event:narra-render-finished")}):void 0}}}]),angular.module("narra.ui").directive("p5",["p5Factory",function(e){return{scope:!0,link:function(t,n){var i;return i=e(),t.$watch("sketch",function(e){return i.init(e,n[0])}),t.$on("$destroy",function(){return i.destroy()})}}}]),angular.module("narra.ui").directive("processing",function(){return{scope:!0,link:function(e,t,n){return e.$sketch=Processing.loadSketchFromSources(t[0],[n.processing])}}}),angular.module("narra.ui").directive("narraSearch",function(){return{restrict:"A",transclude:!0,scope:{},controller:"SearchCtrl",templateUrl:"partials/search.html",replace:!1}}),angular.module("narra.ui").directive("uiSelectRequired",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,i){return i.$isEmpty=function(e){return!e.length}}}}),angular.module("narra.ui").directive("narraVersion",function(){return{restrict:"A",transclude:!0,scope:{},controller:"VersionCtrl",templateUrl:"partials/version.html",replace:!1}}),angular.module("narra.ui").filter("capitalize",function(){return function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}}),angular.module("narra.ui").filter("generator",function(){return function(e){return angular.uppercase(e).replace("_"," ")}}),angular.module("narra.ui").filter("guest",function(){return function(e){return _.isUndefined(e)?"Guest":e.name}}),angular.module("narra.ui").filter("metadata",function(){return function(e){var t;return t=e.split("_"),_.forEach(t,function(e,n){return t[n]=e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}),t.join(" ")}}),angular.module("narra.ui").filter("projectname",function(){return function(e){return _.isUndefined(e)&&(e=""),angular.lowercase(e).replace(/\W+/g,"_").replace(/_{2,}/g,"_")}}),angular.module("narra.ui").filter("propertyname",function(){return function(e){return _.isUndefined(e)&&(e=""),angular.lowercase(e).replace(/_/g," ")}}),angular.module("narra.ui").filter("trimunderscore",function(){return function(e){return _.isUndefined(e)&&(e=""),String(e).replace(/(^_+|_+$)/g,"")}}),angular.module("narra.ui").filter("unescape",function(){return function(e){return _.unescape(e)}}),angular.module("narra.ui").config(["uiGmapGoogleMapApiProvider",function(e){return e.configure({libraries:"places"})}]),angular.module("narra.ui").run(["$rootScope","$window","dialogs","serviceServer",function(e){return e.$on("$routeChangeStart",function(t,n){return e.viewer="partials/viewer.html"===n.templateUrl?!0:!1})}]),angular.module("narra.ui").config(["cfpLoadingBarProvider",function(e){return e.includeSpinner=!1}]),angular.module("narra.ui").constant("constantMetadata",{providers:[{id:"author",name:"Author",templateAdd:"partials/metadata/metadataAuthorAdd.html",templateEdit:"partials/metadata/metadataAuthorEdit.html",controller:"MetadataAuthorCtrl"},{id:"keywords",name:"Keywords",templateAdd:"partials/metadata/metadataKeywordsAdd.html",templateEdit:"partials/metadata/metadataKeywordsEdit.html",controller:"MetadataKeywordsCtrl"},{id:"people",name:"People",templateAdd:"partials/metadata/metadataPeopleAdd.html",templateEdit:"partials/metadata/metadataPeopleEdit.html",controller:"MetadataPeopleCtrl"},{id:"organizations",name:"Organizations",templateAdd:"partials/metadata/metadataOrganizationsAdd.html",templateEdit:"partials/metadata/metadataOrganizationsEdit.html",controller:"MetadataOrganizationsCtrl"},{id:"language",name:"Language",templateAdd:"partials/metadata/metadataLanguageAdd.html",templateEdit:"partials/metadata/metadataLanguageEdit.html",controller:"MetadataLanguageCtrl"},{id:"summary",name:"Summary",templateAdd:"partials/metadata/metadataSummaryAdd.html",templateEdit:"partials/metadata/metadataSummaryEdit.html",controller:"MetadataSummaryCtrl"},{id:"description",name:"Description",templateAdd:"partials/metadata/metadataDescriptionAdd.html",templateEdit:"partials/metadata/metadataDescriptionEdit.html",controller:"MetadataDescriptionCtrl"},{id:"shot_type",name:"Shot Type",templateAdd:"partials/metadata/metadataShotTypeAdd.html",templateEdit:"partials/metadata/metadataShotTypeEdit.html",controller:"MetadataShotTypeCtrl"},{id:"custom",name:"Custom",templateAdd:"partials/metadata/metadataCustomAdd.html",templateEdit:"partials/metadata/metadataCustomEdit.html",controller:"MetadataCustomCtrl"},{id:"location",name:"Location",templateAdd:"partials/metadata/metadataLocationAdd.html",templateEdit:"partials/metadata/metadataLocationEdit.html",controller:"MetadataLocationCtrl"}]}),angular.module("narra.ui").config(["elzoidoPromisesModule",function(e){return e.config.timeout=1e3}]),angular.module("narra.ui").factory("serviceLayouts",function(){return{layouts:function(){return[{id:"visualization_only",name:"Visualization Only",description:"Layout using only one visualization in the runtime with possibility to activate selector",options:{visualization:""}},{id:"sequence_player_only",name:"Sequence Player Only",description:"Layout using only one player in the runtime to play sequences",options:{sequence:""}},{id:"sequence_player_with_metadata",name:"Sequence Player With Metadata",description:"Layout using only one player in the runtime to play sequences with possibility to see metadata of items",options:{sequence:"",metadata_fields:"keywords"}},{id:"sequence_player_with_context",name:"Sequence Player With Context",description:"Layout using only one player in the runtime to play sequences with possibility to see contextual data from synthesizers",options:{sequence:"",contextual_synthesizers:"sequence"}}]}}}),angular.module("narra.ui").factory("p5Factory",["$injector",function(e){var t;return t={init:function(t,n){return this.destroy(),t?(e.has(t)&&(t=e.get(t)),this.instance=new p5(t,n)):void 0},destroy:function(){return this.instance?(this.instance.remove(),this.instance=null):void 0}},function(){return Object.create(t)}}]),angular.module("narra.ui").factory("serviceServer",function(){return{url:"http://api.narra.eu"}}),angular.module("narra.ui").factory("serviceThumbnail",["serviceServer",function(e){var t;return t=function(t){return e.url+"/images/item_"+t+".png"},{thumbnail:function(e){return t(e)},text:t("text"),video:t("video"),audio:t("audio"),image:t("image")}}]),angular.module("narra.ui").factory("serviceToken",["$location","$cookies",function(e,t){var n;return n=t.get("_narra_ui_token"),_.isUndefined(e.search().token)||(n=e.search().token,t.put("_narra_ui_token",n)),{get:function(){return n},clean:function(){return n=null}}}]),angular.module("narra.ui").factory("serviceVersion",["$resource",function(e){return e("/package.json",{},{version:{method:"GET"}})}]);